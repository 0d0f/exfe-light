define("api",function(e){"use strict";function t(e,t){var s;for(s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);return e}function s(e,s,o){var i,d,a,u={};return t(u,p),t(u,e),i=r(),d=i.promise(),a=n(u).done(function(e,t){var s=e&&e.meta&&e.meta.code;200===s?i.resolve(e.response,t,a):i.reject(e,s,t,a)}).fail(function(e,t){var s=e&&e.meta&&e.meta.code;i.reject(e,s,t,a)}),d.jqXHR=a,d.abort=function(e){a&&(a.abort(e),a=i=d=void 0)},d.done(s).fail(o).fail(function(e,t){/^50[024]$/.exec(t||a.status)&&(window.location="/500")}).always(function(){a=i=d=void 0}),d}var o=e("jquery"),i=e("timezonedetect").jstz,r=o.Deferred,n=o.ajax,d=o.param,a=window._ENV_,u={base_url:a.api_url,signin:"/Users/signin",getRegistrationFlag:"/Users/getRegistrationFlag",getUser:"/Users/:user_id",signout:"/Users/signout/:user_id",updateUser:"/Users/update",setPassword:"/Users/:user_id/setPassword",crosses:"/Users/:user_id/crosses",crosslist:"/Users/:user_id/crosslist",addIdentity:"/Users/addIdentity",deleteIdentity:"/Users/deleteIdentity",setDefaultIdentity:"/Users/setDefaultIdentity",mergeIdentities:"/Users/mergeIdentities",setup:"/users/setup",getIdentityById:"/Identities/:identity_id",complete:"/Identities/complete",getIdentity:"/Identities/get",updateIdentity:"/Identities/:identity_id/update",getCross:"/Crosses/:cross_id",gather:"/Crosses/gather",editCross:"/Crosses/:cross_id/edit",rsvp:"/Exfee/:exfee_id/rsvp",editExfee:"/Exfee/:exfee_id/edit",conversation:"/Conversation/:exfee_id",addConversation:"/Conversation/:exfee_id/add",verifyIdentity:"/Users/verifyIdentity",verifyUserIdentity:"/Users/verifyUserIdentity",forgotPassword:"/Users/forgotPassword",avatarUpdate:"/Avatar/update",getCrossByInvitationToken:"/Crosses/getCrossByInvitationToken",resolveToken:"/Users/resolveToken",resetPassword:"/Users/resetPassword",setupUserByInvitationToken:"/Users/setupUserByInvitationToken",getInvitationByToken:"/Crosses/:cross_id/getInvitationByToken",recognize:"/time/recognize",sortIdentities:"/Users/:user_id/sortIdentities",checkinvitationtoken:"/crosses/checkinvitationtoken",photox_getPhotoX:"/photox/:photox_id",photox_borwseSource:"/photox/browseSource",photox_getPhoto:"/photox/GetPhoto",photox_add:"/photox/:photox_id/Add",photox_getLikes:"/photox/:photox_id/GetLikes",photox_like:"/photox/Like",photox_del:"/photox/:photox_id/Delete"},c={_token:null,setToken:function(e){this._token=e},getToken:function(){return this._token},request:function(e,t,o,i){var r,n=u[e],a=t.params,p=t.resources;if(n){if(a||(a={}),a&&(c._token&&!a.token&&(a.token=c._token),a=d(a),n+=a?"?"+a:""),p)for(r in p)n=n.replace(":"+r,encodeURIComponent(p[r]));return t.url=u.base_url+n,delete t.params,delete t.resources,s(t,o,i)}}},p={type:"GET",dataType:"JSON",timeout:1e4,cache:!1,xhrFields:{withCredentials:!0},headers:{"Accept-Timezone":i.determine().name()}};return c});