define("routexmaps",function(){"use strict";function t(){}function e(e){this.map=e,this.width=e.width(),this.height=e.height(),this.bounds=new t}var n;return n=t.prototype,n.extend=function(t){this._southWest||this._northEast?(this.minLat=this._southWest[0]=Math.min(t[0],this._southWest[0]),this.minLng=this._southWest[1]=Math.min(t[1],this._southWest[1]),this.maxLat=this._northEast[0]=Math.max(t[0],this._northEast[0]),this.maxLng=this._northEast[1]=Math.max(t[1],this._northEast[1])):(this._southWest=t,this._northEast=t)},n.getCenter=function(){return[(this._southWest[0]+this._northEast[0])/2,(this._southWest[1]+this._northEast[1])/2]},n.getNorthEast=function(){return this._northEast},n.getSouthWest=function(){return this._southWest},n.getNorthWest=function(){return[this._northEast[0],this._southWest[1]]},n.getSouthEast=function(){return[this._southWest[0],this._northEast[1]]},n=e.prototype,n.initEnd=!1,n.load=function(){var t=this.bounds,e=t.getCenter(),n=(this.getBoundsZoomLevel(),document.createElement("img")),i="size="+this.width+"x"+this.height,e="center="+e[0]+","+e[1],r="http://maps.googleapis.com/maps/api/staticmap?sensor=false&format=jpg&"+i+"&"+e;n.src=r,n.width=this.width,n.height=this.height,n.onload=n.onerror=function(){Debugger.alert("loaded")},map.appendChild(n),map.className=""},n._cache=[],n.draw=function(t){var e=t.type,n=t.action;this.initEnd?"command"===e&&"init_end"===n&&(this.initEnd=!0,this.setBounds(),this.load()):this._cache.push(t)},n.getScale=function(){var t=this.bounds;this.scaleX=3600*(t.maxLng-t.minLng)/this.width,this.scaleY=3600*(t.maxLat-t.minLat)/this.height},n.setBounds=function(){for(var t,e,n=this.bounds,i=this._cache,r=0,s=i.length;s>r;++r)t=i[r],"route"===t.type?e=t.positions[0].gps.slice(0,2):"location"===t.type&&(e=[t.lat,t.lng]),n.extend(e)},n.getBoundsZoomLevel=function(){function t(t){var e=Math.sin(t*Math.PI/180),n=Math.log((1+e)/(1-e))/2;return Math.max(Math.min(n,Math.PI),-Math.PI)/2}function e(t,e,n){return Math.floor(Math.log(t/e/n)/Math.LN2)}var n={height:256,width:256},i=21,r=this.bounds.getNorthEast(),s=this.bounds.getSouthWest(),o=(t(r[0])-t(s[0]))/Math.PI,a=r[1]-s[1],u=(0>a?a+360:a)/360,c=e(this.height,n.height,o),h=e(this.width,n.width,u);return Math.min(c,h,i)},n.fromLatlngToPixel=function(t){var e=this.bounds,n=3600*(t[1]-e.minLng)/this.scaleX,i=3600*(e.maxLat-t[0])/this.scaleY;return[n,i]},n.fromPixelToLatlng=function(t){var e=this.bounds,n=t[0]*this.scaleX/3600+e.minLng,i=e.maxLat-t[1]*this.scaleY/3600;return[i,n]},e});