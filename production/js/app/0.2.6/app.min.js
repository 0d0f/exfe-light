define(function(e){"use strict";var t=e("config"),n=e("handlebars"),r=e("middleware"),i=e("routes"),s=e("lightsaber"),o=s(),u=e("widget");o.widgetCaches=u.caches,o.use(r.fixedFaceBookURL),o.use(r.basicAuth),o.use(r.cleanupAppTmp),o.initRouter(),o.use(r.errorHandler),o.set("timestamp",t.timestamp),o.set("view cache",!0),o.set("view engine",n),o.set("views","/static/views"),o.get(/^\/+(?:\?)?(?:ipad)?#{0,}$/,i.index),o.get(/^\/+(?:\?)?(?:ipad)?#gather$/,i.refreshAuthUser,i.gather),o.get(/^\/+(?:\?)?(?:ipad)?#token=([a-zA-Z0-9]{64})$/,i.resolveToken,i.resolveRequest,i.resolveShow),o.get(/^\/+(?:\?)?(?:ipad)?#!([1-9][0-9]*)$/,i.refreshAuthUser,i.cross),o.get(/^\/+(?:\?)?(?:ipad)?#!([1-9][0-9]*)\/([a-zA-Z0-9]{3})$/,i.refreshAuthUser,i.crossInvitation),o.get(/^\/+(?:\?)?(?:ipad)?#!([1-9][0-9]*)\/([a-zA-Z0-9]{4})\/(accept|mute)?\/?$/,i.refreshAuthUser,i.crossPhoneToken),o.get(/^\/+(?:\?)?(?:ipad)?#!token=([a-zA-Z0-9]{32})$/,i.refreshAuthUser,i.crossToken),o.get(/^\/+(?:\?)?(?:ipad)?#!token=([a-zA-Z0-9]{32})\/(accept|mute)\/?$/,i.refreshAuthUser,i.crossToken),o.get(/^\/+(?:\?)?(?:ipad)?#([^@\/\s\!=]+)?@([^@\/\s]+)(?:\/?(.*))$/,i.refreshAuthUser,i.profile),o.get(/^\/+(?:\?)?(?:ipad)?#invalid\/token=([a-zA-Z0-9]{64})$/,i.invalid),o.get(/^\/+(?:\?)?(?:ipad)?#signout$/,i.signout),o.run(),window.App=o});