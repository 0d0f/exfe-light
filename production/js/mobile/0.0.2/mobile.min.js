/*! EXFE.COM QXdlc29tZSEgV2UncmUgaHVudGluZyB0YWxlbnRzIGxpa2UgeW91LiBQbGVhc2UgZHJvcCB1cyB5b3VyIENWIHRvIHdvcmtAZXhmZS5jb20uCg== */
/*! mobile@2a.2 2013-05-17 12:05:10 */
define(function(t){"use strict";var e=t("zepto"),n=t("tween"),i=t("af"),r=i.request,s=t("mobilemiddleware"),o=t("mobilecontroller").FooterController,a=t("mobileroutes"),c=Date.now||function(){return(new Date).getTime()},u=c(),l=function(t){App.set("tryRedirectAt",c()),window.location="exfe://crosses/"+(t||"")},h=t("lightsaber"),d=window.App=h();d.use(s.setHtmlHeight),d.use(s.cleanup),d.initRouter(),d.use(s.errorHandler),d.controllers={},d.controllers.footer=new o({App:d}),d.get(/^\/+(?:\?)?#{0,}$/,a.index),d.get(/^\/+(?:\?)?#live\/?$/,a.live),d.get(/^\/+\?t=([a-zA-Z0-9]{3,})$/,function(t,e){var n=function(){var t,e=document.getElementsByTagName("head")[0],n=document.getElementsByName("sms-token")[0];return n&&(t=JSON.parse(n.content),e.removeChild(n)),t},i=n();if(i){var r=i.action;t.session.resolveToken=i,"VERIFIED"===r?e.redirect("/#verify"):"INPUT_NEW_PASSWORD"===r&&e.redirect("/#set_password")}else t.error={code:404},t.redirect("/")}),d.get(/^\/+(?:\?)?#verify\/?$/,a.verify),d.get(/^\/+(?:\?)?#set_password\/?$/,a.setPassword),d.get(/^\/+(?:\?)?#token=([a-zA-Z0-9]{64})\/?$/,a.resolveToken),d.get(/^\/+(?:\?)?#!([1-9][0-9]*)\/([a-zA-Z0-9]{4})\/?$/,a.crossPhoneToken),d.get(/^\/+(?:\?)?#!token=([a-zA-Z0-9]{32})\/?$/,a.crossToken),d.set("tryRedirectAt",0),d.on("launched",function(){function t(){r(t),n.update()}var i=this,s=setInterval(function(){var t=c(),n=i.set("tryRedirectAt");n&&(t-u>1500&&1500>Math.abs(n-u)?(clearInterval(s),e(".get-button button").html('Open <span class="exfe">EXFE</span> app').removeClass("hide"),e("#app-footer").off("click.footer",".get-button button").on("click.footer",".get-button button",function(){l()})):2e3>t-n&&(e(".get-button").removeClass("hide"),e(".redirecting").addClass("hide"))),u=t},500);d.set("tryTimer",s),t()}),d.run()});