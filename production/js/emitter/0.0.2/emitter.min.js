define("emitter",function(){"use strict";function t(){}var n=/\s+/,e=Object.keys;return e||(e=function(t){var n,e=[];for(n in t)t.hasOwnProperty(n)&&(e[e.length]=n);return e}),t.prototype.on=function(t,e,i){var r,o,s;if(!e)return this;for(t=t.split(n),r=this.__callbacks||(this.__callbacks={});o=t.shift();)s=r[o]||(r[o]=[]),e.__context=i,s[s.length]=e;return this},t.prototype.once=function(t,e,i){var r,o,s;if(!e)return this;for(t=t.split(n),r=this.__callbacks||(this.__callbacks={});o=t.shift();)s=r[o]||(r[o]=[]),e.__once=!0,e.__context=i,s[s.length]=e;return this},t.prototype.off=function(t,i,r){var o,s,c,u,f;if(!(o=this.__callbacks))return this;if(!(t||i||r))return delete this.__callbacks,this;for(t=t.split(n)||e(o);s=t.shift();)if(c=o[s])if(i||r)for(u=c.length-1;u;--u)f=c[u],i&&f!==i||r&&f.__context!==r||c.splice(u,1);else delete o[s];return this},t.prototype.emit=function(t){var e,i,r,o,s,c,u,f,a=[];if(!(e=this.__callbacks))return this;for(t=t.split(n),s=arguments.length-1;s;--s)a[s-1]=arguments[s];for((r=e.call)&&(u=[0].concat(a));i=t.shift();){if(o=e[i])for(s=0,c=o.length;c>s;++s)f=o[s],f.apply(f.__context||this,a),f.__once&&(o.splice(s--,1),c--);if(o&&r)for(u[0]=i,s=0,c=r.length;c>s;++s)f=r[s],f.apply(f.__context||this,u)}return this},t});