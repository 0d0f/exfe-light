/*! EXFE.COM QXdlc29tZSEgV2UncmUgaHVudGluZyB0YWxlbnRzIGxpa2UgeW91LiBQbGVhc2UgZHJvcCB1cyB5b3VyIENWIHRvIHdvcmtAZXhmZS5jb20uCg== */
<<<<<<< HEAD
/*! mobile@2a.3 2013-05-26 10:05:28 */
(function(t){"use strict";function e(t,e,i){var o=arguments.length;1===o?(i=t,t=void 0):2===o&&(i=e,e=void 0);var a=new r(t,e,i);t?s[t]=a:i.call(a,n,a.exports,a)}function n(t){var e=s[t];return e?(e.exports||i(e),e.exports):null}function i(t){var e,i=t.factory;delete t.factory,e=i(n,t.exports={},t),e&&(t.exports=e)}function r(t,e,n){this.id=t,this.uri=void 0,this.deps=e,"string"==typeof n&&(n=Function("require","exports","module",n)),this.factory=n,this.exports=void 0,this.filename=null,this.parent=void 0,this.loaded=!1}e.amd={jQuery:!0},t.define=e,r.prototype.constructor=r;var s=r.__cache={}})(this),define("class",function(){"use strict";function t(n){return this instanceof t||!o(n)?void 0:e(n)}function e(e){return e.extend=t.extend,e.implement=r,e}function n(n,i,r,o,c){function u(){n.apply(this,arguments),this.constructor===u&&this.initialize&&(this.initialize.apply(this,arguments),this.initialized=!0)}return o=n.prototype,n!==t&&s(u,n),u.Extends=n,c=a(o),i&&s(c,i),u.prototype=c,r&&s(u,r),u.superclass=o,u.prototype.constructor=u,e(u)}function i(){}function r(t){var e,n=this.prototype;for(e in t)n[e]=t[e]}function s(t,e){var n;for(n in e)t[n]=e[n]}function o(t){return"[object Function]"===c.call(t)}t.create=function(e,i){return o(e)||(i=e,e=null),i||(i={}),e||(e=i.Extends||t),n(e,i)},t.extend=function(t,e){return n(this,t,e)};var a=Object.__proto__?function(t){return{__proto__:t}}:function(t){return i.prototype=t,new i},c=Object.prototype.toString;return t}),define("emitter",function(){"use strict";function t(){}var e=/\s+/,n=Object.keys;return n||(n=function(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&(n[n.length]=e);return n}),t.prototype.on=function(t,n,i){var r,s,o;if(!n)return this;for(t=t.split(e),r=this.__callbacks||(this.__callbacks={});s=t.shift();)o=r[s]||(r[s]=[]),n.__context=i,o[o.length]=n;return this},t.prototype.once=function(t,n,i){var r,s,o;if(!n)return this;for(t=t.split(e),r=this.__callbacks||(this.__callbacks={});s=t.shift();)o=r[s]||(r[s]=[]),n.__once=!0,n.__context=i,o[o.length]=n;return this},t.prototype.off=function(t,i,r){var s,o,a,c,u;if(!(s=this.__callbacks))return this;if(!(t||i||r))return delete this.__callbacks,this;for(t=t.split(e)||n(s);o=t.shift();)if(a=s[o])if(i||r)for(c=a.length-1;c;--c)u=a[c],i&&u!==i||r&&u.__context!==r||a.splice(c,1);else delete s[o];return this},t.prototype.emit=function(t){var n,i,r,s,o,a,c,u,l=[];if(!(n=this.__callbacks))return this;for(t=t.split(e),o=arguments.length-1;o;--o)l[o-1]=arguments[o];for((r=n.call)&&(c=[0].concat(l));i=t.shift();){if(s=n[i])for(o=0,a=s.length;a>o;++o)u=s[o],u.apply(u.__context||this,l),u.__once&&(s.splice(o--,1),a--);if(s&&r)for(c[0]=i,o=0,a=r.length;a>o;++o)u=r[o],u.apply(u.__context||this,c)}return this},t}),define("base",function(t){"use strict";function e(t){return"[object Function]"===a.call(t)}function n(t){return t&&"[object Object]"===a.call(t)&&"isPrototypeOf"in t}function i(t,e){var r,s;for(r in e)s=e[r],c(s)?s=s.slice():n(s)&&(s=i(t[r]||{},s)),t[r]=s;return t}function r(t){return t[2].toLowerCase()+t.substring(3)}var s=/^on[A-Z]/,o=Object.__proto__,a=Object.prototype.toString,c=Array.isArray;c||(c=function(t){return"[object Array]"===a.call(t)});var u=t("class"),l=t("emitter");return u.create(l,{setOptions:function(t){var n,o,a;if(this.hasOwnProperty("options")||(this.options={}),a=this.options,this.constructor.superclass.options&&i(a,this.constructor.superclass.options),this.constructor.prototype.options&&i(a,this.constructor.prototype.options),t&&t.options&&i(a,t.options),this.on)for(n in a)o=a[n],e(o)&&s.test(n)&&(this.on(r(n),o),delete a[n])},destory:function(){var t;for(t in this)this.hasOwnProperty(t)&&delete this[t];o&&(this.__proto__=o)}})});var Zepto=function(){function t(t){return null==t?t+"":J[G.call(t)]||"object"}function e(e){return"function"==t(e)}function n(t){return null!=t&&t==t.window}function i(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function r(e){return"object"==t(e)}function s(t){return r(t)&&!n(t)&&t.__proto__==Object.prototype}function o(t){return t instanceof Array}function a(t){return"number"==typeof t.length}function c(t){return A.call(t,function(t){return null!=t})}function u(t){return t.length>0?E.fn.concat.apply([],t):t}function l(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function h(t){return t in O?O[t]:O[t]=RegExp("(^|\\s)"+t+"(\\s|$)")}function d(t,e){return"number"!=typeof e||H[l(t)]?e:e+"px"}function p(t){var e,n;return I[t]||(e=P.createElement(t),P.body.appendChild(e),n=M(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==n&&(n="block"),I[t]=n),I[t]}function f(t){return"children"in t?N.call(t.children):E.map(t.childNodes,function(t){return 1==t.nodeType?t:x})}function m(t,e,n){for(_ in e)n&&(s(e[_])||o(e[_]))?(s(e[_])&&!s(t[_])&&(t[_]={}),o(e[_])&&!o(t[_])&&(t[_]=[]),m(t[_],e[_],n)):e[_]!==x&&(t[_]=e[_])}function v(t,e){return e===x?E(t):E(t).filter(e)}function g(t,n,i,r){return e(n)?n.call(t,i,r):n}function y(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function b(t,e){var n=t.className,i=n&&n.baseVal!==x;return e===x?i?n.baseVal:n:(i?n.baseVal=e:t.className=e,x)}function w(t){var e;try{return t?"true"==t||("false"==t?!1:"null"==t?null:isNaN(e=Number(t))?/^[\[\{]/.test(t)?E.parseJSON(t):t:e):t}catch(n){return t}}function k(t,e){e(t);for(var n in t.childNodes)k(t.childNodes[n],e)}var x,_,E,C,S,T,$=[],N=$.slice,A=$.filter,P=window.document,I={},O={},M=P.defaultView.getComputedStyle,H={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},D=/^\s*<(\w+|!)[^>]*>/,j=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,R=/^(?:body|html)$/i,L=["val","css","html","text","data","width","height","offset"],F=["after","prepend","before","append"],z=P.createElement("table"),B=P.createElement("tr"),U={tr:P.createElement("tbody"),tbody:z,thead:z,tfoot:z,td:B,th:B,"*":P.createElement("div")},q=/complete|loaded|interactive/,V=/^\.([\w-]+)$/,W=/^#([\w-]*)$/,Z=/^[\w-]+$/,J={},G=J.toString,Y={},X=P.createElement("div");return Y.matches=function(t,e){if(!t||1!==t.nodeType)return!1;var n=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(n)return n.call(t,e);var i,r=t.parentNode,s=!r;return s&&(r=X).appendChild(t),i=~Y.qsa(r,e).indexOf(t),s&&X.removeChild(t),i},S=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},T=function(t){return A.call(t,function(e,n){return t.indexOf(e)==n})},Y.fragment=function(t,e,n){t.replace&&(t=t.replace(j,"<$1></$2>")),e===x&&(e=D.test(t)&&RegExp.$1),e in U||(e="*");var i,r,o=U[e];return o.innerHTML=""+t,r=E.each(N.call(o.childNodes),function(){o.removeChild(this)}),s(n)&&(i=E(r),E.each(n,function(t,e){L.indexOf(t)>-1?i[t](e):i.attr(t,e)})),r},Y.Z=function(t,e){return t=t||[],t.__proto__=E.fn,t.selector=e||"",t},Y.isZ=function(t){return t instanceof Y.Z},Y.init=function(t,n){if(t){if(e(t))return E(P).ready(t);if(Y.isZ(t))return t;var i;if(o(t))i=c(t);else if(r(t))i=[s(t)?E.extend({},t):t],t=null;else if(D.test(t))i=Y.fragment(t.trim(),RegExp.$1,n),t=null;else{if(n!==x)return E(n).find(t);i=Y.qsa(P,t)}return Y.Z(i,t)}return Y.Z()},E=function(t,e){return Y.init(t,e)},E.extend=function(t){var e,n=N.call(arguments,1);return"boolean"==typeof t&&(e=t,t=n.shift()),n.forEach(function(n){m(t,n,e)}),t},Y.qsa=function(t,e){var n;return i(t)&&W.test(e)?(n=t.getElementById(RegExp.$1))?[n]:[]:1!==t.nodeType&&9!==t.nodeType?[]:N.call(V.test(e)?t.getElementsByClassName(RegExp.$1):Z.test(e)?t.getElementsByTagName(e):t.querySelectorAll(e))},E.contains=function(t,e){return t!==e&&t.contains(e)},E.type=t,E.isFunction=e,E.isWindow=n,E.isArray=o,E.isPlainObject=s,E.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},E.inArray=function(t,e,n){return $.indexOf.call(e,t,n)},E.camelCase=S,E.trim=function(t){return t.trim()},E.uuid=0,E.support={},E.expr={},E.map=function(t,e){var n,i,r,s=[];if(a(t))for(i=0;t.length>i;i++)n=e(t[i],i),null!=n&&s.push(n);else for(r in t)n=e(t[r],r),null!=n&&s.push(n);return u(s)},E.each=function(t,e){var n,i;if(a(t)){for(n=0;t.length>n;n++)if(e.call(t[n],n,t[n])===!1)return t}else for(i in t)if(e.call(t[i],i,t[i])===!1)return t;return t},E.grep=function(t,e){return A.call(t,e)},window.JSON&&(E.parseJSON=JSON.parse),E.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){J["[object "+e+"]"]=e.toLowerCase()}),E.fn={forEach:$.forEach,reduce:$.reduce,push:$.push,sort:$.sort,indexOf:$.indexOf,concat:$.concat,map:function(t){return E(E.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return E(N.apply(this,arguments))},ready:function(t){return q.test(P.readyState)?t(E):P.addEventListener("DOMContentLoaded",function(){t(E)},!1),this},get:function(t){return t===x?N.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return $.every.call(this,function(e,n){return t.call(e,n,e)!==!1}),this},filter:function(t){return e(t)?this.not(this.not(t)):E(A.call(this,function(e){return Y.matches(e,t)}))},add:function(t,e){return E(T(this.concat(E(t,e))))},is:function(t){return this.length>0&&Y.matches(this[0],t)},not:function(t){var n=[];if(e(t)&&t.call!==x)this.each(function(e){t.call(this,e)||n.push(this)});else{var i="string"==typeof t?this.filter(t):a(t)&&e(t.item)?N.call(t):E(t);this.forEach(function(t){0>i.indexOf(t)&&n.push(t)})}return E(n)},has:function(t){return this.filter(function(){return r(t)?E.contains(this,t):E(this).find(t).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!r(t)?t:E(t)},last:function(){var t=this[this.length-1];return t&&!r(t)?t:E(t)},find:function(t){var e,n=this;return e="object"==typeof t?E(t).filter(function(){var t=this;return $.some.call(n,function(e){return E.contains(e,t)})}):1==this.length?E(Y.qsa(this[0],t)):this.map(function(){return Y.qsa(this,t)})},closest:function(t,e){var n=this[0],r=!1;for("object"==typeof t&&(r=E(t));n&&!(r?r.indexOf(n)>=0:Y.matches(n,t));)n=n!==e&&!i(n)&&n.parentNode;return E(n)},parents:function(t){for(var e=[],n=this;n.length>0;)n=E.map(n,function(t){return(t=t.parentNode)&&!i(t)&&0>e.indexOf(t)?(e.push(t),t):x});return v(e,t)},parent:function(t){return v(T(this.pluck("parentNode")),t)},children:function(t){return v(this.map(function(){return f(this)}),t)},contents:function(){return this.map(function(){return N.call(this.childNodes)})},siblings:function(t){return v(this.map(function(t,e){return A.call(f(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return E.map(this,function(e){return e[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=null),"none"==M(this,"").getPropertyValue("display")&&(this.style.display=p(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var n=e(t);if(this[0]&&!n)var i=E(t).get(0),r=i.parentNode||this.length>1;return this.each(function(e){E(this).wrapAll(n?t.call(this,e):r?i.cloneNode(!0):i)})},wrapAll:function(t){if(this[0]){E(this[0]).before(t=E(t));for(var e;(e=t.children()).length;)t=e.first();E(t).append(this)}return this},wrapInner:function(t){var n=e(t);return this.each(function(e){var i=E(this),r=i.contents(),s=n?t.call(this,e):t;r.length?r.wrapAll(s):i.append(s)})},unwrap:function(){return this.parent().each(function(){E(this).replaceWith(E(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=E(this);(t===x?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(t){return E(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return E(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return t===x?this.length>0?this[0].innerHTML:null:this.each(function(e){var n=this.innerHTML;E(this).empty().append(g(this,t,e,n))})},text:function(t){return t===x?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=t})},attr:function(t,e){var n;return"string"==typeof t&&e===x?0==this.length||1!==this[0].nodeType?x:"value"==t&&"INPUT"==this[0].nodeName?this.val():!(n=this[0].getAttribute(t))&&t in this[0]?this[0][t]:n:this.each(function(n){if(1===this.nodeType)if(r(t))for(_ in t)y(this,_,t[_]);else y(this,t,g(this,e,n,this.getAttribute(t)))})},removeAttr:function(t){return this.each(function(){1===this.nodeType&&y(this,t)})},prop:function(t,e){return e===x?this[0]&&this[0][t]:this.each(function(n){this[t]=g(this,e,n,this[t])})},data:function(t,e){var n=this.attr("data-"+l(t),e);return null!==n?w(n):x},val:function(t){return t===x?this[0]&&(this[0].multiple?E(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(e){this.value=g(this,t,e,this.value)})},offset:function(t){if(t)return this.each(function(e){var n=E(this),i=g(this,t,e,n.offset()),r=n.offsetParent().offset(),s={top:i.top-r.top,left:i.left-r.left};"static"==n.css("position")&&(s.position="relative"),n.css(s)});if(0==this.length)return null;var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,n){if(2>arguments.length&&"string"==typeof e)return this[0]&&(this[0].style[S(e)]||M(this[0],"").getPropertyValue(e));var i="";if("string"==t(e))n||0===n?i=l(e)+":"+d(e,n):this.each(function(){this.style.removeProperty(l(e))});else for(_ in e)e[_]||0===e[_]?i+=l(_)+":"+d(_,e[_])+";":this.each(function(){this.style.removeProperty(l(_))});return this.each(function(){this.style.cssText+=";"+i})},index:function(t){return t?this.indexOf(E(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return $.some.call(this,function(t){return this.test(b(t))},h(t))},addClass:function(t){return this.each(function(e){C=[];var n=b(this),i=g(this,t,e,n);i.split(/\s+/g).forEach(function(t){E(this).hasClass(t)||C.push(t)},this),C.length&&b(this,n+(n?" ":"")+C.join(" "))})},removeClass:function(t){return this.each(function(e){return t===x?b(this,""):(C=b(this),g(this,t,e,C).split(/\s+/g).forEach(function(t){C=C.replace(h(t)," ")}),b(this,C.trim()),x)})},toggleClass:function(t,e){return this.each(function(n){var i=E(this),r=g(this,t,n,b(this));r.split(/\s+/g).forEach(function(t){(e===x?!i.hasClass(t):e)?i.addClass(t):i.removeClass(t)})})},scrollTop:function(){return this.length?"scrollTop"in this[0]?this[0].scrollTop:this[0].scrollY:x},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),n=this.offset(),i=R.test(e[0].nodeName)?{top:0,left:0}:e.offset();return n.top-=parseFloat(E(t).css("margin-top"))||0,n.left-=parseFloat(E(t).css("margin-left"))||0,i.top+=parseFloat(E(e[0]).css("border-top-width"))||0,i.left+=parseFloat(E(e[0]).css("border-left-width"))||0,{top:n.top-i.top,left:n.left-i.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||P.body;t&&!R.test(t.nodeName)&&"static"==E(t).css("position");)t=t.offsetParent;return t})}},E.fn.detach=E.fn.remove,["width","height"].forEach(function(t){E.fn[t]=function(e){var r,s=this[0],o=t.replace(/./,function(t){return t[0].toUpperCase()});return e===x?n(s)?s["inner"+o]:i(s)?s.documentElement["offset"+o]:(r=this.offset())&&r[t]:this.each(function(n){s=E(this),s.css(t,g(this,e,n,s[t]()))})}}),F.forEach(function(e,n){var i=n%2;E.fn[e]=function(){var e,r,s=E.map(arguments,function(n){return e=t(n),"object"==e||"array"==e||null==n?n:Y.fragment(n)}),o=this.length>1;return 1>s.length?this:this.each(function(t,e){r=i?e:e.parentNode,e=0==n?e.nextSibling:1==n?e.firstChild:2==n?e:null,s.forEach(function(t){if(o)t=t.cloneNode(!0);else if(!r)return E(t).remove();k(r.insertBefore(t,e),function(t){null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src||window.eval.call(window,t.innerHTML)})})})},E.fn[i?e+"To":"insert"+(n?"Before":"After")]=function(t){return E(t)[e](this),this}}),Y.Z.prototype=E.fn,Y.uniq=T,Y.deserializeValue=w,E.zepto=Y,E}();window.Zepto=Zepto,"$"in window||(window.$=Zepto),function(t){String.prototype.trim===t&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.reduce===t&&(Array.prototype.reduce=function(e){if(void 0===this||null===this)throw new TypeError;var n,i=Object(this),r=i.length>>>0,s=0;if("function"!=typeof e)throw new TypeError;if(0==r&&1==arguments.length)throw new TypeError;if(arguments.length>=2)n=arguments[1];else for(;;){if(s in i){n=i[s++];break}if(++s>=r)throw new TypeError}for(;r>s;)s in i&&(n=e.call(t,n,i[s],s,i)),s++;return n})}(),function(t){function e(t){return t._zid||(t._zid=p++)}function n(t,n,s,o){if(n=i(n),n.ns)var a=r(n.ns);return(d[e(t)]||[]).filter(function(t){return!(!t||n.e&&t.e!=n.e||n.ns&&!a.test(t.ns)||s&&e(t.fn)!==e(s)||o&&t.sel!=o)})}function i(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function r(t){return RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function s(e,n,i){"string"!=t.type(e)?t.each(e,i):e.split(/\s/).forEach(function(t){i(t,n)})}function o(t,e){return t.del&&("focus"==t.e||"blur"==t.e)||!!e}function a(t){return m[t]||t}function c(n,r,c,u,l,h){var p=e(n),f=d[p]||(d[p]=[]);s(r,c,function(e,r){var s=i(e);s.fn=r,s.sel=u,s.e in m&&(r=function(e){var n=e.relatedTarget;return!n||n!==this&&!t.contains(this,n)?s.fn.apply(this,arguments):void 0}),s.del=l&&l(r,e);var c=s.del||r;s.proxy=function(t){var e=c.apply(n,[t].concat(t.data));return e===!1&&(t.preventDefault(),t.stopPropagation()),e},s.i=f.length,f.push(s),n.addEventListener(a(s.e),s.proxy,o(s,h))})}function u(t,i,r,c,u){var l=e(t);s(i||"",r,function(e,i){n(t,e,i,c).forEach(function(e){delete d[l][e.i],t.removeEventListener(a(e.e),e.proxy,o(e,u))})})}function l(e){var n,i={originalEvent:e};for(n in e)y.test(n)||void 0===e[n]||(i[n]=e[n]);return t.each(b,function(t,n){i[t]=function(){return this[n]=v,e[t].apply(e,arguments)},i[n]=g}),i}function h(t){if(!("defaultPrevented"in t)){t.defaultPrevented=!1;var e=t.preventDefault;t.preventDefault=function(){this.defaultPrevented=!0,e.call(this)}}}var d=(t.zepto.qsa,{}),p=1,f={},m={mouseenter:"mouseover",mouseleave:"mouseout"};f.click=f.mousedown=f.mouseup=f.mousemove="MouseEvents",t.event={add:c,remove:u},t.proxy=function(n,i){if(t.isFunction(n)){var r=function(){return n.apply(i,arguments)};return r._zid=e(n),r}if("string"==typeof i)return t.proxy(n[i],n);throw new TypeError("expected function")},t.fn.bind=function(t,e){return this.each(function(){c(this,t,e)})},t.fn.unbind=function(t,e){return this.each(function(){u(this,t,e)})},t.fn.one=function(t,e){return this.each(function(n,i){c(this,t,e,null,function(t,e){return function(){var n=t.apply(i,arguments);return u(i,e,t),n}})})};var v=function(){return!0},g=function(){return!1},y=/^([A-Z]|layer[XY]$)/,b={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(e,n,i){return this.each(function(r,s){c(s,n,i,e,function(n){return function(i){var r,o=t(i.target).closest(e,s).get(0);return o?(r=t.extend(l(i),{currentTarget:o,liveFired:s}),n.apply(o,[r].concat([].slice.call(arguments,1)))):void 0}})})},t.fn.undelegate=function(t,e,n){return this.each(function(){u(this,e,n,t)})},t.fn.live=function(e,n){return t(document.body).delegate(this.selector,e,n),this},t.fn.die=function(e,n){return t(document.body).undelegate(this.selector,e,n),this},t.fn.on=function(e,n,i){return!n||t.isFunction(n)?this.bind(e,n||i):this.delegate(n,e,i)},t.fn.off=function(e,n,i){return!n||t.isFunction(n)?this.unbind(e,n||i):this.undelegate(n,e,i)},t.fn.trigger=function(e,n){return("string"==typeof e||t.isPlainObject(e))&&(e=t.Event(e)),h(e),e.data=n,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(e)})},t.fn.triggerHandler=function(e,i){var r,s;return this.each(function(o,a){r=l("string"==typeof e?t.Event(e):e),r.data=i,r.target=a,t.each(n(a,e.type||e),function(t,e){return s=e.proxy(r),r.isImmediatePropagationStopped()?!1:void 0})}),s},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.trigger(e)}}),["focus","blur"].forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.each(function(){try{this[e]()}catch(t){}}),this}}),t.Event=function(t,e){"string"!=typeof t&&(e=t,t=e.type);var n=document.createEvent(f[t]||"Events"),i=!0;if(e)for(var r in e)"bubbles"==r?i=!!e[r]:n[r]=e[r];return n.initEvent(t,i,!0,null,null,null,null,null,null,null,null,null,null,null,null),n.isDefaultPrevented=function(){return this.defaultPrevented},n}}(Zepto),function(t){function e(e,n,i){var r=t.Event(n);return t(e).trigger(r,i),!r.defaultPrevented}function n(t,n,i,r){return t.global?e(n||y,i,r):void 0}function i(e){e.global&&0===t.active++&&n(e,null,"ajaxStart")}function r(e){e.global&&!--t.active&&n(e,null,"ajaxStop")}function s(t,e){var i=e.context;return e.beforeSend.call(i,t,e)===!1||n(e,i,"ajaxBeforeSend",[t,e])===!1?!1:(n(e,i,"ajaxSend",[t,e]),void 0)}function o(t,e,i){var r=i.context,s="success";i.success.call(r,t,s,e),n(i,r,"ajaxSuccess",[e,i,t]),c(s,e,i)}function a(t,e,i,r){var s=r.context;r.error.call(s,i,e,t),n(r,s,"ajaxError",[i,r,t]),c(e,i,r)}function c(t,e,i){var s=i.context;i.complete.call(s,e,t),n(i,s,"ajaxComplete",[e,i]),r(i)}function u(){}function l(t){return t&&(t=t.split(";",2)[0]),t&&(t==_?"html":t==x?"json":w.test(t)?"script":k.test(t)&&"xml")||"text"}function h(t,e){return(t+"&"+e).replace(/[&?]{1,2}/,"?")}function d(e){e.processData&&e.data&&"string"!=t.type(e.data)&&(e.data=t.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||(e.url=h(e.url,e.data))}function p(e,n,i,r){var s=!t.isFunction(n);return{url:e,data:s?n:void 0,success:s?t.isFunction(i)?i:void 0:n,dataType:s?r||i:i}}function f(e,n,i,r){var s,o=t.isArray(n);t.each(n,function(n,a){s=t.type(a),r&&(n=i?r:r+"["+(o?"":n)+"]"),!r&&o?e.add(a.name,a.value):"array"==s||!i&&"object"==s?f(e,a,i,n):e.add(n,a)})}var m,v,g=0,y=window.document,b=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,w=/^(?:text|application)\/javascript/i,k=/^(?:text|application)\/xml/i,x="application/json",_="text/html",E=/^\s*$/;t.active=0,t.ajaxJSONP=function(e){if(!("type"in e))return t.ajax(e);var n,i="jsonp"+ ++g,r=y.createElement("script"),c=function(){clearTimeout(n),t(r).remove(),delete window[i]},l=function(t){c(),t&&"timeout"!=t||(window[i]=u),a(null,t||"abort",h,e)},h={abort:l};return s(h,e)===!1?(l("abort"),!1):(window[i]=function(t){c(),o(t,h,e)},r.onerror=function(){l("error")},r.src=e.url.replace(/=\?/,"="+i),t("head").append(r),e.timeout>0&&(n=setTimeout(function(){l("timeout")},e.timeout)),h)},t.ajaxSettings={type:"GET",beforeSend:u,success:u,error:u,complete:u,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:x,xml:"application/xml, text/xml",html:_,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},t.ajax=function(e){var n=t.extend({},e||{});for(m in t.ajaxSettings)void 0===n[m]&&(n[m]=t.ajaxSettings[m]);i(n),n.crossDomain||(n.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(n.url)&&RegExp.$2!=window.location.host),n.url||(n.url=""+window.location),d(n),n.cache===!1&&(n.url=h(n.url,"_="+Date.now()));var r=n.dataType,c=/=\?/.test(n.url);if("jsonp"==r||c)return c||(n.url=h(n.url,"callback=?")),t.ajaxJSONP(n);var p,f=n.accepts[r],g={},y=/^([\w-]+:)\/\//.test(n.url)?RegExp.$1:window.location.protocol,b=n.xhr();n.crossDomain||(g["X-Requested-With"]="XMLHttpRequest"),f&&(g.Accept=f,f.indexOf(",")>-1&&(f=f.split(",",2)[0]),b.overrideMimeType&&b.overrideMimeType(f)),(n.contentType||n.contentType!==!1&&n.data&&"GET"!=n.type.toUpperCase())&&(g["Content-Type"]=n.contentType||"application/x-www-form-urlencoded"),n.headers=t.extend(g,n.headers||{}),b.onreadystatechange=function(){if(4==b.readyState){b.onreadystatechange=u,clearTimeout(p);var e,i=!1;if(b.status>=200&&300>b.status||304==b.status||0==b.status&&"file:"==y){r=r||l(b.getResponseHeader("content-type")),e=b.responseText;try{"script"==r?(1,eval)(e):"xml"==r?e=b.responseXML:"json"==r&&(e=E.test(e)?null:t.parseJSON(e))}catch(s){i=s}i?a(i,"parsererror",b,n):o(e,b,n)}else a(null,b.status?"error":"abort",b,n)}};var w="async"in n?n.async:!0;b.open(n.type,n.url,w);for(v in n.headers)b.setRequestHeader(v,n.headers[v]);return s(b,n)===!1?(b.abort(),!1):(n.timeout>0&&(p=setTimeout(function(){b.onreadystatechange=u,b.abort(),a(null,"timeout",b,n)},n.timeout)),b.send(n.data?n.data:null),b)},t.get=function(){return t.ajax(p.apply(null,arguments))},t.post=function(){var e=p.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=p.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,n,i){if(!this.length)return this;var r,s=this,o=e.split(/\s/),a=p(e,n,i),c=a.success;return o.length>1&&(a.url=o[0],r=o[1]),a.success=function(e){s.html(r?t("<div>").html(e.replace(b,"")).find(r):e),c&&c.apply(s,arguments)},t.ajax(a),this};var C=encodeURIComponent;t.param=function(t,e){var n=[];return n.add=function(t,e){this.push(C(t)+"="+C(e))},f(n,t,e),n.join("&").replace(/%20/g,"+")}}(Zepto),function(t){t.fn.serializeArray=function(){var e,n=[];return t(Array.prototype.slice.call(this.get(0).elements)).each(function(){e=t(this);var i=e.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&("radio"!=i&&"checkbox"!=i||this.checked)&&n.push({name:e.attr("name"),value:e.val()})}),n},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(e)this.bind("submit",e);else if(this.length){var n=t.Event("submit");this.eq(0).trigger(n),n.defaultPrevented||this.get(0).submit()}return this}}(Zepto),function(t){function e(e,i){var c=e[a],u=c&&r[c];if(void 0===i)return u||n(e);if(u){if(i in u)return u[i];var l=o(i);if(l in u)return u[l]}return s.call(t(e),i)}function n(e,n,s){var c=e[a]||(e[a]=++t.uuid),u=r[c]||(r[c]=i(e));return void 0!==n&&(u[o(n)]=s),u}function i(e){var n={};return t.each(e.attributes,function(e,i){0==i.name.indexOf("data-")&&(n[o(i.name.replace("data-",""))]=t.zepto.deserializeValue(i.value))}),n}var r={},s=t.fn.data,o=t.camelCase,a=t.expando="Zepto"+ +new Date;t.fn.data=function(i,r){return void 0===r?t.isPlainObject(i)?this.each(function(e,r){t.each(i,function(t,e){n(r,t,e)})}):0==this.length?void 0:e(this[0],i):this.each(function(){n(this,i,r)})},t.fn.removeData=function(e){return"string"==typeof e&&(e=e.split(/\s+/)),this.each(function(){var n=this[a],i=n&&r[n];i&&t.each(e,function(){delete i[o(this)]})})}}(Zepto),function(t){function e(t){return"tagName"in t?t:t.parentNode}function n(t,e,n,i){var r=Math.abs(t-e),s=Math.abs(n-i);return r>=s?t-e>0?"Left":"Right":n-i>0?"Up":"Down"}function i(){u=null,l.last&&(l.el.trigger("longTap"),l={})}function r(){u&&clearTimeout(u),u=null}function s(){o&&clearTimeout(o),a&&clearTimeout(a),c&&clearTimeout(c),u&&clearTimeout(u),o=a=c=u=null,l={}}var o,a,c,u,l={},h=750;t(document).ready(function(){var d,p;t(document.body).bind("touchstart",function(n){d=Date.now(),p=d-(l.last||d),l.el=t(e(n.touches[0].target)),o&&clearTimeout(o),l.x1=n.touches[0].pageX,l.y1=n.touches[0].pageY,p>0&&250>=p&&(l.isDoubleTap=!0),l.last=d,u=setTimeout(i,h)}).bind("touchmove",function(t){r(),l.x2=t.touches[0].pageX,l.y2=t.touches[0].pageY,Math.abs(l.x1-l.x2)>10&&t.preventDefault()}).bind("touchend",function(){r(),l.x2&&Math.abs(l.x1-l.x2)>30||l.y2&&Math.abs(l.y1-l.y2)>30?c=setTimeout(function(){l.el.trigger("swipe"),l.el.trigger("swipe"+n(l.x1,l.x2,l.y1,l.y2)),l={}},0):"last"in l&&(a=setTimeout(function(){var e=t.Event("tap");e.cancelTouch=s,l.el.trigger(e),l.isDoubleTap?(l.el.trigger("doubleTap"),l={}):o=setTimeout(function(){o=null,l.el.trigger("singleTap"),l={}},250)},0))}).bind("touchcancel",s),t(window).bind("scroll",s)}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(e){t.fn[e]=function(t){return this.bind(e,t)}})}(Zepto),"function"==typeof define&&define("zepto",function(){return Zepto}),define("handlebars",function(t,e,n){this.Handlebars={},function(t){t.VERSION="1.0.rc.1",t.helpers={},t.partials={},t.registerHelper=function(t,e,n){n&&(e.not=n),this.helpers[t]=e},t.registerPartial=function(t,e){this.partials[t]=e},t.registerHelper("helperMissing",function(t){if(2===arguments.length)return void 0;throw Error("Could not find property '"+t+"'")});var e=Object.prototype.toString,n="[object Function]";t.registerHelper("blockHelperMissing",function(i,r){var s=r.inverse||function(){},o=r.fn,a=e.call(i);return a===n&&(i=i.call(this)),i===!0?o(this):i===!1||null==i?s(this):"[object Array]"===a?i.length>0?t.helpers.each(i,r):s(this):o(i)}),t.K=function(){},t.createFrame=Object.create||function(e){t.K.prototype=e;var n=new t.K;return t.K.prototype=null,n},t.registerHelper("each",function(e,n){var i,r=n.fn,s=n.inverse,o="";if(n.data&&(i=t.createFrame(n.data)),e&&e.length>0)for(var a=0,c=e.length;c>a;a++)i&&(i.index=a),o+=r(e[a],{data:i});else o=s(this);return o}),t.registerHelper("if",function(i,r){var s=e.call(i);return s===n&&(i=i.call(this)),!i||t.Utils.isEmpty(i)?r.inverse(this):r.fn(this)}),t.registerHelper("unless",function(e,n){var i=n.fn,r=n.inverse;return n.fn=r,n.inverse=i,t.helpers["if"].call(this,e,n)}),t.registerHelper("with",function(t,e){return e.fn(t)}),t.registerHelper("log",function(e){t.log(e)})}(this.Handlebars);var i=function(){function t(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,statements:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,OPEN_PARTIAL:24,params:25,hash:26,DATA:27,param:28,STRING:29,INTEGER:30,BOOLEAN:31,hashSegments:32,hashSegment:33,ID:34,EQUALS:35,pathSegments:36,SEP:37,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"OPEN_PARTIAL",27:"DATA",29:"STRING",30:"INTEGER",31:"BOOLEAN",34:"ID",35:"EQUALS",37:"SEP"},productions_:[0,[3,2],[4,3],[4,1],[4,0],[6,1],[6,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[7,2],[17,3],[17,2],[17,2],[17,1],[17,1],[25,2],[25,1],[28,1],[28,1],[28,1],[28,1],[28,1],[26,1],[32,2],[32,1],[33,3],[33,3],[33,3],[33,3],[33,3],[21,1],[36,3],[36,1]],performAction:function(t,e,n,i,r,s){var o=s.length-1;switch(r){case 1:return s[o-1];case 2:this.$=new i.ProgramNode(s[o-2],s[o]);break;case 3:this.$=new i.ProgramNode(s[o]);break;case 4:this.$=new i.ProgramNode([]);break;case 5:this.$=[s[o]];break;case 6:s[o-1].push(s[o]),this.$=s[o-1];break;case 7:this.$=new i.BlockNode(s[o-2],s[o-1].inverse,s[o-1],s[o]);break;case 8:this.$=new i.BlockNode(s[o-2],s[o-1],s[o-1].inverse,s[o]);break;case 9:this.$=s[o];break;case 10:this.$=s[o];break;case 11:this.$=new i.ContentNode(s[o]);break;case 12:this.$=new i.CommentNode(s[o]);break;case 13:this.$=new i.MustacheNode(s[o-1][0],s[o-1][1]);break;case 14:this.$=new i.MustacheNode(s[o-1][0],s[o-1][1]);break;case 15:this.$=s[o-1];break;case 16:this.$=new i.MustacheNode(s[o-1][0],s[o-1][1]);
break;case 17:this.$=new i.MustacheNode(s[o-1][0],s[o-1][1],!0);break;case 18:this.$=new i.PartialNode(s[o-1]);break;case 19:this.$=new i.PartialNode(s[o-2],s[o-1]);break;case 20:break;case 21:this.$=[[s[o-2]].concat(s[o-1]),s[o]];break;case 22:this.$=[[s[o-1]].concat(s[o]),null];break;case 23:this.$=[[s[o-1]],s[o]];break;case 24:this.$=[[s[o]],null];break;case 25:this.$=[[new i.DataNode(s[o])],null];break;case 26:s[o-1].push(s[o]),this.$=s[o-1];break;case 27:this.$=[s[o]];break;case 28:this.$=s[o];break;case 29:this.$=new i.StringNode(s[o]);break;case 30:this.$=new i.IntegerNode(s[o]);break;case 31:this.$=new i.BooleanNode(s[o]);break;case 32:this.$=new i.DataNode(s[o]);break;case 33:this.$=new i.HashNode(s[o]);break;case 34:s[o-1].push(s[o]),this.$=s[o-1];break;case 35:this.$=[s[o]];break;case 36:this.$=[s[o-2],s[o]];break;case 37:this.$=[s[o-2],new i.StringNode(s[o])];break;case 38:this.$=[s[o-2],new i.IntegerNode(s[o])];break;case 39:this.$=[s[o-2],new i.BooleanNode(s[o])];break;case 40:this.$=[s[o-2],new i.DataNode(s[o])];break;case 41:this.$=new i.IdNode(s[o]);break;case 42:s[o-2].push(s[o]),this.$=s[o-2];break;case 43:this.$=[s[o]]}},table:[{3:1,4:2,5:[2,4],6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{1:[3]},{5:[1,16]},{5:[2,3],7:17,8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,19],20:[2,3],22:[1,13],23:[1,14],24:[1,15]},{5:[2,5],14:[2,5],15:[2,5],16:[2,5],19:[2,5],20:[2,5],22:[2,5],23:[2,5],24:[2,5]},{4:20,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{4:21,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],24:[2,9]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],24:[2,10]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],24:[2,11]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],24:[2,12]},{17:22,21:23,27:[1,24],34:[1,26],36:25},{17:27,21:23,27:[1,24],34:[1,26],36:25},{17:28,21:23,27:[1,24],34:[1,26],36:25},{17:29,21:23,27:[1,24],34:[1,26],36:25},{21:30,34:[1,26],36:25},{1:[2,1]},{6:31,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{5:[2,6],14:[2,6],15:[2,6],16:[2,6],19:[2,6],20:[2,6],22:[2,6],23:[2,6],24:[2,6]},{17:22,18:[1,32],21:23,27:[1,24],34:[1,26],36:25},{10:33,20:[1,34]},{10:35,20:[1,34]},{18:[1,36]},{18:[2,24],21:41,25:37,26:38,27:[1,45],28:39,29:[1,42],30:[1,43],31:[1,44],32:40,33:46,34:[1,47],36:25},{18:[2,25]},{18:[2,41],27:[2,41],29:[2,41],30:[2,41],31:[2,41],34:[2,41],37:[1,48]},{18:[2,43],27:[2,43],29:[2,43],30:[2,43],31:[2,43],34:[2,43],37:[2,43]},{18:[1,49]},{18:[1,50]},{18:[1,51]},{18:[1,52],21:53,34:[1,26],36:25},{5:[2,2],8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,2],22:[1,13],23:[1,14],24:[1,15]},{14:[2,20],15:[2,20],16:[2,20],19:[2,20],22:[2,20],23:[2,20],24:[2,20]},{5:[2,7],14:[2,7],15:[2,7],16:[2,7],19:[2,7],20:[2,7],22:[2,7],23:[2,7],24:[2,7]},{21:54,34:[1,26],36:25},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],24:[2,8]},{14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],24:[2,14]},{18:[2,22],21:41,26:55,27:[1,45],28:56,29:[1,42],30:[1,43],31:[1,44],32:40,33:46,34:[1,47],36:25},{18:[2,23]},{18:[2,27],27:[2,27],29:[2,27],30:[2,27],31:[2,27],34:[2,27]},{18:[2,33],33:57,34:[1,58]},{18:[2,28],27:[2,28],29:[2,28],30:[2,28],31:[2,28],34:[2,28]},{18:[2,29],27:[2,29],29:[2,29],30:[2,29],31:[2,29],34:[2,29]},{18:[2,30],27:[2,30],29:[2,30],30:[2,30],31:[2,30],34:[2,30]},{18:[2,31],27:[2,31],29:[2,31],30:[2,31],31:[2,31],34:[2,31]},{18:[2,32],27:[2,32],29:[2,32],30:[2,32],31:[2,32],34:[2,32]},{18:[2,35],34:[2,35]},{18:[2,43],27:[2,43],29:[2,43],30:[2,43],31:[2,43],34:[2,43],35:[1,59],37:[2,43]},{34:[1,60]},{14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],24:[2,13]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],24:[2,16]},{5:[2,17],14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],24:[2,17]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],24:[2,18]},{18:[1,61]},{18:[1,62]},{18:[2,21]},{18:[2,26],27:[2,26],29:[2,26],30:[2,26],31:[2,26],34:[2,26]},{18:[2,34],34:[2,34]},{35:[1,59]},{21:63,27:[1,67],29:[1,64],30:[1,65],31:[1,66],34:[1,26],36:25},{18:[2,42],27:[2,42],29:[2,42],30:[2,42],31:[2,42],34:[2,42],37:[2,42]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],24:[2,19]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],24:[2,15]},{18:[2,36],34:[2,36]},{18:[2,37],34:[2,37]},{18:[2,38],34:[2,38]},{18:[2,39],34:[2,39]},{18:[2,40],34:[2,40]}],defaultActions:{16:[2,1],24:[2,25],38:[2,23],55:[2,21]},parseError:function(t){throw Error(t)},parse:function(t){function e(){var t;return t=n.lexer.lex()||1,"number"!=typeof t&&(t=n.symbols_[t]||t),t}var n=this,i=[0],r=[null],s=[],o=this.table,a="",c=0,u=0,l=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;s.push(h);var d=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,m,v,g,y,b,w,k,x={};;){if(m=i[i.length-1],this.defaultActions[m]?v=this.defaultActions[m]:((null===p||void 0===p)&&(p=e()),v=o[m]&&o[m][p]),void 0===v||!v.length||!v[0]){var _="";if(!l){k=[];for(y in o[m])this.terminals_[y]&&y>2&&k.push("'"+this.terminals_[y]+"'");_=this.lexer.showPosition?"Parse error on line "+(c+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(c+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(_,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:h,expected:k})}}if(v[0]instanceof Array&&v.length>1)throw Error("Parse Error: multiple actions possible at state: "+m+", token: "+p);switch(v[0]){case 1:i.push(p),r.push(this.lexer.yytext),s.push(this.lexer.yylloc),i.push(v[1]),p=null,f?(p=f,f=null):(u=this.lexer.yyleng,a=this.lexer.yytext,c=this.lexer.yylineno,h=this.lexer.yylloc,l>0&&l--);break;case 2:if(b=this.productions_[v[1]][1],x.$=r[r.length-b],x._$={first_line:s[s.length-(b||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(b||1)].first_column,last_column:s[s.length-1].last_column},d&&(x._$.range=[s[s.length-(b||1)].range[0],s[s.length-1].range[1]]),g=this.performAction.call(x,a,u,c,this.yy,v[1],r,s),void 0!==g)return g;b&&(i=i.slice(0,-2*b),r=r.slice(0,-1*b),s=s.slice(0,-1*b)),i.push(this.productions_[v[1]][0]),r.push(x.$),s.push(x._$),w=o[i[i.length-2]][i[i.length-1]],i.push(w);break;case 3:return!0}}return!0}},n=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return 20>t.length&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,n,i,r;this._more||(this.yytext="",this.match="");for(var s=this._currentRules(),o=0;s.length>o&&(n=this._input.match(this.rules[s[o]]),!n||e&&!(n[0].length>e[0].length)||(e=n,i=o,this.options.flex));o++);return e?(r=e[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,s[i],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t?t:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return void 0!==t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return t.options={},t.performAction=function(t,e,n){switch(n){case 0:if("\\"!==e.yytext.slice(-1)&&this.begin("mu"),"\\"===e.yytext.slice(-1)&&(e.yytext=e.yytext.substr(0,e.yyleng-1),this.begin("emu")),e.yytext)return 14;break;case 1:return 14;case 2:return"\\"!==e.yytext.slice(-1)&&this.popState(),"\\"===e.yytext.slice(-1)&&(e.yytext=e.yytext.substr(0,e.yyleng-1)),14;case 3:return 24;case 4:return 16;case 5:return 20;case 6:return 19;case 7:return 19;case 8:return 23;case 9:return 23;case 10:return e.yytext=e.yytext.substr(3,e.yyleng-5),this.popState(),15;case 11:return 22;case 12:return 35;case 13:return 34;case 14:return 34;case 15:return 37;case 16:break;case 17:return this.popState(),18;case 18:return this.popState(),18;case 19:return e.yytext=e.yytext.substr(1,e.yyleng-2).replace(/\\"/g,'"'),29;case 20:return e.yytext=e.yytext.substr(1,e.yyleng-2).replace(/\\"/g,'"'),29;case 21:return e.yytext=e.yytext.substr(1),27;case 22:return 31;case 23:return 31;case 24:return 30;case 25:return 34;case 26:return e.yytext=e.yytext.substr(1,e.yyleng-2),34;case 27:return"INVALID";case 28:return 5}},t.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:\{\{>)/,/^(?:\{\{#)/,/^(?:\{\{\/)/,/^(?:\{\{\^)/,/^(?:\{\{\s*else\b)/,/^(?:\{\{\{)/,/^(?:\{\{&)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{)/,/^(?:=)/,/^(?:\.(?=[} ]))/,/^(?:\.\.)/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}\}\})/,/^(?:\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@[a-zA-Z]+)/,/^(?:true(?=[}\s]))/,/^(?:false(?=[}\s]))/,/^(?:[0-9]+(?=[}\s]))/,/^(?:[a-zA-Z0-9_$-]+(?=[=}\s\/.]))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],t.conditions={mu:{rules:[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],inclusive:!1},emu:{rules:[2],inclusive:!1},INITIAL:{rules:[0,1,28],inclusive:!0}},t}();return e.lexer=n,t.prototype=e,e.Parser=t,new t}();return void 0!==t&&void 0!==e&&(e.parser=i,e.Parser=i.Parser,e.parse=function(){return i.parse.apply(i,arguments)},e.main=function(n){if(!n[1])throw Error("Usage: "+n[0]+" FILE");var i;return i="undefined"!=typeof process?t("fs").readFileSync(t("path").resolve(n[1]),"utf8"):t("file").path(t("file").cwd()).join(n[1]).read({charset:"utf-8"}),e.parser.parse(i)},void 0!==n&&t.main===n&&e.main("undefined"!=typeof process?process.argv.slice(1):t("system").args)),Handlebars.Parser=i,Handlebars.parse=function(t){return Handlebars.Parser.yy=Handlebars.AST,Handlebars.Parser.parse(t)},Handlebars.print=function(t){return(new Handlebars.PrintVisitor).accept(t)},Handlebars.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(){}},Handlebars.log=function(t,e){Handlebars.logger.log(t,e)},function(){Handlebars.AST={},Handlebars.AST.ProgramNode=function(t,e){this.type="program",this.statements=t,e&&(this.inverse=new Handlebars.AST.ProgramNode(e))},Handlebars.AST.MustacheNode=function(t,e,n){this.type="mustache",this.escaped=!n,this.hash=e;var i=this.id=t[0],r=this.params=t.slice(1),s=this.eligibleHelper=i.isSimple;this.isHelper=s&&(r.length||e)},Handlebars.AST.PartialNode=function(t,e){this.type="partial",this.id=t,this.context=e};var t=function(t,e){if(t.original!==e.original)throw new Handlebars.Exception(t.original+" doesn't match "+e.original)};Handlebars.AST.BlockNode=function(e,n,i,r){t(e.id,r),this.type="block",this.mustache=e,this.program=n,this.inverse=i,this.inverse&&!this.program&&(this.isInverse=!0)},Handlebars.AST.ContentNode=function(t){this.type="content",this.string=t},Handlebars.AST.HashNode=function(t){this.type="hash",this.pairs=t},Handlebars.AST.IdNode=function(t){this.type="ID",this.original=t.join(".");for(var e=[],n=0,i=0,r=t.length;r>i;i++){var s=t[i];".."===s?n++:"."===s||"this"===s?this.isScoped=!0:e.push(s)}this.parts=e,this.string=e.join("."),this.depth=n,this.isSimple=1===t.length&&!this.isScoped&&0===n},Handlebars.AST.DataNode=function(t){this.type="DATA",this.id=t},Handlebars.AST.StringNode=function(t){this.type="STRING",this.string=t},Handlebars.AST.IntegerNode=function(t){this.type="INTEGER",this.integer=t},Handlebars.AST.BooleanNode=function(t){this.type="BOOLEAN",this.bool=t},Handlebars.AST.CommentNode=function(t){this.type="comment",this.comment=t}}(),Handlebars.Exception=function(){var t=Error.prototype.constructor.apply(this,arguments);for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);this.message=t.message},Handlebars.Exception.prototype=Error(),Handlebars.SafeString=function(t){this.string=t},Handlebars.SafeString.prototype.toString=function(){return""+this.string},function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},e=/[&<>"'`]/g,n=/[&<>"'`]/,i=function(e){return t[e]||"&amp;"};Handlebars.Utils={escapeExpression:function(t){return t instanceof Handlebars.SafeString?""+t:null==t||t===!1?"":n.test(t)?t.replace(e,i):t},isEmpty:function(t){return void 0===t?!0:null===t?!0:t===!1?!0:"[object Array]"===Object.prototype.toString.call(t)&&0===t.length?!0:!1}}}(),Handlebars.Compiler=function(){},Handlebars.JavaScriptCompiler=function(){},function(t,e){t.prototype={compiler:t,disassemble:function(){for(var t,e,n,i=this.opcodes,r=[],s=0,o=i.length;o>s;s++)if(t=i[s],"DECLARE"===t.opcode)r.push("DECLARE "+t.name+"="+t.value);else{e=[];for(var a=0;t.args.length>a;a++)n=t.args[a],"string"==typeof n&&(n='"'+n.replace("\n","\\n")+'"'),e.push(n);r.push(t.opcode+" "+e.join(" "))}return r.join("\n")},guid:0,compile:function(t,e){this.children=[],this.depths={list:[]},this.options=e;var n=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},n)for(var i in n)this.options.knownHelpers[i]=n[i];return this.program(t)},accept:function(t){return this[t.type](t)},program:function(t){var e,n=t.statements;this.opcodes=[];for(var i=0,r=n.length;r>i;i++)e=n[i],this[e.type](e);return this.isSimple=1===r,this.depths.list=this.depths.list.sort(function(t,e){return t-e}),this},compileProgram:function(t){var e,n=(new this.compiler).compile(t,this.options),i=this.guid++;this.usePartial=this.usePartial||n.usePartial,this.children[i]=n;for(var r=0,s=n.depths.list.length;s>r;r++)e=n.depths.list[r],2>e||this.addDepth(e-1);return i},block:function(t){var e=t.mustache,n=t.program,i=t.inverse;n&&(n=this.compileProgram(n)),i&&(i=this.compileProgram(i));var r=this.classifyMustache(e);"helper"===r?this.helperMustache(e,n,i):"simple"===r?(this.simpleMustache(e),this.opcode("pushProgram",n),this.opcode("pushProgram",i),this.opcode("pushLiteral","{}"),this.opcode("blockValue")):(this.ambiguousMustache(e,n,i),this.opcode("pushProgram",n),this.opcode("pushProgram",i),this.opcode("pushLiteral","{}"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(t){var e,n,i=t.pairs;this.opcode("push","{}");for(var r=0,s=i.length;s>r;r++)e=i[r],n=e[1],this.accept(n),this.opcode("assignToHash",e[0])},partial:function(t){var e=t.id;this.usePartial=!0,t.context?this.ID(t.context):this.opcode("push","depth0"),this.opcode("invokePartial",e.original),this.opcode("append")},content:function(t){this.opcode("appendContent",t.string)},mustache:function(t){var e=this.options,n=this.classifyMustache(t);"simple"===n?this.simpleMustache(t):"helper"===n?this.helperMustache(t):this.ambiguousMustache(t),t.escaped&&!e.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousMustache:function(t,e,n){var i=t.id,r=i.parts[0];this.opcode("getContext",i.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",n),this.opcode("invokeAmbiguous",r)},simpleMustache:function(t){var e=t.id;"DATA"===e.type?this.DATA(e):e.parts.length?this.ID(e):(this.addDepth(e.depth),this.opcode("getContext",e.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(t,e,n){var i=this.setupFullMustacheParams(t,e,n),r=t.id.parts[0];if(this.options.knownHelpers[r])this.opcode("invokeKnownHelper",i.length,r);else{if(this.knownHelpersOnly)throw Error("You specified knownHelpersOnly, but used the unknown helper "+r);this.opcode("invokeHelper",i.length,r)}},ID:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var e=t.parts[0];e?this.opcode("lookupOnContext",t.parts[0]):this.opcode("pushContext");for(var n=1,i=t.parts.length;i>n;n++)this.opcode("lookup",t.parts[n])},DATA:function(t){this.options.data=!0,this.opcode("lookupData",t.id)},STRING:function(t){this.opcode("pushString",t.string)},INTEGER:function(t){this.opcode("pushLiteral",t.integer)},BOOLEAN:function(t){this.opcode("pushLiteral",t.bool)},comment:function(){},opcode:function(t){this.opcodes.push({opcode:t,args:[].slice.call(arguments,1)})},declare:function(t,e){this.opcodes.push({opcode:"DECLARE",name:t,value:e})},addDepth:function(t){if(isNaN(t))throw Error("EWOT");0!==t&&(this.depths[t]||(this.depths[t]=!0,this.depths.list.push(t)))},classifyMustache:function(t){var e=t.isHelper,n=t.eligibleHelper,i=this.options;if(n&&!e){var r=t.id.parts[0];i.knownHelpers[r]?e=!0:i.knownHelpersOnly&&(n=!1)}return e?"helper":n?"ambiguous":"simple"},pushParams:function(t){for(var e,n=t.length;n--;)e=t[n],this.options.stringParams?(e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",e.string)):this[e.type](e)},setupMustacheParams:function(t){var e=t.params;return this.pushParams(e),t.hash?this.hash(t.hash):this.opcode("pushLiteral","{}"),e},setupFullMustacheParams:function(t,e,n){var i=t.params;return this.pushParams(i),this.opcode("pushProgram",e),this.opcode("pushProgram",n),t.hash?this.hash(t.hash):this.opcode("pushLiteral","{}"),i}};var n=function(t){this.value=t};e.prototype={nameLookup:function(t,n){return/^[0-9]+$/.test(n)?t+"["+n+"]":e.isValidJavaScriptVariableName(n)?t+"."+n:t+"['"+n+"']"},appendToBuffer:function(t){return this.environment.isSimple?"return "+t+";":"buffer += "+t+";"},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(t,e,n,i){this.environment=t,this.options=e||{},Handlebars.log(Handlebars.logger.DEBUG,this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.compileChildren(t,e);var r,s=t.opcodes;for(this.i=0,o=s.length;o>this.i;this.i++)r=s[this.i],"DECLARE"===r.opcode?this[r.name]=r.value:this[r.opcode].apply(this,r.args);return this.createFunctionContext(i)},nextOpcode:function(){var t=this.environment.opcodes;return t[this.i+1],t[this.i+1]},eat:function(){this.i=this.i+1},preamble:function(){var t=[];if(this.isChild)t.push("");else{var e=this.namespace,n="helpers = helpers || "+e+".helpers;";this.environment.usePartial&&(n=n+" partials = partials || "+e+".partials;"),this.options.data&&(n+=" data = data || {};"),t.push(n)}this.environment.isSimple?t.push(""):t.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=t},createFunctionContext:function(t){var e=this.stackVars.concat(this.registers.list);if(e.length>0&&(this.source[1]=this.source[1]+", "+e.join(", ")),!this.isChild)for(var n in this.context.aliases)this.source[1]=this.source[1]+", "+n+"="+this.context.aliases[n];this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.source.push("return buffer;");for(var i=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],r=0,s=this.environment.depths.list.length;s>r;r++)i.push("depth"+this.environment.depths.list[r]);if(t)return i.push(this.source.join("\n  ")),Function.apply(this,i);var o="function "+(this.name||"")+"("+i.join(",")+") {\n  "+this.source.join("\n  ")+"}";return Handlebars.log(Handlebars.logger.DEBUG,o+"\n\n"),o},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=["depth0"];this.setupParams(0,t),this.replaceStack(function(e){return t.splice(1,0,e),e+" = blockHelperMissing.call("+t.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=["depth0"];this.setupParams(0,t);var e=this.topStack();t.splice(1,0,e),this.source.push("if (!"+this.lastHelper+") { "+e+" = blockHelperMissing.call("+t.join(", ")+"); }")},appendContent:function(t){this.source.push(this.appendToBuffer(this.quotedString(t)))},append:function(){var t=this.popStack();this.source.push("if("+t+" || "+t+" === 0) { "+this.appendToBuffer(t)+" }"),this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){var t=this.nextOpcode(),e="";this.context.aliases.escapeExpression="this.escapeExpression",t&&"appendContent"===t.opcode&&(e=" + "+this.quotedString(t.args[0]),this.eat(t)),this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"+e))},getContext:function(t){this.lastContext!==t&&(this.lastContext=t)},lookupOnContext:function(t){this.pushStack(this.nameLookup("depth"+this.lastContext,t,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(t){return"typeof "+t+" === functionType ? "+t+"() : "+t})},lookup:function(t){this.replaceStack(function(e){return e+" == null || "+e+" === false ? "+e+" : "+this.nameLookup(e,t,"context")})},lookupData:function(t){this.pushStack(this.nameLookup("data",t,"data"))},pushStringParam:function(t){this.pushStackLiteral("depth"+this.lastContext),this.pushString(t)},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},push:function(t){this.pushStack(t)},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){null!=t?this.pushStackLiteral(this.programExpression(t)):this.pushStackLiteral(null)},invokeHelper:function(t,e){this.context.aliases.helperMissing="helpers.helperMissing";var n=this.lastHelper=this.setupHelper(t,e);this.register("foundHelper",n.name),this.pushStack("foundHelper ? foundHelper.call("+n.callParams+") "+": helperMissing.call("+n.helperMissingParams+")")},invokeKnownHelper:function(t,e){var n=this.setupHelper(t,e);this.pushStack(n.name+".call("+n.callParams+")")},invokeAmbiguous:function(t){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");var e=this.setupHelper(0,t),n=this.lastHelper=this.nameLookup("helpers",t,"helper");this.register("foundHelper",n);var i=this.nameLookup("depth"+this.lastContext,t,"context"),r=this.nextStack();this.source.push("if (foundHelper) { "+r+" = foundHelper.call("+e.callParams+"); }"),this.source.push("else { "+r+" = "+i+"; "+r+" = typeof "+r+" === functionType ? "+r+"() : "+r+"; }")},invokePartial:function(t){var e=[this.nameLookup("partials",t,"partial"),"'"+t+"'",this.popStack(),"helpers","partials"];this.options.data&&e.push("data"),this.context.aliases.self="this",this.pushStack("self.invokePartial("+e.join(", ")+");")},assignToHash:function(t){var e=this.popStack(),n=this.topStack();this.source.push(n+"['"+t+"'] = "+e+";")},compiler:e,compileChildren:function(t,e){for(var n,i,r=t.children,s=0,o=r.length;o>s;s++){n=r[s],i=new this.compiler,this.context.programs.push("");var a=this.context.programs.length;n.index=a,n.name="program"+a,this.context.programs[a]=i.compile(n,e,this.context)}},programExpression:function(t){if(this.context.aliases.self="this",null==t)return"self.noop";for(var e,n=this.environment.children[t],i=n.depths.list,r=[n.index,n.name,"data"],s=0,o=i.length;o>s;s++)e=i[s],1===e?r.push("depth0"):r.push("depth"+(e-1));return 0===i.length?"self.program("+r.join(", ")+")":(r.shift(),"self.programWithDepth("+r.join(", ")+")")},register:function(t,e){this.useRegister(t),this.source.push(t+" = "+e+";")},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},pushStackLiteral:function(t){return this.compileStack.push(new n(t)),t},pushStack:function(t){return this.source.push(this.incrStack()+" = "+t+";"),this.compileStack.push("stack"+this.stackSlot),"stack"+this.stackSlot},replaceStack:function(t){var e=t.call(this,this.topStack());return this.source.push(this.topStack()+" = "+e+";"),"stack"+this.stackSlot},nextStack:function(){var t=this.incrStack();return this.compileStack.push("stack"+this.stackSlot),t},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),"stack"+this.stackSlot},popStack:function(){var t=this.compileStack.pop();return t instanceof n?t.value:(this.stackSlot--,t)},topStack:function(){var t=this.compileStack[this.compileStack.length-1];return t instanceof n?t.value:t},quotedString:function(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'},setupHelper:function(t,e){var n=[];this.setupParams(t,n);var i=this.nameLookup("helpers",e,"helper");return{params:n,name:i,callParams:["depth0"].concat(n).join(", "),helperMissingParams:["depth0",this.quotedString(e)].concat(n).join(", ")}},setupParams:function(t,e){var n,i,r,s=[],o=[];s.push("hash:"+this.popStack()),i=this.popStack(),r=this.popStack(),(r||i)&&(r||(this.context.aliases.self="this",r="self.noop"),i||(this.context.aliases.self="this",i="self.noop"),s.push("inverse:"+i),s.push("fn:"+r));for(var a=0;t>a;a++)n=this.popStack(),e.push(n),this.options.stringParams&&o.push(this.popStack());return this.options.stringParams&&s.push("contexts:["+o.join(",")+"]"),this.options.data&&s.push("data:data"),e.push("{"+s.join(",")+"}"),e.join(", ")}};for(var i="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),r=e.RESERVED_WORDS={},s=0,o=i.length;o>s;s++)r[i[s]]=!0;e.isValidJavaScriptVariableName=function(t){return!e.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(t)?!0:!1}}(Handlebars.Compiler,Handlebars.JavaScriptCompiler),Handlebars.precompile=function(t,e){e=e||{};var n=Handlebars.parse(t),i=(new Handlebars.Compiler).compile(n,e);return(new Handlebars.JavaScriptCompiler).compile(i,e)},Handlebars.compile=function(t,e){function n(){var n=Handlebars.parse(t),i=(new Handlebars.Compiler).compile(n,e),r=(new Handlebars.JavaScriptCompiler).compile(i,e,void 0,!0);return Handlebars.template(r)}e=e||{};var i;return function(t,e){return i||(i=n()),i.call(this,t,e)}},Handlebars.VM={template:function(t){var e={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(t,e,n){var i=this.programs[t];return n?Handlebars.VM.program(e,n):i?i:i=this.programs[t]=Handlebars.VM.program(e)},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop};return function(n,i){return i=i||{},t.call(e,Handlebars,n,i.helpers,i.partials,i.data)}},programWithDepth:function(t,e){var n=Array.prototype.slice.call(arguments,2);return function(i,r){return r=r||{},t.apply(this,[i,r.data||e].concat(n))}},program:function(t,e){return function(n,i){return i=i||{},t(n,i.data||e)}},noop:function(){return""},invokePartial:function(t,e,n,i,r,s){var o={helpers:i,partials:r,data:s};if(void 0===t)throw new Handlebars.Exception("The partial "+e+" could not be found");if(t instanceof Function)return t(n,o);if(Handlebars.compile)return r[e]=Handlebars.compile(t,{data:void 0!==s}),r[e](n,o);throw new Handlebars.Exception("The partial "+e+" could not be compiled when running in runtime-only mode")}},Handlebars.template=Handlebars.VM.template,Handlebars}),define("store",function(t,e,n){"use strict";(function(){function t(){try{return u in a&&a[u]}catch(t){return!1}}function e(){try{return l in a&&a[l]&&a[l][a.location.hostname]}catch(t){return!1}}function i(t){return function(){var e=Array.prototype.slice.call(arguments,0);e.unshift(s),d.appendChild(s),s.addBehavior("#default#userData"),s.load(u);var n=t.apply(o,e);return d.removeChild(s),n}}function r(t){return t.replace(m,"___")}var s,o={},a=window,c=a.document,u="localStorage",l="globalStorage",h="__storejs__";if(o.disabled=!1,o.set=function(){},o.get=function(){},o.remove=function(){},o.clear=function(){},o.transact=function(t,e,n){var i=o.get(t);null==n&&(n=e,e=null),void 0===i&&(i=e||{}),n(i),o.set(t,i)},o.getAll=function(){},o.serialize=function(t){return JSON.stringify(t)},o.deserialize=function(t){if("string"!=typeof t)return void 0;try{return JSON.parse(t)}catch(e){return t||void 0}},t())s=a[u],o.set=function(t,e){return void 0===e?o.remove(t):(s.setItem(t,o.serialize(e)),e)},o.get=function(t){return o.deserialize(s.getItem(t))},o.remove=function(t){s.removeItem(t)},o.clear=function(){s.clear()},o.getAll=function(){for(var t={},e=0;s.length>e;++e){var n=s.key(e);t[n]=o.get(n)}return t};else if(e())s=a[l][a.location.hostname],o.set=function(t,e){return void 0===e?o.remove(t):(s[t]=o.serialize(e),e)},o.get=function(t){return o.deserialize(s[t]&&s[t].value)},o.remove=function(t){delete s[t]},o.clear=function(){for(var t in s)delete s[t]},o.getAll=function(){for(var t={},e=0;s.length>e;++e){var n=s.key(e);t[n]=o.get(n)}return t};else if(c.documentElement.addBehavior){var d,p;try{p=new ActiveXObject("htmlfile"),p.open(),p.write('<script>document.w=window</script><iframe src="/favicon.ico"></frame>'),p.close(),d=p.w.frames[0].document,s=d.createElement("div")
}catch(f){s=c.createElement("div"),d=c.body}var m=RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");o.set=i(function(t,e,n){return e=r(e),void 0===n?o.remove(e):(t.setAttribute(e,o.serialize(n)),t.save(u),n)}),o.get=i(function(t,e){return e=r(e),o.deserialize(t.getAttribute(e))}),o.remove=i(function(t,e){e=r(e),t.removeAttribute(e),t.save(u)}),o.clear=i(function(t){var e=t.XMLDocument.documentElement.attributes;t.load(u);for(var n,i=0;n=e[i];i++)t.removeAttribute(n.name);t.save(u)}),o.getAll=i(function(t){var e=t.XMLDocument.documentElement.attributes;t.load(u);for(var n,i={},r=0;n=e[r];++r)i[n]=o.get(n);return i})}try{o.set(h,h),o.get(h)!=h&&(o.disabled=!0),o.remove(h)}catch(f){o.disabled=!0}o.enabled=!o.disabled,void 0!==n&&"function"!=typeof n?n.exports=o:"function"==typeof define&&define.amd?define(o):this.store=o})()});var TWEEN=TWEEN||function(){var t=[];return{REVISION:"10",getAll:function(){return t},removeAll:function(){t=[]},add:function(e){t.push(e)},remove:function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)},update:function(e){var n=t.length;if(0===n)return!1;var i,r=0;for(e=void 0!==e?e:void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();n>r;)i=t[r],i&&i.update(e)?r++:(t.splice(r,1),n--);return!0}}}();TWEEN.Tween=function(t){var e=t,n={},i={},r={},s=1e3,o=0,a=0,c=null,u=TWEEN.Easing.Linear.None,l=TWEEN.Interpolation.Linear,h=[],d=null,p=!1,f=null,m=null;for(var v in t)n[v]=parseFloat(t[v],10);this.to=function(t,e){return void 0!==e&&(s=e),i=t,this},this.start=function(t){TWEEN.add(this),p=!1,c=void 0!==t?t:void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),c+=a;for(var s in i){if(i[s]instanceof Array){if(0===i[s].length)continue;i[s]=[e[s]].concat(i[s])}n[s]=e[s],n[s]instanceof Array==!1&&(n[s]*=1),r[s]=n[s]||0}return this},this.stop=function(){return TWEEN.remove(this),this},this.delay=function(t){return a=t,this},this.repeat=function(t){return o=t,this},this.easing=function(t){return u=t,this},this.interpolation=function(t){return l=t,this},this.chain=function(){return h=arguments,this},this.onStart=function(t){return d=t,this},this.onUpdate=function(t){return f=t,this},this.onComplete=function(t){return m=t,this},this.update=function(t){if(c>t)return!0;p===!1&&(null!==d&&d.call(e),p=!0);var v=(t-c)/s;v=v>1?1:v;var g=u(v);for(var y in i){var b=n[y]||0,w=i[y];w instanceof Array?e[y]=l(w,g):("string"==typeof w&&(w=b+parseFloat(w,10)),e[y]=b+(w-b)*g)}if(null!==f&&f.call(e,g),1==v){if(o>0){isFinite(o)&&o--;for(var y in r)"string"==typeof i[y]&&(r[y]=r[y]+parseFloat(i[y],10)),n[y]=r[y];return c=t+a,!0}null!==m&&m.call(e);for(var k=0,x=h.length;x>k;k++)h[k].start(t);return!1}return!0}},TWEEN.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return 1>(t*=2)?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return 1>(t*=2)?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return 1>(t*=2)?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return 1>(t*=2)?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:1>(t*=2)?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return 1>(t*=2)?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){var e,n=.1,i=.4;return 0===t?0:1===t?1:(!n||1>n?(n=1,e=i/4):e=i*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)))},Out:function(t){var e,n=.1,i=.4;return 0===t?0:1===t?1:(!n||1>n?(n=1,e=i/4):e=i*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/i)+1)},InOut:function(t){var e,n=.1,i=.4;return 0===t?0:1===t?1:(!n||1>n?(n=1,e=i/4):e=i*Math.asin(1/n)/(2*Math.PI),1>(t*=2)?-.5*n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i):.5*n*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return 1>(t*=2)?.5*t*t*((e+1)*t-e):.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-TWEEN.Easing.Bounce.Out(1-t)},Out:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return.5>t?.5*TWEEN.Easing.Bounce.In(2*t):.5*TWEEN.Easing.Bounce.Out(2*t-1)+.5}}},TWEEN.Interpolation={Linear:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),s=TWEEN.Interpolation.Utils.Linear;return 0>e?s(t[0],t[1],i):e>1?s(t[n],t[n-1],n-i):s(t[r],t[r+1>n?n:r+1],i-r)},Bezier:function(t,e){var n,i=0,r=t.length-1,s=Math.pow,o=TWEEN.Interpolation.Utils.Bernstein;for(n=0;r>=n;n++)i+=s(1-e,r-n)*s(e,n)*t[n]*o(r,n);return i},CatmullRom:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),s=TWEEN.Interpolation.Utils.CatmullRom;return t[0]===t[n]?(0>e&&(r=Math.floor(i=n*(1+e))),s(t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],i-r)):0>e?t[0]-(s(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[n]-(s(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):s(t[r?r-1:0],t[r],t[r+1>n?n:r+1],t[r+2>n?n:r+2],i-r)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=TWEEN.Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var n,i=1;if(t[e])return t[e];for(n=e;n>1;n--)i*=n;return t[e]=i}}(),CatmullRom:function(t,e,n,i,r){var s=.5*(n-t),o=.5*(i-e),a=r*r,c=r*a;return(2*e-2*n+s+o)*c+(-3*e+3*n-2*s-o)*a+s*r+e}}},"function"==typeof define&&define("tween",function(){return TWEEN}),define("af",function(){"use strict";var t=window.performance&&window.performance.now,e=t?function(){return window.performance.now()}:Date.now||function(){return(new Date).getTime()},n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,i=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame;if(!n){var r=0;n=function(t){var n=e(),i=Math.max(0,16-(n-r)),s=setTimeout(function(){t(n+i)},i);return r=n+i,s}}return i||(i=function(t){clearTimeout(t)}),{request:n,cancel:i}}),define("util",function(){"use strict";var t=/^\s+/,e=/\s+$/,n=/[^0-9a-zA-Z_\u4e00-\u9fa5\ \'\.]+/g,i=String.prototype.trim,r={zh_CN:n,cut30length:function(t,e){if(!t)return"";for(t=t.replace(n," "),e||(e=30);r.utf8length(t)>e;)t=t.substring(0,t.length-1);return t},utf8length:function(t){for(var e,n=t.length,i=0,r=0;n>r;r++)if(e=t.charCodeAt(r),127>e)i++;else if(2047>=e)i+=2;else if(55295>=e||e>=57344)i+=3;else{if(!(56319>=e))throw"Error: Invalid UTF-16 sequence. Missing high-surrogate code.";if(e=t.charCodeAt(++r),56320>e||e>57343)throw"Error: Invalid UTF-16 sequence. Missing low-surrogate code.";i+=4}return i},trim:i?function(t){return null==t?"":i.call(t)}:function(n){return null==n?"":(""+n).replace(t,"").replace(e,"")},parseId:function(){var t=/^([a-z0-9_\.]{1,})@facebook$/i,e=/^@([a-z0-9_]{1,15})$|^@?([a-z0-9_]{1,15})@twitter$/i,n=/^([a-z0-9_\.]{1,})@instagram$/i,i=/^(.*)@dropbox$/i,s=/^(.*)@flickr$/i,o=/^[a-z0-9!#$%&\'*+\\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+\\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,a=/^[^@]*<[a-z0-9!#$%&\'*+\\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+\\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?>$/i,c=/^(\+)?((?:(86)?(1(?:3\d|4[57]|5\d|8\d)\d{8}))|(?:(1)?(\d{5,15})))$/;return function(u){var l,h={};if(u=r.trim(u),(l=u.match(i))&&o.test(l[1]))h.name=l[1],h.external_username=l[1],h.provider="dropbox";else if(l=u.match(s))h.name=l[1],h.external_username=l[1],h.provider="flickr";else if(l=u.match(n))h.name=l[1],h.external_username=l[1],h.provider="instagram";else if(l=u.match(t))h.name=l[1],h.external_username=l[1],h.provider="facebook";else if(l=u.match(e))h.name=l[1]||l[2],h.external_username=h.name,h.provider="twitter";else if(o.test(u))h.name=r.cut30length(u.split("@")[0]),h.external_username=u,h.provider="email";else if(a.test(u)){var d=u.indexOf("<");h.name=r.cut30length(u.substring(0,d).replace(/^"|^'|"$|'$/g,"")),h.external_username=h.name,h.provider="email"}else if(l=u.replace(/[\s\-\(\)\_]/g,"").match(c)){var p,f,m=l[1];h.provider="phone",m?l[3]&&l[4]?(p=l[3],f=l[4],h.name=h.external_username=m+p+f):l[5]&&l[6]?(p=l[5],f=l[6],h.name=h.external_username=m+p+f):(h.name=u,h.provider=null):(m="+",l[4]?(p="86",f=l[4]):(p="1",f=l[2]),h.name=h.external_username=m+p+f)}else h.name=u,h.provider=null;return h}}(),tokenRegExp:/token=([a-zA-Z0-9]{32})/,printExtUserName:function(t,e){var n=t.external_username,i=t.provider;switch(i){case"twitter":n="@"+n+"@"+i;break;case"facebook":case"instagram":case"flickr":case"dropbox":n+="@"+i;break;case"phone":e&&(/^\+1\d{10}$/.test(n)?n=n.replace(/^(\+1)(\d{3})(\d{3})(\d{4})$/,"$1 ($2) $3-$4"):/^\+86\d{11}$/.test(n)&&(n=n.replace(/^(\+86)(\d{3})(\d{4})(\d{4})$/,"$1 $2 $3 $4")))}return n}};return r}),function(){"use strict";var t=/(?:\{\{|%\{)(\w*?)(?:\}\}?)/gm,e=/^\d{4}-\d{2}-\d{2}$/,n=/^\d{2}:\d{2}:\d{2}$/,i=.2,r=6e4,s=864e5,o={monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),months:"January February March April May June July August September October November December".split(" "),weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),"-1":function(){return"Today"},0:function(t){var e="",n=t.years,i=t.months;return n&&(e="{{years}} year"+(1===n?"":"s")),i&&(e+=(e?" ":"")+"{{months}} month"+(1===i?"":"s")),e+" ago"},1:function(t){var e="",n=t.days;return e=1===n?"Yesterday":2===n?"Two days ago":"{{days}} days ago"},2:function(t){var e="",n=t.isToday,i=t.hours;return e=!n&&i>=12?"Yesterday":"{{hours}} hours ago"},3:function(){return"1.5 hours ago"},4:function(){return"An hour ago"},5:function(t,e){return"X"===e?"Just now":"{{minutes}} minutes ago"},6:function(t,e){return"X"===e?"Now":"{{minutes}} minutes ago"},7:function(t,e){return"X"===e?"Now":"Seconds ago"},8:function(){return"In {{minutes}} minutes"},9:function(){return"In one hour"},10:function(){return"In 1.5 hours"},11:function(t){var e="",n=t.isToday,i=t.hours;return e=!n&&i>=12?"Tomorrow":"In {{hours}} hours"},12:function(t){var e="",n=t.days,i=t.day;return e=1===n?"Tomorrow":2===n?"In two days":o.weekdaysShort[i]+". in {{days}} days"},13:function(t){var e="",n=t.years,i=t.months;return n&&(e="{{years}} year"+(1===n?"":"s")),i&&(e+=(e?" ":"")+"{{months}} month"+(1===i?"":"s")),"In "+e}},a=function(t,e,n,i){var r,s=a.locales[a.locale],o=a.distanceOfTime(t,e),c=a.diff(o);return c.type=n,r=a.inWords(c,s),"function"==typeof i&&(r=i(r.data)),r},c=a.parseISO=function(t){return new Date(Date.parse(t))},u=a.toISO=function(t){return t.replace(/\s/,"T").replace(/\s/,"").replace(/([+\-]\d\d)(?::?)(\d\d)/,"$1:$2")};a.locale="en",a.locales={en:o},a.inWords=function(t,e){var n,i=e[t.token],r=t.type,s=t.date;return n="function"==typeof i?i(s,r):i,v(n,s)},a.diff=function(t){var e,n,s,o,a,c,u=t.target,l=t.distance,h=g(l/r),d={date:{}},p=d.date,f=t.days;return p.isToday=t.isToday,u._isToday?d.token=-1:-43199>h?(d.token=0,s=g(-h/525949),n=g(-h%525949/43829+i)):-1439>h?(d.token=1,e=3>-f?-f:g((-h+1439)/1440)):-107>h?(d.token=2,o=g(-h/60+i)):-81>h?d.token=3:-59>h?d.token=4:-29>h?(d.token=5,a=-h):0>h?(d.token=6,a=-h):0===h?d.token=7:60>h?(d.token=8,a=h):82>h?d.token=9:108>h?d.token=10:1440>h?(d.token=11,o=g(h/60+i)):43200>h?(d.token=12,e=3>f?f:g((h+1439)/1440),c=u.getDay()):(d.token=13,s=g(h/525949),n=g(h%525949/43829+i),12===n&&(n=0,s++)),s&&(p.years=s),n&&(p.months=n),e&&(p.days=e),o&&(p.hours=o),a&&(p.minutes=a),void 0!==c&&(p.day=c),d},a.distanceOfTime=function(t,e){t?"number"==typeof t?t=new Date(t):"string"==typeof t&&(t=c(u(t))):t=new Date,e?"number"==typeof e?e=new Date(e):"string"==typeof e&&(e=c(u(e))):e=new Date,t._reTime&&(e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0));var n=t.getFullYear(),i=t.getMonth(),r=t.getDate(),o=e.getFullYear(),a=e.getMonth(),l=e.getDate();return{target:t,source:e,distance:+t-+e,days:(+new Date(n,i,r)-+new Date(o,a,l))/s,isToday:n===o&&i===a&&r===l}},a.toLocaleDate=function(t){var e,n,i,r=t.outputformat,s=new Date,o=s.getFullYear()+"-"+p(s.getMonth()+1)+"-"+p(s.getDate()),a=!1,u=!1;if(r)e=s,i=o,a=!0;else{var l=t.begin_at,h=l.date,d=l.time,v=l.timezone,g="";h?(g=f(h),d?g+="T"+m(d):(u=!0,a=g===o)):(g=o,d&&(g+="T"+m(d))),h&&d&&v&&(g+="Z"),e=c(g),u&&(e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)),n=i=e.getFullYear()+"-"+p(e.getMonth()+1)+"-"+p(e.getDate()),i+=d?" "+p(e.getHours())+":"+p(e.getMinutes())+":"+p(e.getSeconds()):""}return e._isToday=a,e._reTime=u,{date:e,text:i}};var l={date:function(t,e,n,i){var r=a.locales[a.locale];return r.weekdaysShort[i]+", "+r.monthsShort[e]+" "+n},time:function(t,e){var n=t>12?t-12:t,i=n+":"+p(e);return i+=t>=12?"PM":"AM"}};a.printEFTime=function(t,e,n){var i,r,s,o,c,u=t.outputformat,p=t.begin_at,f="X"===e,m={title:"",content:""},v=new Date;if(u)i=t.origin.replace(/^['"‘’“”“”‚„]+/,"").replace(/['"‘’“”“”‚„]+$/,""),m.title=i,f||(m.content=i,p.date&&(t.outputformat=0,r=a.toLocaleDate(t),m.content=a(r.date,v),t.outputformat=1));else if(n||(n=l),p&&(p.date||p.time?(r=a.toLocaleDate(t),s=r.date,p.date?(m.title=a(r.date,v,"X"),m.content=p.time_word+(p.time_word&&p.time?" ":"")+(p.time?n.time(s.getHours(),s.getMinutes()):"")+(p.time||p.time_word?p.time?" ":", ":"")+n.date(s.getFullYear(),s.getMonth(),s.getDate(),s.getDay())+(p.date_word?" ":"")+p.date_word):p.time&&(m.content=m.title=p.time_word+(p.time_word?" ":"")+n.time(s.getHours(),s.getMinutes())+(p.date_word?", ":"")+p.date_word),s.getFullYear()!==v.getFullYear()&&(m.content+=" "+s.getFullYear())):(p.date_word||p.time_word)&&(m.content=m.title=p.time_word+(p.time_word?", ":"")+p.date_word),p.timezone&&(o=p.timezone.replace(/^([+\-]\d\d:\d\d)[\w\W]*$/,"$1"),c=h(v),o!==c))){var g=d(v);m.content+=" ("+c+(g&&" "+g)+")"}return m},a.printTime=function(t,e){t||(t=new Date),e||(e=l);var n=new Date,i="";return i+=e.date(t.getFullYear(),t.getMonth(),t.getDate(),t.getDay())+" "+e.time(t.getHours(),t.getMinutes()),t.getFullYear()!==n.getFullYear()&&(i+=" "+t.getFullYear()),i};var h=a.getTimezone=function(t){var e,n,i,r;return t||(t=new Date),e=t.getTimezoneOffset(),r=0>=e?"+":"-",e=Math.abs(e),n=g(e/60),i=e-60*n,r+p(n)+":"+p(i)},d=function(t){var e;return t||(t=new Date),e=(""+t).replace(/^.*:\d\d( GMT[+-]\d+)? \(?([A-Za-z ]+)\)?\d*$/,"$2").replace(/[a-z ]/g,""),3===e.length?e:""};a.createEFTime=function(){return{begin_at:{date_word:"",date:"",time_word:"",time:"",timezone:"",id:0,type:"EFTime"},origin:"",outputformat:1,id:0,type:"CrossTime"}};var p=a.lead0=function(t,e){for(t=""+t,e||(e=2);e>t.length;)t="0"+t;return t},f=a.formatDate=function(t){var n;return e.test(t)?n=t:(n=t.split("-"),n[1]=p(n[1]),n[2]=p(n[2]),n=n.join("-")),n},m=a.formatTime=function(t){var e;return n.test(t)?e=t:(e=t.split(":"),e[0]=p(e[0]),e[1]=p(e[1]),e[2]=p(e[2]),e=e.join(":")),e},v=function(e,n){var i,r,s,o,a=e.match(t),c=0;if(a)for(;o=a[c];++c)r=o.replace(t,"$1"),s=n[r],i=RegExp(o.replace(/\{/gm,"\\{").replace(/\}/gm,"\\}")),e=e.replace(i,s);return e},g=function(t){return t-t%1};"function"==typeof define&&define("humantime",function(){return a})}(),define("lightsaber",function(t,e,n){"use strict";function i(){var t=new r;return v(t,b.prototype),t.request=new s,t.response=new o,t.init(),t}function r(){}function s(t){this.enableFullUrlPath=!!t,this.session={},this.path="/",this.method="GET",this.updateUrl()}function o(t,e){this.path=t,this.title=document.title,this.state=e||{}}function a(t){t=t||{};var e=this;this.map=[],this.params={},this._params=[],this.caseSensitive=t.caseSensitive,this.strict=t.strict,this.middleware=function(t,n,i){e._dispatch(t,n,i)}}function c(t,e,n){n=n||{},this.path=t,this.callbacks=e,this.regexp=g(t,this.keys=[],n.sensitive,n.strict)}function u(t,e,n){e=e||{},this.name=t,this.root=e.root,this.engine=e.engine,this.ext=f(t),this.timestamp=n||"",this.path=this.lookup(t)}function l(t){return function(e,n,i){e.app=n.app=t,e.next=i,n.locals=n.locals||m(n),i()}}function h(){return++h.id}function d(t,e,n){var i=t.length;if(!i)return-1;if(n||(n=0),n>i)return-1;for(0>n&&(n=Math.max(0,i+n));i>n;++n)if(n in t&&t[n]===e)return n;return-1}function p(t,e,n,i,r){return w.get(e,function(e){var s,o=e;"html"!==r&&(s=t.compile(e),o=s(n)),i(o)})}function f(t){return t.split(".")[1]||"html"}function m(t){function e(t){for(var n in t)e[n]=t[n];return t}return t.viewCallbacks=t.viewCallbacks||[],e}function v(t,e){var n;if(t&&e)for(n in e)t[n]=e[n];return t}function g(t,e,n,i){return t instanceof RegExp?t:(T(t)&&(t="("+t.join("|")+")"),t=t.concat(i?"":"/?").replace(/\/\(/g,"(?:/").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?(\*)?/g,function(t,n,i,r,s,o,a){return e.push({name:r,optional:!!o}),n=n||"",""+(o?"":n)+"(?:"+(o?n:"")+(i||"")+(s||i&&"([^/.]+?)"||"([^/]+?)")+")"+(o||"")+(a?"(/*)?":"")}).replace(/([\/.])/g,"\\$1").replace(/\*/g,"(.*)"),RegExp("^"+t+"$",n?"":"i"))}var y,b=t("emitter"),w=t("jquery")||t("zepto"),k=w.proxy,x=window.location,_=window.history,E="/",C=!1;w(window).on("load",function(){C=!0,setTimeout(function(){C=!1},0)}),e=n.exports=i;var S;e.version="0.0.5",S=r.prototype,S.historySupport=y=null!==(null!==_?_.pushState:void 0),w.browser&&w.browser.opera&&(S.historySupport=y=!1),S.init=function(){this.route=E,this.stack=[],this.cache={},this.settings={},this.engines={},this.viewCallbacks=[],this.defaultConfiguration()},S.defaultConfiguration=function(){this.set("env","production"),this.enable("dispatch"),this.use(l(this)),this._usedRouter=!1,this._router=new a(this),this.routes=this._router.map,this._router.caseSensitive=this.enabled("case sensitive routing"),this._router.strict=this.enabled("strict routing"),this.locals=m(this),this.locals.settings=this.settings,this.configure("development",function(){this.set("env","development")}),this.configure("production",function(){this.enable("view cache")})},S.use=function(t,e){return"string"!=typeof t&&(e=t,t=E),E!==t&&E===t[t.length-1]&&(t=t.slice(0,-1)),this.stack.push({route:t,handle:e}),this},S.engine=function(t,e){if("function"!=typeof e)throw Error("callback function required");return"."!==t[0]&&(t="."+t),this.engines[t]=e,this},S.set=function(t,e){return 1!==arguments.length?(this.settings[t]=e,this):this.settings.hasOwnProperty(t)?this.settings[t]:void 0},S.enabled=function(t){return!!this.set(t)},S.disabled=function(t){return!this.set(t)},S.enable=function(t){return this.set(t,!0)},S.disable=function(t){return this.set(t,!1)},S.configure=function(t,e){var n="all",i=[].slice.call(arguments);return e=i.pop(),i.length&&(n=i),("all"===n||~d(n,this.settings.env))&&e.call(this),this},S.render=function(t,e,n){var i,r={},s=this.cache;if(this.engine,"function"==typeof e&&(n=e,e={}),v(r,this.locals),e.locals&&v(r,e.locals),v(r,e),r.cache=null===r.cache?this.enabled("view cache"):r.cache,r.cache&&(i=s[t]),!i){if(i=new u(t,{engine:this.set("view engine"),root:this.set("views")},this.set("timestamp")),!i.path){var o=Error('Failed to lookup view "'+t+'"');return o.view=i,n(o)}r.cache&&(s[t]=i)}try{i.render(r,n)}catch(o){n(o)}},S.path=function(){return this.route},S.param=function(t,e){var n,i=[].slice.call(arguments,1),r=0;if(T(t))for(n=t.length;n>r;++r)for(var s=0,o=i.length;o>s;++s)this.param(t[r],i[s]);else if("function"==typeof t)this._router.param(t);else for(":"===t[0]&&(t=t.substr(1)),n=i.length;n>r;++r)this._router.param(t,e);return this},S.initRouter=function(){this._usedRouter===!1&&(this._usedRouter=!0,this.use(this._router.middleware))},S.get=function(){var t=[].slice.call(arguments);return this.initRouter(),this._router.route.apply(this._router,t)},S.handle=function(t,e){function n(a){var c,u=i[o++];if(s&&(t.url=t.url.substr(1),s=!1),t.url=r+t.url,u)try{if(c=t.url,0!==c.indexOf(u.route))return n(a);var l=u.handle.length;r=u.route,t.url=t.url.substr(r.length),"/"!==t.url[0]&&(t.url="/"+t.url,s=!0),a?4===l?u.handle(a,t,e,n):n(a):4>l?u.handle(t,e,n):n()}catch(h){n(h)}}var i=this.stack,r="",s=!1,o=0;n()},S.run=function(t){this.emit("launch"),t=t||{};var e=this.request,n=this.response;this.running||(this.running=!0,!1===t.dispatch&&this.disable("dispatch"),!1!==t.popstate&&(this.historySupport?w(window).on("popstate",k(this.change,this)):w(window).on("hashchange",k(this.change,this))),this.disabled("dispatch")||(this.handle(e,n),this.emit("launched")))},S.change=function(t){if(C)return C=!1;var e=this,n=e.request,i=e.response,r=n.url;return n.updateUrl(),"/"===r||r!==n.url?(e.handle(n,i),t.stopPropagation(),t.preventDefault(),!1):void 0},S.error=function(t,e){var n=Error(e);return n.status=t,n},S=s.prototype,S.updateUrl=function(){this.host=x.hostname,this.port=x.port||80,this.fullpath=x.pathname,this.enableFullUrlPath&&(this.path=this.fullpath),this.hash=decodeURIComponent(x.hash),this.querystring=decodeURIComponent(x.search),this.url=this.path+this.querystring+this.hash},S.param=function(t,e){var n=this.params||{},i=this.query||{};return null!=n[t]&&n.hasOwnProperty(t)?n[t]:null!=i[t]?i[t]:e},S.getPath=function(){return this.path},S.getHost=function(){return this.host},S=o.prototype,S.location=function(t){window.setTimeout(function(){x.href=t},16)},S.redirect=function(t){var e,n;return arguments.length,t=arguments[0],"back"===t||"forward"===t?(_[t](),void 0):y?(e=arguments[1],n=arguments[2]||{},this.path=t,this.title=e||"EXFE.COM",document.title=this.title,this.state=n,this.state.id=h(),this.pushState(),w(window).triggerHandler("popstate"),void 0):(this.location(t),void 0)},S.save=function(){_.replaceState(this.state,this.title,this.path)},S.pushState=function(){_.pushState(this.state,this.title,this.path)},S.render=function(t,e,n){var i=this,e=e||{},r=this.app;"function"==typeof e&&(n=e,e={}),e.locals=i.locals,r.render(t,e,n)},S=a.prototype,S.param=function(t,e){if("function"==typeof t)return this._params.push(t),void 0;var n,i,r=this._params,s=r.length;for(i=0;s>i;++i)(n=r[i](t,e))&&(e=n);if("function"!=typeof e)throw Error("invalid param() call for "+t+", got "+e);return(this.params[t]=this.params[t]||[]).push(e),this},S._dispatch=function(t,e,n){var i=this.params,r=this;(function s(o,a){function c(e){s(t._route_index+1,e)}function u(e){g=0,v=m[o++],p=v&&t.params[v.name],d=v&&i[v.name];try{"route"===e?c():e?(o=0,h(e)):d&&void 0!==p?l():v?u():(o=0,h())}catch(e){u(e)}}function l(n){var i=d[g++];return n||!i?u(n):(i(t,e,l,p,v.name),void 0)}function h(n){var i=f.callbacks[o++];try{if("route"===n)c();else if(n&&i){if(4>i.length)return h(n);i(n,t,e,h)}else i?i(t,e,h):c(n)}catch(n){h(n)}}var d,p,f,m,v,g=0;return t.route=f=r.matchRequest(t,o),f?(t.params=f.params,m=f.keys,o=0,u(a),void 0):n(a)})(0)},S.matchRequest=function(t,e){var n,i=t.url,r=this.map,s=r.length;for(e=e||0;s>e;++e)if(n=r[e],n.match(i))return t._route_index=e,n},S.route=function(t){t||Error("Router#get() requires a path");var e=[].slice.call(arguments,1),n=new c(t,e,{sensitive:this.caseSensitive,strict:this.strict});return(this.map=this.map||[]).push(n),this},S=c.prototype,S.match=function(t){this.regexp.lastIndex=0;var e,n,i,r,s=this.keys,o=this.params=[],a=this.regexp.exec(t);if(!a)return!1;for(e=1,n=a.length;n>e;++e)i=s[e-1],r="string"==typeof a[e]?decodeURIComponent(a[e]):a[e],i?o[i.name]=r:o.push(r);return!0},S=u.prototype,S.lookup=function(t){return this.root+"/"+t+"?t="+this.timestamp},S.render=function(t,e){return p(this.engine,this.path,t,e,this.ext)},h.id=0;var T=Array.isArray;T||(T=function(t){return t instanceof Array})}),define("live",function(t){"use strict";function e(){navigator.geolocation.clearWatch(N)}function n(){N=navigator.geolocation.watchPosition(function(t){t&&t.coords&&t.coords.latitude&&t.coords.longitude&&t.coords.accuracy&&(d.latitude=""+t.coords.latitude,d.longitude=""+t.coords.longitude,d.accuracy=""+t.coords.accuracy,c=a-5,g("Location update: lat = "+d.latitude+", "+"lng = "+d.longitude+", "+"acu = "+d.accuracy))})}var i=window._ENV_,r=i.streaming_api_url,s=i.api_url;t("store");var o="",a=30,c=a,u=!1,l=null,h="",d={card:{id:"",name:"",avatar:"",bio:"",identities:[],timestamp:0},latitude:"",longitude:"",accuracy:"",traits:[]},p=Date.now||function(){return(new Date).getTime()},r=r,f=null,m=null,v=null,g=function(t,e){if(u){var n=Object.prototype.toString.call(t),i=""+new Date;"[object String]"!==n&&"[object Number]"!==n&&(t=JSON.stringify(t)),console.log(i.replace(/^.*(\d{2}:\d{2}:\d{2}).*$/,"$1")+" - "+t),e&&console.table&&console.table(e)}},y=function(){c=0,g("Breathe with"+(o?" token: "+o:"out token")),f&&f.abort(),f=$.ajax({type:"post",url:r+"/v3/live/cards"+(o?"?token="+o:""),data:JSON.stringify(d),success:function(t){var e=t;e&&e.length&&(c=0,o!==e[0]&&(g("Got new token: "+e[0]+", id: "+e[1]),x.live&&(x.kill(),g("Close current stream")),c=a),o=e[0],d.card.id=e[1])},error:function(t){t.status&&t.status>=400&&499>=t.status?(o&&g("Repeal token: "+o),o="",c=a):(c=a-5,g("Network error"))}}),!x.live&&o&&(x.init(r+"/v3/live/streaming?token="+o,b,w),g("Streaming with token: "+o))},b=function(t){if(t&&t.length){var e=JSON.parse(t[t.length-1]);if(e&&e.length){var n={};for(var i in e)e[i].id&&(e[i].id===d.card.id?(d.card.name=e[i].name,d.card.avatar=e[i].avatar,d.card.bio=e[i].bio,d.card.identities=e[i].identities,d.card.timestamp=e[i].timestamp):(e[i].avatar||(e[i].avatar=encodeURI(s+"/avatar/default?name="+e[i].name)),n[e[i].id]=e[i]));var r={me:S(d.card),others:n},o=JSON.stringify(r);g("Streaming pops: "+o,n),l&&h!==o&&(g("Callback"),l(r),h=o)}else g("Data error")}},w=function(){g("Streaming is dead")},k=function(){C(d.card)&&++c>=a&&y()},x={prvLen:null,nxtIdx:null,timer:null,http:null,pop:null,dead:null,live:!1,init:function(t,e,n){this.prvLen=0,this.nxtIdx=0,this.live=!0,this.pop=e,this.dead=n,this.http=new XMLHttpRequest,this.http.open("post",t),this.http.onreadystatechange=this.listen,this.http.send(),this.timer=setInterval(this.listen,1e3)},listen:function(){if(!(4!==x.http.readyState&&3!==x.http.readyState||3===x.http.readyState&&200!==x.http.status||null===x.http.responseText)){for(4===x.http.readyState&&200!==x.http.status&&x.kill();x.prvLen!==x.http.responseText.length&&(4!==x.http.readyState||x.prvLen!==x.http.responseText.length);){x.prvLen=x.http.responseText.length;var t=x.http.responseText.substring(x.nxtIdx),e=t.split("\n");x.nxtIdx+=t.lastIndexOf("\n")+1,"\n"===t[t.length-1]&&e[e.length]||e.pop(),x.pop&&x.pop(e)}4===x.http.readyState&&x.prvLen===x.http.responseText.length&&x.kill()}},kill:function(){clearInterval(this.timer),this.http&&this.http.abort(),this.dead&&this.dead(),this.live=!1}},_=function(){if(void 0===window.DeviceMotionEvent)return null;var t=50,e=0,n=0,i=0,r=0,s=0,o=0;window.addEventListener("devicemotion",function(t){e=t.accelerationIncludingGravity.x,n=t.accelerationIncludingGravity.y,i=t.accelerationIncludingGravity.z},!1),setInterval(function(){var a=Math.abs(e-r+n-s+i-o);a>t&&(m&&m(),v&&setTimeout(v,1e3)),r=e,s=n,o=i},100)},E=function(t){return t&&t.external_username&&t.provider?!0:!1},C=function(t){if(t&&t.name&&t.identities&&t.identities.length){for(var e in t.identities)if(E(t.identities[e])===!1)return!1;return!0}},S=function(t){switch(Object.prototype.toString.call(t)){case"[object Object]":var e={};for(var n in t)e[n]=S(t[n]);break;case"[object Array]":e=[];for(n in t)e.push(S(t[n]));break;default:e=t}return e},T={init:function(t,e){C(t)?(x.kill(),d.card.name=t.name,d.card.avatar=t.avatar,d.card.bio=t.bio,d.card.identities=S(t.identities),d.card.timestamp=p(),g("Set my card: "+JSON.stringify(d.card))):g("Card error"),e&&(l=e,g("Set callback function")),c=a},shake:function(t,e){m=t,v=e},startGeo:n,stopGeo:e};setInterval(k,1e3),_(m,v);var N;return window.addEventListener("load",function(){setTimeout(function(){window.scrollTo(0,0)},0)}),T}),define("mobilemiddleware",function(t,e,n){"use strict";var i=function(){var t=document.getElementsByTagName("head")[0],e=document.getElementsByName("sms-token")[0],n=null;return e&&(n=JSON.parse(e.content),t.removeChild(e)),n},r=navigator.userAgent.match(/iPhone/);n.exports={setHtmlHeight:function(t,e,n){setTimeout(function(){window.scrollTo(0,0)},0),r||$("#app-main").addClass("app-box");var i=document.documentElement,s=window.innerHeight,o=t.app;s>=444?s=508:356>=s&&(s=420),o.screen={width:320,height:s,ios:420>=s?"iphone4":""},i.style.minHeight=s+"px",n()},checkStorageSupported:function(t,e,n){try{var i=window.localStorage;i&&(i.setItem("storage",0),i.removeItem("storage"))}catch(r){alert("EXFE cannot be used in private browsing mode.")}n()},checkSMSToken:function(t,e,n){var r=i();if(r){var s=r.action;return t.resolveToken=r,"VERIFIED"===s?e.redirect("/#verify"):"INPUT_NEW_PASSWORD"===s&&e.redirect("/#set_password"),void 0}n()},cleanup:function(t,e,n){delete t.smsToken,$("#app-body").css("height","auto"),$("#app-header").addClass("hide"),$("#app-footer").removeClass("ft-bg");var i=t.switchPageCallback;i?i():$("#app-body .page").addClass("hide"),delete t.switchPageCallback,n()},errorHandler:function(t,e){t.error={code:404},e.redirect("/")}}}),define("mobilecontroller",function(t,e,n){"use strict";var i=t("base"),r=t("store"),s=t("tween"),o=window._ENV_.api_url,a=t("handlebars"),c=t("util"),u=c.trim,l=c.parseId,h=navigator.userAgent.match(/iPad/),d=t("live"),p=function(t,e){return t.replace(e?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},f=Date.now||function(){return(new Date).getTime()},m=function(){window.location="itms://itunes.apple.com/us/app/exfe/id514026604"},v=function(t){App.set("tryRedirectAt",f()),window.location="exfe://crosses/"+(t||"")},g="webkitTransform"in document.body.style,y=function(t,e){var n=6===e.length?"":"3d";t.style[g?"webkitTransform":"transform"]="matrix"+n+"("+e.join(",")+")"},b=function(){var t=r.get("livecard");if(!t){var e={id:"",name:"",avatar:"",bio:"",identities:[]};t={card:e,latitude:"",longitude:"",accuracy:"",traits:[]};var n=r.get("user");n&&(e.name=n.name,e.avatar=n.avatar_filename,e.bio=n.bio,e.identities=n.identities),r.set("livecard",t)}return t.card.id="",t},w=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],k=[1,0,0,0,0,1,0,0,0,0,1,0,128,28,0,1],x=[1,0,0,0,0,1,0,0,0,0,1,0,128,0,0,1],_=0,E=function(){return"Controller-"+_++};e=n.exports={};var C=i.extend({initialize:function(t){this.cid=E(),this.initOptions(t),this.parseElement(),this.init(),C.caches[this.cid]=this},parseElement:function(){var t=this.element,e=this.options.template;if(t?this.element=t instanceof $?t:$(t):e&&(this.element=$(e)),!this.element)throw"element is invalid";this.element.attr("data-page-id",this.cid)},initOptions:function(t){this.setOptions(t);for(var e in t)"options"!==e&&(this[e]=t[e])},init:function(){},destory:function(){this.element.off(),this._destory()},_destory:function(){delete C.caches[this.cid],C.superclass.destory.call(this)},$:function(t){return this.element.find(t)}});C.caches=[],e.FooterController=C.extend({countDown:5,element:$("#app-footer"),init:function(){this.listen()},enableTimer:!0,listen:function(){var t=this,e=t.element;e.on("click.footer",".redirecting, .web-version",function(){window.location.href="/?ipad"+location.hash}).on("click.footer",".get-button button",function(){m()}).on("keydown.footer","#email",function(e){if(13===e.keyCode){var n=t.$("#email").val();t.addNotificationIdentity(n)
}}).on("click.footer",".subscribe .btn_mail",function(){var e=u(t.$("#email").val());t.addNotificationIdentity(e)}),this.on("show",function(t,e,n,i){var r=t.height-96-(e?60:0);this.element.removeClass("hide"),this.element.css({position:"relative",top:r+"px"}),this.enableTimer&&this.emit("start-redirect"),h&&this.$(".web-version").removeClass("hide"),this.$(".error-info").toggleClass("hide",!i)}),this.on("reset-position",function(){var t=App.screen.height-96;this.element.removeClass("hide"),this.element.css({position:"absolute",top:t+"px"}),h&&this.$(".web-version").removeClass("hide")}),this.on("show-from-cross",function(t,e,n,i){this.element.css({position:"relative",top:0}),this.emit("stop-redirect"),this.element.addClass("ft-bg"),this.cross={exfee_id:t,token:e},this.$(".actions").addClass("action-cross"),this.$(".action").addClass("hide"),n&&this.$(".subscribe").removeClass("hide"),this.element.removeClass("hide"),$("#app-footer").addClass("ft-bg"),i&&this.enableTimer?this.emit("start-redirect",i):(this.$(".get-button").removeClass("hide"),$(".redirect").addClass("hide")),h&&this.$(".web-version").removeClass("hide")}),this.on("show-from-resolve-token",function(){this.emit("stop-redirect"),1>this.countDown?($(".redirecting").removeClass("hide"),v()):this.emit("start-redirect")}),this.on("start-redirect",function(e){this.$(".get-button").addClass("hide");var n,i=$(".redirecting").removeClass("hide"),r=i.find(".sec"),s=t.countDown;r.text(n=s),this.App.set("redirectTimer",setInterval(function(){t.countDown=n-=1,n>=1?r.text(n):(i.addClass("hide"),t.emit("stop-redirect"),v(e))},1e3))}),this.on("stop-redirect",function(){this.enableTimer=!1,this.$(".get-button").removeClass("hide"),$(".redirecting").addClass("hide"),this.App.set("redirectTimer",clearInterval(this.App.set("redirectTimer")))})},addNotificationIdentity:function(t,e,n){e=this.cross.exfee_id,n=this.cross.token;var i=l(t);return i&&"email"!==i.provider?($("#email.email").attr("placeholder","Bad email Address."),void 0):($.ajax({type:"POST",url:o+"/Exfee/"+e+"/AddNotificationIdentity"+"?token="+n,data:{provider:i.provider,external_username:i.external_username},success:function(t){t&&t.meta&&200===t.meta.code&&$(".subscribe").hide()},error:function(){alert("Failed, please retry later.")}}),void 0)}}),e.VerifyController=C.extend({init:function(){this.render(),this.listen()},render:function(){$("#app-verify").length||this.element.appendTo($("#app-body"))},listen:function(){var t=this,e=this.resolveToken;this.on("show",function(n,i){setTimeout(function(){window.scrollTo(0,0)},14);var r=function(){n.error=!0,i.redirect("/")};this.element.removeClass("hide"),$("#app-body").css("height","100%"),App.controllers.footer.emit("reset-position"),$.ajax({type:"POST",url:o+"/Users/"+e.user_id+"?token="+e.token,data:{token:e.token},success:function(n){var i=n.meta;if(i&&200===i.code)for(var s=n.response.user,o=s.identities,a=0,c=o.length;c>a;++a){var u=o[a];if(u.id===e.identity_id){t.showIdentity(u),t.$(".done-info").removeClass("hide"),App.controllers.footer.emit("show-from-resolve-token");break}}else r()},error:function(){r()}})})},showIdentity:function(t){var e=this.$(".identity");e.find(".name").text(t.name),e.find(".avatar").attr("src",t.avatar_filename)}}),e.SetPasswordController=C.extend({init:function(){this.render(),this.listen()},render:function(){$("#app-setpassword").length||this.element.appendTo($("#app-body"))},submitPassword:function(){var t=this,e=this.token,n=this.$(".set-button button"),i=this.$(".error-info"),r=this.$("#name"),s=this.$("#password"),a=s.val();a.length>=4?(n.addClass("disabled").prop("disabled",!0),$.ajax({type:"POST",url:o+"/Users/ResetPassword",data:{token:e,name:name,password:a},success:function(e){var o=e.meta;o&&200===o.code?(r.blur(),s.blur(),t.$(".done-info").removeClass("hide"),i.html("").addClass("hide"),n.parent().addClass("hide"),App.controllers.footer.emit("show-from-resolve-token")):n.removeClass("disabled").prop("disabled",!0),n.removeClass("disabled").prop("disabled",!0)},error:function(){i.html("Failed to set password. Please try later.").removeClass("hide"),n.removeClass("disabled").prop("disabled",!1)}})):i.html("Password must be longer than four!").removeClass("hide")},listen:function(){var t,e,n=this,i=this.element,r=this.resolveToken;i.on("touchstart.setpassword",".pass",function(){e&&(clearTimeout(e),e=void 0),t=f();var n=$(this).prev();n.prop("type","password")}).on("touchend.setpassword",".pass",function(n){if(f()-t>300){var i=$(this).prev();i.prop("type","text"),e=setTimeout(function(){i.prop("type","password")},500)}return n.preventDefault(),n.stopPropagation(),!1}).on("keydown.setpassword","#password",function(t){13===t.keyCode?n.submitPassword():n.$(".error-info").html("")}).on("touchstart.setpassword",".set-button button",function(){n.submitPassword()}),this.on("show",function(t,e){setTimeout(function(){window.scrollTo(0,0)},0);var n=function(){t.error=!0,e.redirect("/")};i.removeClass("hide"),$("#app-body").css("height","100%"),$.ajax({type:"POST",url:o+"/Users/"+r.user_id+"?token="+r.token,data:{token:r.token},success:function(t){var e=t.response.user;return t&&t.meta&&200===t.meta.code?($(".identity .avatar").attr("src",e.avatar_filename),$(".identity .name").html(e.name),void 0):(n(),void 0)},error:function(){n()}}),App.controllers.footer.emit("reset-position")})}}),e.HomeController=C.extend({init:function(){this.render(),this.listen()},render:function(){$("#app-home").length||this.element.appendTo($("#app-body"))},listen:function(){var t=this,e=this.element;e.on("touchstart.home","#home-card",function(){clearInterval(App.set("tryTimer")),App.set("tryTimer",void 0),t.stopAnimate(),t.emit("goto-live")}),this.on("goto-live",function(){App.controllers.footer.emit("stop-redirect"),App.request.switchPageCallback=function(){e.addClass("hide")},App.response.redirect("/#live")}),this.on("show",function(t,n){var i=t.height;this.$(".logo-box .inner").css("top",(i-300)/2+"px"),e.removeClass("hide"),x[13]=(i-64)/2,this.setHomeCard(x),n=!(!n||404!==n.code);var r=this.$(".title");r.find(".normal").removeClass("hide"),n&&setTimeout(function(){alert("Sorry. Your link is invalid or expired. Requested page was not found.")},14),this.$("#home-card").css("display","none")})},setHomeCard:function(t){var e=b(),n=e.card,i=n.name,r=n.avatar,s=this.$("#home-card");y(s[0],t),n&&(i||r)?(r||(r=i?o+"/avatar/default?name="+i:"/static/img/portrait_default.png"),r="url("+r+")"):r="",s.find(".avatar").css("background-image",r)},aopts:{o:1},createAnimate:function(){var t=this.aopts,e=document.getElementById("big-logo"),n=document.getElementById("home-card"),i=function(){e.style.opacity=t.o,n.style.opacity=1-t.o};this._a=new s.Tween(t).delay(1377).to({o:0},1377).easing(s.Easing.Cubic.InOut).onUpdate(i),this._b=new s.Tween(t).delay(1377).to({o:1},1377).easing(s.Easing.Cubic.InOut).onUpdate(i)},startAnimate:function(){this._a||this._b||this.createAnimate(),this._a.chain(this._b),this._b.chain(this._a),this._a.start()},stopAnimate:function(){var t=this.aopts,e=document.getElementById("big-logo"),n=document.getElementById("home-card");this._a.chain(),this._b.chain(),this._b.stop(),this._a.stop(),t.o=e.style.opacity=1,n.style.opacity=0}}),e.CrossController=C.extend({init:function(){this.render(),this.listen()},render:function(){$("#app-cross").length||this.element.appendTo($("#app-body")),$("#app-cross").removeClass("hide")},listen:function(){var t=this,e=this.element,n=this.token,i=this.cross,r=t.$(".rsvp_toolbar");e.on("touchstart.cross",".portrait.me",function(){r.toggleClass("rsvp_toolbar_off",!r.hasClass("rsvp_toolbar_off"))}).on("touchstart.cross",".changename",function(){var e=prompt("Change my display name:");e?$.ajax({type:"POST",url:o+"/Identities/"+i.identity.id+"/Update"+"?token="+n,data:{name:e},success:function(e){e&&e.meta&&200===e.meta.code&&t.$(".name_me").html(p(e.response.identity.name))},error:function(){alert("Failed, please retry later.")}}):alert("Display name cannot be empty.")}).on("touchstart.cross",".rsvp.accepted, .rsvp.unavailable",function(){var e=$(this).hasClass("accepted")?"ACCEPTED":"DECLINED";t.rsvp(e)}).on("touchstart.cross",".inf_area .description",function(){var t=$(this),e=t.hasClass("clickable");if(e){var n=t.hasClass("limit");t.toggleClass("limit",!n),t.find(".xbtn-more .rb").toggleClass("hidden",n),t.find(".xbtn-more .lt").toggleClass("hidden",!n)}}),this.on("show",function(){e.removeClass("hide");var t=this.$(".inf_area .description");t.height()>130&&(t.addClass("limit clickable"),t.find(".xbtn-more").removeClass("hide"),t.find(".xbtn-more .rb").removeClass("hidden"))})},rsvp:function(t){var e=this.cross.identity.id,n=this.exfee_id,i=this.token,r=[{rsvp_status:t,identity_id:e,by_identity_id:e}];this.$(".rsvp_toolbar").addClass("rsvp_toolbar_off");var s=this.$(".portrait_rsvp_me").removeClass("accepted declined pending");switch(t){case"ACCEPTED":s.addClass("accepted");break;case"DECLINED":s.addClass("declined");break;default:s.addClass("pending")}$.ajax({type:"post",url:o+"/Exfee/"+n+"/Rsvp?token="+i,data:{rsvp:JSON.stringify(r)},success:function(){},error:function(){alert("RSVP failed!")}})}}),e.LiveController=C.extend({init:function(){this.render(),this.listen()},render:function(){$("#app-live").length?this.element=$("#app-live"):this.element.appendTo($("#app-body"))},listen:function(){var t,e,n=this,i=this.element;i.on("touchstart.live","#card-name",function(t){t.stopPropagation(),setTimeout(function(){window.scrollTo(0,0)},0),this.focus()}).on("touchend.live",".live-form",function(t){t.stopPropagation(),$(t.target).hasClass("live-form")&&(i.find(".input-item").blur(),App.response.redirect("/"))}).on("keydown.live","#card-name",function(t){var e=t.keyCode,i=u(this.value);i&&13===e&&n.addEmailOrPhone(this,i)}).on("blur.live","#card-name",function(){var t=u(this.value);t?n.addEmailOrPhone(this,t):n.setCardName(this)}).on("keydown.live blur.live","#add-identity",function(t){var e=t.keyCode,i=u(this.value);(i&&13===e||"blur"===t.type)&&(n.addEmailOrPhone(this,i,!0),this.value="")}).on("keydown.live blur.live","#facebook-identity",function(t){var e=t.keyCode,i=u(this.value);(i&&13===e||"blur"===t.type)&&(i+="@facebook",n.addFacebook(this,i)&&$("#add-identity-facebook").addClass("hide"),this.value="")}).on("touchstart.live",".list .input-item",function(){$(this).next().removeClass("hidden")}).on("blur.live",".list .input-item",function(){$(this).next().addClass("hidden"),n.updateIdentityLi(this)}).on("touchstart.live",".list .delete",function(){var t,e=$(this).prev()[0],i=u(e.value),r=e.getAttribute("data-provider"),s="facebook"===r;s&&(i+="@facebook"),t=l(i),$(this).parent().remove(),t&&t.provider&&n.removeIdentity(t),s&&n.emit("show-add-facebook")}).on("touchstart.live",".btn-start",function(){var t=$(".list .input-item");t.each(function(){n.updateIdentityLi(this)});var e=document.getElementById("card-name");e.blur();var i=u(e.value);i?n.liveCard.card.name=i:n.setCardName(e),setTimeout(function(){n.inspectFields()&&(n.emit("post-card"),n.emit("live-gather"))},23)}).on("hold:live",".live-gather .card .avatar",function(){var t=this,e=t.parentNode,n=$(e).data("card"),i=e.style.transform||e.style.webkitTransform,r=i.match(/([\-\d\.]+)/g).slice(1),s=document.getElementById("card-tip"),o="";if(n&&n.identities){for(var a=0,c=n.identities.length;c>a;++a){var u=n.identities[a],l=u.provider,h=u.external_username,d="";"email"!==l&&"phone"!==l&&(l=l.substr(0,1).toUpperCase()+l.substr(1),d='<span class="provider">'+l+"</span>"),o+='<li><span class="external-username'+(d?"":" normal")+'">'+h+"</span>"+d+"</li>"}s.querySelector("ul").innerHTML=o;var p=s.clientHeight,f=~~r[12]-68,m=~~r[13]-(6+p),v=93;0>f?f=10:f+200>=320&&(f=110),(10===f||110===f)&&(v=~~r[12]+32-7-f),r[12]=f,r[13]=m-5,r[14]=7,y(s,r),s.querySelector(".ang").style.left=v+"px",s.querySelector(".bio").innerText=n.bio,s.className="card-tip"}}).on("touchstart.live",".live-gather .card .avatar",function(n){var i=$(this),r=250,s=n.touches.length;e=f(),t&&(clearTimeout(t),t=void 0),1===s&&s>=1&&(t=setTimeout(function(){i.trigger("hold:live")},r))}).on("touchend.live",".live-gather .card .avatar",function(){if(t&&(clearTimeout(t),t=void 0),250>f()-e){var n=$(this).parent();n.hasClass("card-me")||n.toggleClass("selected")}document.getElementById("card-tip").className="card-tip hidden"}).on("touchstart.live",".back",function(){n.$(".live-gather").addClass("hide"),App.response.redirect("/")}).on("touchstart.live",".live-gather",function(t){var e=t.target,n=$(".live-title h2"),i=n[0],r=n.hasClass("clicked");r&&($(".wave").css("opacity",1),n.data("clicked",e===i||$.contains(i,e)).removeClass("clicked"),$(".live-tip").addClass("live-tip-close"))}).on("touchstart.live",".live-title h2",function(){var t=$(this),e=t.hasClass("clicked"),n=t.data("clicked");e||n||($(this).addClass("clicked"),$(".wave").css("opacity",0),$(".live-tip").removeClass("live-tip-close")),t.data("clicked",!1)}).on("touchstart.live",".btn-confirm",function(){n.postContacts()}),this.on("show-add-email",function(){this.$("#add-identity").removeClass("hide")}),this.on("show-add-facebook",function(){this.$('.list input[data-provider="facebook"]').length||this.$("#add-identity-facebook").removeClass("hide")}),this.on("show",function(t){d.startGeo(),this.screen=t,$("#app-footer").addClass("hide"),this.element.removeClass("hide");var e=t.height;x[13]=(e-64)/2,y(this.$("#icard")[0],x),this.$(".live-form, .live-gahter").css("min-height",e),this.$(".live-form").removeClass("hide"),this.$("#live-discover").css("opacity",0),this.$("#card-form").css({opacity:0,"min-height":100*((e-100)/e)+"%"}),this.measurePositions(t.width,t.height-10,32,32),this.MAPS=this._MAPS.slice(0),this.$(".identities .list").empty(),this.liveCard=b(),this.updateMyCardForm(),this.startAnimate()}),this.on("post-card",function(){this.postMyCard()}),this.on("disabled-live-btn",function(t){this.$(".btn-start").toggleClass("disabled",t)}),this.on("live-gather",function(){this.$(".live-form").addClass("hide"),this.$(".live-gather").removeClass("hide"),this.$(".wave").addClass("start"),this.$(".live-gather").find(".card").remove();var t=this.liveCard.card,e=this.genCard(t,this.coords[0][0],0,0,!0,this.screen.ios).appendTo(this.$(".live-gather"));this.updateCard(e[0],t),this._others&&this.updateOthers()})},updateIdentityLi:function(t){var e,n=t.getAttribute("data-external-username"),i=t.getAttribute("data-provider"),r=t.getAttribute("data-name"),s="",o=u(t.value),a=!1,c=!1,h=!1;if(o)if("facebook"===i&&(o+="@facebook"),e=l(o),e&&e.provider){var d=this.findIdentity(e),p=e.provider===i&&e.external_username===n;d&&!p&&(t.value=s),d||p||(h=!0,a=!0)}else c=!0,a=!0;else c=!0,a=!0;c&&(t.setAttribute("data-name",s),t.setAttribute("data-external-username",s),t.setAttribute("data-provider",s),setTimeout(function(){alert("Invalid contact.")},14)),h&&(t.setAttribute("data-name",e.name),t.setAttribute("data-external-username",e.external_username),t.setAttribute("data-provider",e.provider),t.value=e.external_username,$(t).prev().text(this.aliasProvider(e.provider)),this.updateLiveCard(e,"+")),a&&this.updateLiveCard({name:r,external_username:n,provider:i},"-",!0),(a||h)&&this.emit("post-card")},postContacts:function(){},inspectFields:function(){var t=this.liveCard.card;return t.name&&t.identities.length},updateCardName:function(t){t.name&&(this.liveCard.card.name=document.getElementById("card-name").value=t.name,r.set("livecard",this.liveCard))},updateMe:function(t){var e,n=document.getElementById("icard"),i=n.getAttribute("data-url");i!==t.avatar&&(e=t.avatar,e||(e=t.name?o+"/avatar/default?name="+t.name:"/static/img/portrait_default.png"),i!==e&&(n.querySelector(".avatar").style.backgroundImage="url("+e+")",n.setAttribute("data-url",e)));var r=document.getElementById("card-bio");t.bio&&(r.innerText=t.bio),r.className=t.bio?"":"hide"},postMyCard:function(){r.set("livecard",this.liveCard);var t=this.liveCard.card;t.name&&t.identities.length&&d.init(t,$.proxy(this.liveCallback,this))},state:1,liveCallback:function(t){var e=this.liveCard,n=t.me;1===this.state&&n&&n.name&&n.identities.length&&(f()-n.timestamp>6e4&&this.updateCardName(n),this.updateMe(e.card=n),r.set("livecard",e)),this._others=t.others,this.updateOthers()},updateMyCardForm:function(){var t,e=this.liveCard,n=e.card,i=n.identities;if(i&&(t=i.length)){this.updateCardName(n),this.updateMe(n),this.postMyCard(),i=i.slice(0);for(var r,s;r=i.shift();)s=r.provider,("email"===s||"phone"===s||"facebook"===s)&&this.addIdentity(r,!0);this.emit("show-add-email"),this.emit("show-add-facebook")}else this.emit("disabled-live-btn",!0)},resetLiveCard:function(){this.emit("disabled-live-btn",!0),r.clear("livecard"),this.liveCard=b()},findIdentity:function(t){var e=this.liveCard.card,n=e.identities,i=n.length;if(i)for(var r=0;i>r;++r){var s=n[r];if(s.provider===t.provider&&s.external_username===t.external_username)return!0}return!1},updateLiveCard:function(t,e,n){var i=this.liveCard.card,s=i.identities;if("+"===e)s.push(t);else{for(var o=0,a=s.length;a>o;++o){var c=s[o];if(c.provider===t.provider&&c.external_username===t.external_username){s.splice(o,1);break}}n||0!==s.length||this.resetLiveCard()}r.set("livecard",this.liveCard)},setCardName:function(t){var e=this.packedIdentities();if(e.length){var n=e[0],i="",r=n.external_username,s=n.provider;i="phone"===s?"Anonym_"+r.slice(r.length-4):r.split("@")[0],this.liveCard.card.name=t.value=i,t.setAttribute("placeholder","Name"),$(t).addClass("normal")}},addFacebook:function(t,e){var n=l(e),i=n.provider;return i&&"facebook"===i&&!this.existsByIdentity(n)?(this.addIdentity(n),!0):!1},addEmailOrPhone:function(t,e,n){n=!n;var i=l(e),r=i.provider;!r||"email"!==r&&"phone"!==r||this.existsByIdentity(i)||(this.addIdentity(i),n&&this.setCardName(t)),n&&(this.emit("show-add-email"),this.emit("show-add-facebook")),this.emit("post-card")},aliasProvider:function(t){return"email"===t?t="Email":"phone"===t?t="Mobile":"facebook"===t&&(t="Facebook"),t},genIdentity:function(t){var e=a.compile($("#live-li-identity-tmpl").html()),n=t.provider;n=this.aliasProvider(n);var i=$(e({provider_alias:n,identity:t}));return i},resetCard:function(){this.state=0,this.$("#icard").removeAttr("data-url").find(".avatar").css("background",""),this.$("#card-name").attr("placeholder","Your email or mobile no.").removeClass("normal").val(""),this.$("#add-identity").addClass("hide"),this.$("#add-identity-facebook").addClass("hide")},removeIdentity:function(t){var e=this.$(".identities .list li");0===e.length?(this.resetCard(),this.emit("disabled-live-btn",!0)):"facebook"===t.provider&&this.emit("show-add-facebook"),this.updateLiveCard(t,"-"),this.emit("post-card")},addIdentity:function(t,e){e=!e,this.state=1;var n=this.$(".identities .list"),i=this.genIdentity(t);n.append(i),this.emit("disabled-live-btn",!1),e&&(this.updateLiveCard(t,"+"),this.emit("post-card"))},packedIdentities:function(){for(var t,e,n,i,r,s=this.$(".identities .list").find("input"),o=0,a=s.length,c=[];a>o;++o)t=s.eq(o),e=t.attr("data-provider"),n=u(s.eq(o).val()),n&&("facebook"===e&&(n+="@facebook"),i=l(n),r=i.provider,!r||"email"!==r&&"phone"!==r&&"facebook"!==r||c.push(i));return c},existsByIdentity:function(t){var e,n=this.packedIdentities(),i=t.external_username,r=t.provider;if(0===n.length)return!1;for(;e=n.shift();)if(e.external_username===i&&e.provider===r)return!0;return!1},coords:"".split(),_MAPS:[[1,0],[1,1],[1,2],[2,0],[2,1],[2,2],[2,3],[3,0],[3,1],[3,2],[3,3]],MAPS:"".split(),measurePositions:function(t,e,n,i){var r=this.coords;r[0]=[[.5*t-n,.88*e-i]],r[1]=Array(3),r[1][0]=[.25*t-5-n,.66*e+30-i],r[1][1]=[.5*t-n,.66*e-i],r[1][2]=[.75*t+5-n,.66*e+30-i],r[2]=Array(4),r[2][0]=[.125*t+5-n,.44*e+40-i],r[2][1]=[.375*t-n,.44*e-i],r[2][2]=[.625*t-n,.44*e-i],r[2][3]=[.875*t-5-n,.44*e+40-i],r[3]=Array(4),r[3][0]=[.125*t-n,.22*e+40-i],r[3][1]=[.375*t-n,.22*e-i],r[3][2]=[.625*t-n,.22*e-i],r[3][3]=[.875*t-n,.22*e+40-i]},genCard:function(t,e,n,i,r,s){var o=a.compile($("#live-card-tmpl").html()),c=w.slice(0);c[12]=e[0],c[13]=e[1];var u=$(o({g:n,i:i,matrix:c.join(","),"class":(r?"card-me":"card-other hide")+("iphone4"===s?" card-iphone4":""),card:t}));return u.data("card",t),u},addCard:function(t){var e=this.MAPS;if(!e||0===e.length)return!1;var n=e.shift(),i=n[0],r=n[1],o=this.coords[i][r],a=this.genCard(t,o,i,r,!1,this.screen.ios),c=a[0],u=c.style,l=w.slice(0);l[0]=l[5]=0,l[12]=o[0],l[13]=o[1],a.data("card",t),this.$(".live-gather").append(a),new s.Tween({o:0}).to({o:1},250).easing(s.Easing.Bounce.In).onStart(function(){y(c,l),a.removeClass("hide")}).onUpdate(function(){u.opacity=this.o,l[0]=l[5]=this.o,y(c,l)}).onComplete(function(){s.remove(this)}).start()},delCard:function(t){var e=this.MAPS,n=t.getAttribute("data-g"),i=t.getAttribute("data-i"),r=w.slice(0),o=this.coords[n][i],a=t.style;r[12]=o[0],r[13]=o[1],new s.Tween({o:1}).to({o:0},250).easing(s.Easing.Bounce.Out).onUpdate(function(){a.opacity=this.o,y(t,r)}).onComplete(function(){e.unshift([n,i]),t.parentNode.removeChild(t),s.remove(this)}).start()},updateCard:function(t,e){var n=t.getAttribute("data-url"),i="";n&&n===e.avatar||(i=e.avatar,i||(i=e.name?o+"/avatar/default?name="+e.name:"/static/img/portrait_default.png"),n!==i&&(t.querySelector(".avatar").style.backgroundImage="url("+i+")",t.setAttribute("data-url",i))),t.querySelector(".name").innerText=e.name,$(t).data("card",e)},updateOthers:function(){for(var t,e,n,i,r=this._others,s=document.querySelectorAll(".card-other"),o=s.length,a=0;o>a;++a)t=s[a],e=t.getAttribute("id"),e in r||this.delCard(t);for(n in r)i=r[n],t=document.getElementById(i.id),t?this.updateCard(t,i):this.addCard(i)},createAnimate:function(){var t=this.$("#icard")[0],e=this.$("#card-form")[0],n=this.$("#live-discover")[0],i=x[13],r=k[13],o=x.slice(0);this.a=new s.Tween({o:0}).to({o:1},500).easing(s.Easing.Cubic.In).onUpdate(function(){n.style.opacity=this.o,o[13]=(i-r)*(1-this.o)+r,y(t,o)}),this.b=new s.Tween({o:0}).delay(250).to({o:1},500).onUpdate(function(){e.style.opacity=this.o})},startAnimate:function(){this.a||this.b||this.createAnimate(),this.a.start(),this.b.start()},stopAnimate:function(){this.a.stop(),this.b.stop()}})}),define("mobileroutes",function(t,e,n){"use strict";var i=t("store"),r=t("handlebars"),s=t("humantime"),o=window._ENV_,a=function(t){var e=s.printEFTime(t,"X");return e},c=t("mobilecontroller"),u=c.HomeController,l=c.SetPasswordController,h=c.VerifyController,d=c.CrossController,p=c.LiveController,f=function(t,e,n,s,c,u){s||(s={}),$.ajax({type:"POST",url:o.api_url+"/Crosses/GetCrossByInvitationToken",data:n,success:function(n){var o=n.meta,l=o&&o.code;if(l&&200===l){var h=n.response,p=h.cross,f={id:p.id,title:p.title,description:p.description.replace(/\r\n|\r|\n/g,"<br />"),time:{title:"Sometime",content:"To be decided"},place:{title:"Somewhere",description:"To be decided"},background:"default.jpg",read_only:!!h.read_only},m=p.time;m&&m.begin_at&&m.begin_at.timezone?f.time=a(m):f.time.tobe="tobe";var v=p.place;v&&v.title&&(f.place={title:v.title,description:v.description.replace(/\r\n|\r|\n/g,"<br />")});var g=v.lat,y=v.lng;if(g&&y){var b=window.devicePixelRatio>=2?2:1;f.place.map="https://maps.googleapis.com/maps/api/staticmap?center="+g+","+y+"&markers=icon%3a"+encodeURIComponent("http://img.exfe.com/web/map_pin_blue.png")+"%7C"+g+","+y+"&zoom=13&size=290x100&maptype=road&sensor=false&scale="+b,f.place.href="http://maps.google.com/maps?daddr="+encodeURIComponent(f.place.title)+"@"+g+","+y}else f.place.tobe="tobe";var w,k=p.widget;if(k&&(w=k.length))for(var x=0;w>x;++x)if("Background"===k[x].type){f.background=k[x].image;break}var _=0,E=0,C=h.authorization;C?(_=C.user_id,h.browsing_identity&&(E=h.browsing_identity.id)):h.browsing_identity&&h.browsing_identity.connected_user_id&&(_=h.browsing_identity.connected_user_id,E=h.browsing_identity.id),h.cross_access_token&&(u=s[c]=h.cross_access_token,i.set("cats",s));for(var S=p.exfee.invitations,T=[],N={ACCEPTED:[],INTERESTED:[],NORESPONSE:[],IGNORED:[],DECLINED:[]},A=0,P=S.length;P>A;++A){var I=S[A],O="pending",M=I.rsvp_status;"ACCEPTED"===M?O="accepted":"DECLINED"===M&&(O="declined"),I.rsvp_style=O,_&&_===I.identity.connected_user_id||E===I.identity.id?(I.is_me=!0,E=I.identity.id,E!==I.invited_by.id&&(f.inviter=I.invited_by),I.identity.isphone="phone"===I.identity.provider,f.identity=I.identity,N.ACCEPTED.unshift(I)):I.rsvp_status in N&&N[I.rsvp_status].push(I)}T=[].concat(N.ACCEPTED,N.INTERESTED,N.NORESPONSE,N.IGNORED,N.DECLINED),f.invitations=[],P=T.length;for(var H=0;P>H;)f.invitations.push(T.splice(0,5)),H+=5;P=f.invitations.length;var D=f.invitations[P-1],j=D.length;if(j&&5>j)for(;5-j++;)D.push(void 0);var R="";_&&(C?(R=f.id+"?user_id="+_+"&token="+C.token+"&identity_id="+E,u=C.token,i.set("authorization",C)):(C=i.get("authorization"),C&&C.user_id===_&&(R=f.id+"?user_id="+_+"&token="+C.token+"&identity_id="+E,u=C.token)));var L=t.app,F=L.controllers,z=F.cross;z&&z.destory();var B=r.compile($("#cross-tmpl").html());z=L.controllers.cross=new d({options:{template:B(f)},cross:f,exfee_id:p.exfee.id,token:u}),z.emit("show"),L.controllers.footer.emit("show-from-cross",p.exfee.id,u,f.identity.isphone,R)}else t.error={code:404},e.redirect("/")},error:function(){t.error={code:404},e.redirect("/")}})};n.exports={index:function(t){var e=t.error,n=t.app,i=n.controllers,r=i.home,s=i.footer,o=n.screen;r||(r=n.controllers.home=new u({options:{template:$("#home-tmpl").html()}})),document.title="EXFE - The group utility for gathering.",r.emit("show",o,e),s.emit("show",o,!1,!1,e===!0),delete t.error,n.currPageName="HOME"},verify:function(t,e){var n=t.session,i=n.resolveToken,r=t.app;if(i){$("#app-header").removeClass("hide");var s=new h({options:{template:$("#verify-tmpl").html()},resolveToken:i});s.emit("show",t,e)}else t.error=!0,e.redirect("/");r.currPageName="VERIFY"},setPassword:function(t,e){var n=t.session,i=n.resolveToken,r=t.app;if(i){$("#app-header").removeClass("hide");var s=new l({options:{template:$("#setpassword-tmpl").html()},resolveToken:i,token:i.origin_token});s.emit("show",t,e)}else t.error=!0,e.redirect("/");r.currPageName="SET_PASSWORD"},resolveToken:function(t,e){var n=t.app,i=t.params[0],r=function(t,e){t.error={code:404},e.redirect("/")};i?$.ajax({type:"POST",url:o.api_url+"/Users/ResolveToken",data:{token:i},success:function(n){if(n&&n.meta&&200===n.meta.code){var s=t.session;s.resolveToken=n.response;var o=s.resolveToken.action;"VERIFIED"===o?e.redirect("/#verify"):"INPUT_NEW_PASSWORD"===o&&(s.resolveToken.origin_token=i,e.redirect("/#set_password"))}else r(t,e)},error:function(){r(t,e)}}):r(t,e),n.currPageName="RESOLVE_TOKEN"},crossPhoneToken:function(t,e){var n,r,s=t.app,o=t.params,a=o[0],c=o[1],u=i.get("cats");n={invitation_token:c,cross_id:a},u&&(r=u[c])&&(n.cross_access_token=r),f(t,e,n,u,c,r),s.currPageName="CROSS"},crossToken:function(t,e){var n,r=t.app,s=t.params[0],o=i.get("cats"),a={invitation_token:s};o&&(n=o[s])&&(a.cross_access_token=n),f(t,e,a,o,s,n),r.currPageName="CROSS"},live:function(t){var e=t.app,n=e.controllers,i=n.live;i&&i.destory(),i=e.controllers.live=new p({options:{template:$("#live-tmpl").html()}}),i.emit("show",e.screen,e.ios),e.currPageName="LIVE"}}}),define(function(t){"use strict";var e=t("zepto"),n=t("tween"),i=t("af"),r=i.request,s=t("mobilemiddleware"),o=t("mobilecontroller").FooterController,a=t("mobileroutes"),c=Date.now||function(){return(new Date).getTime()},u=c(),l=function(t){App.set("tryRedirectAt",c()),window.location="exfe://crosses/"+(t||"")},h=t("lightsaber"),d=window.App=h();d.use(s.setHtmlHeight),d.use(s.cleanup),d.initRouter(),d.use(s.errorHandler),d.controllers={},d.controllers.footer=new o({App:d}),d.get(/^\/+(?:\?)?#{0,}$/,a.index),d.get(/^\/+(?:\?)?#live\/?$/,a.live),d.get(/^\/+\?t=([a-zA-Z0-9]{3,})$/,function(t,e){var n=function(){var t,e=document.getElementsByTagName("head")[0],n=document.getElementsByName("sms-token")[0];return n&&(t=JSON.parse(n.content),e.removeChild(n)),t},i=n();if(i){var r=i.action;t.session.resolveToken=i,"VERIFIED"===r?e.redirect("/#verify"):"INPUT_NEW_PASSWORD"===r&&e.redirect("/#set_password")}else t.error={code:404},t.redirect("/")}),d.get(/^\/+(?:\?)?#verify\/?$/,a.verify),d.get(/^\/+(?:\?)?#set_password\/?$/,a.setPassword),d.get(/^\/+(?:\?)?#token=([a-zA-Z0-9]{64})\/?$/,a.resolveToken),d.get(/^\/+(?:\?)?#!([1-9][0-9]*)\/([a-zA-Z0-9]{4})\/?$/,a.crossPhoneToken),d.get(/^\/+(?:\?)?#!token=([a-zA-Z0-9]{32})\/?$/,a.crossToken),d.set("tryRedirectAt",0),d.on("launched",function(){function t(){r(t),n.update()}var i=this,s=setInterval(function(){var t=c(),n=i.set("tryRedirectAt");n&&(t-u>1500&&1500>Math.abs(n-u)?(clearInterval(s),e(".get-button button").html('Open <span class="exfe">EXFE</span> app').removeClass("hide"),e("#app-footer").off("click.footer",".get-button button").on("click.footer",".get-button button",function(){l()})):2e3>t-n&&(e(".get-button").removeClass("hide"),e(".redirecting").addClass("hide"))),u=t},500);d.set("tryTimer",s),t()}),d.run()});
=======
/*! mobile@2a.3 2013-05-26 10:05:29 */
(function(e){"use strict";function t(e,t,n){var s=arguments.length;1===s?(n=e,e=void 0):2===s&&(n=t,t=void 0);var o=new r(e,t,n);e?a[e]=o:n.call(o,i,o.exports,o)}function i(e){var t=a[e];return t?(t.exports||n(t),t.exports):null}function n(e){var t,n=e.factory;delete e.factory,t=n(i,e.exports={},e),t&&(e.exports=t)}function r(e,t,i){this.id=e,this.uri=void 0,this.deps=t,"string"==typeof i&&(i=Function("require","exports","module",i)),this.factory=i,this.exports=void 0,this.filename=null,this.parent=void 0,this.loaded=!1}t.amd={jQuery:!0},e.define=t,r.prototype.constructor=r;var a=r.__cache={}})(this),define("class",function(){"use strict";function e(i){return this instanceof e||!s(i)?void 0:t(i)}function t(t){return t.extend=e.extend,t.implement=r,t}function i(i,n,r,s,l){function c(){i.apply(this,arguments),this.constructor===c&&this.initialize&&(this.initialize.apply(this,arguments),this.initialized=!0)}return s=i.prototype,i!==e&&a(c,i),c.Extends=i,l=o(s),n&&a(l,n),c.prototype=l,r&&a(c,r),c.superclass=s,c.prototype.constructor=c,t(c)}function n(){}function r(e){var t,i=this.prototype;for(t in e)i[t]=e[t]}function a(e,t){var i;for(i in t)e[i]=t[i]}function s(e){return"[object Function]"===l.call(e)}e.create=function(t,n){return s(t)||(n=t,t=null),n||(n={}),t||(t=n.Extends||e),i(t,n)},e.extend=function(e,t){return i(this,e,t)};var o=Object.__proto__?function(e){return{__proto__:e}}:function(e){return n.prototype=e,new n},l=Object.prototype.toString;return e}),define("emitter",function(){"use strict";function e(){}var t=/\s+/,i=Object.keys;return i||(i=function(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&(i[i.length]=t);return i}),e.prototype.on=function(e,i,n){var r,a,s;if(!i)return this;for(e=e.split(t),r=this.__callbacks||(this.__callbacks={});a=e.shift();)s=r[a]||(r[a]=[]),i.__context=n,s[s.length]=i;return this},e.prototype.once=function(e,i,n){var r,a,s;if(!i)return this;for(e=e.split(t),r=this.__callbacks||(this.__callbacks={});a=e.shift();)s=r[a]||(r[a]=[]),i.__once=!0,i.__context=n,s[s.length]=i;return this},e.prototype.off=function(e,n,r){var a,s,o,l,c;if(!(a=this.__callbacks))return this;if(!(e||n||r))return delete this.__callbacks,this;for(e=e.split(t)||i(a);s=e.shift();)if(o=a[s])if(n||r)for(l=o.length-1;l;--l)c=o[l],n&&c!==n||r&&c.__context!==r||o.splice(l,1);else delete a[s];return this},e.prototype.emit=function(e){var i,n,r,a,s,o,l,c,u=[];if(!(i=this.__callbacks))return this;for(e=e.split(t),s=arguments.length-1;s;--s)u[s-1]=arguments[s];for((r=i.call)&&(l=[0].concat(u));n=e.shift();){if(a=i[n])for(s=0,o=a.length;o>s;++s)c=a[s],c.apply(c.__context||this,u),c.__once&&(a.splice(s--,1),o--);if(a&&r)for(l[0]=n,s=0,o=r.length;o>s;++s)c=r[s],c.apply(c.__context||this,l)}return this},e}),define("base",function(e){"use strict";function t(e){return"[object Function]"===o.call(e)}function i(e){return e&&"[object Object]"===o.call(e)&&"isPrototypeOf"in e}function n(e,t){var r,a;for(r in t)a=t[r],l(a)?a=a.slice():i(a)&&(a=n(e[r]||{},a)),e[r]=a;return e}function r(e){return e[2].toLowerCase()+e.substring(3)}var a=/^on[A-Z]/,s=Object.__proto__,o=Object.prototype.toString,l=Array.isArray;l||(l=function(e){return"[object Array]"===o.call(e)});var c=e("class"),u=e("emitter");return c.create(u,{setOptions:function(e){var i,s,o;if(this.hasOwnProperty("options")||(this.options={}),o=this.options,this.constructor.superclass.options&&n(o,this.constructor.superclass.options),this.constructor.prototype.options&&n(o,this.constructor.prototype.options),e&&e.options&&n(o,e.options),this.on)for(i in o)s=o[i],t(s)&&a.test(i)&&(this.on(r(i),s),delete o[i])},destory:function(){var e;for(e in this)this.hasOwnProperty(e)&&delete this[e];s&&(this.__proto__=s)}})});var Zepto=function(){function e(e){return null==e?e+"":Y[G.call(e)]||"object"}function t(t){return"function"==e(t)}function i(e){return null!=e&&e==e.window}function n(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function r(t){return"object"==e(t)}function a(e){return r(e)&&!i(e)&&e.__proto__==Object.prototype}function s(e){return e instanceof Array}function o(e){return"number"==typeof e.length}function l(e){return I.call(e,function(e){return null!=e})}function c(e){return e.length>0?C.fn.concat.apply([],e):e}function u(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function d(e){return e in P?P[e]:P[e]=RegExp("(^|\\s)"+e+"(\\s|$)")}function h(e,t){return"number"!=typeof t||O[u(e)]?t:t+"px"}function p(e){var t,i;return A[e]||(t=N.createElement(e),N.body.appendChild(t),i=D(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==i&&(i="block"),A[e]=i),A[e]}function f(e){return"children"in e?M.call(e.children):C.map(e.childNodes,function(e){return 1==e.nodeType?e:x})}function m(e,t,i){for(k in t)i&&(a(t[k])||s(t[k]))?(a(t[k])&&!a(e[k])&&(e[k]={}),s(t[k])&&!s(e[k])&&(e[k]=[]),m(e[k],t[k],i)):t[k]!==x&&(e[k]=t[k])}function g(e,t){return t===x?C(e):C(e).filter(t)}function v(e,i,n,r){return t(i)?i.call(e,n,r):i}function y(e,t,i){null==i?e.removeAttribute(t):e.setAttribute(t,i)}function _(e,t){var i=e.className,n=i&&i.baseVal!==x;return t===x?n?i.baseVal:i:(n?i.baseVal=t:e.className=t,x)}function b(e){var t;try{return e?"true"==e||("false"==e?!1:"null"==e?null:isNaN(t=Number(e))?/^[\[\{]/.test(e)?C.parseJSON(e):e:t):e}catch(i){return e}}function w(e,t){t(e);for(var i in e.childNodes)w(e.childNodes[i],t)}var x,k,C,E,T,$,S=[],M=S.slice,I=S.filter,N=window.document,A={},P={},D=N.defaultView.getComputedStyle,O={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},H=/^\s*<(\w+|!)[^>]*>/,L=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,z=/^(?:body|html)$/i,R=["val","css","html","text","data","width","height","offset"],j=["after","prepend","before","append"],F=N.createElement("table"),q=N.createElement("tr"),B={tr:N.createElement("tbody"),tbody:F,thead:F,tfoot:F,td:q,th:q,"*":N.createElement("div")},U=/complete|loaded|interactive/,W=/^\.([\w-]+)$/,V=/^#([\w-]*)$/,X=/^[\w-]+$/,Y={},G=Y.toString,Z={},J=N.createElement("div");return Z.matches=function(e,t){if(!e||1!==e.nodeType)return!1;var i=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(i)return i.call(e,t);var n,r=e.parentNode,a=!r;return a&&(r=J).appendChild(e),n=~Z.qsa(r,t).indexOf(e),a&&J.removeChild(e),n},T=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},$=function(e){return I.call(e,function(t,i){return e.indexOf(t)==i})},Z.fragment=function(e,t,i){e.replace&&(e=e.replace(L,"<$1></$2>")),t===x&&(t=H.test(e)&&RegExp.$1),t in B||(t="*");var n,r,s=B[t];return s.innerHTML=""+e,r=C.each(M.call(s.childNodes),function(){s.removeChild(this)}),a(i)&&(n=C(r),C.each(i,function(e,t){R.indexOf(e)>-1?n[e](t):n.attr(e,t)})),r},Z.Z=function(e,t){return e=e||[],e.__proto__=C.fn,e.selector=t||"",e},Z.isZ=function(e){return e instanceof Z.Z},Z.init=function(e,i){if(e){if(t(e))return C(N).ready(e);if(Z.isZ(e))return e;var n;if(s(e))n=l(e);else if(r(e))n=[a(e)?C.extend({},e):e],e=null;else if(H.test(e))n=Z.fragment(e.trim(),RegExp.$1,i),e=null;else{if(i!==x)return C(i).find(e);n=Z.qsa(N,e)}return Z.Z(n,e)}return Z.Z()},C=function(e,t){return Z.init(e,t)},C.extend=function(e){var t,i=M.call(arguments,1);return"boolean"==typeof e&&(t=e,e=i.shift()),i.forEach(function(i){m(e,i,t)}),e},Z.qsa=function(e,t){var i;return n(e)&&V.test(t)?(i=e.getElementById(RegExp.$1))?[i]:[]:1!==e.nodeType&&9!==e.nodeType?[]:M.call(W.test(t)?e.getElementsByClassName(RegExp.$1):X.test(t)?e.getElementsByTagName(t):e.querySelectorAll(t))},C.contains=function(e,t){return e!==t&&e.contains(t)},C.type=e,C.isFunction=t,C.isWindow=i,C.isArray=s,C.isPlainObject=a,C.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},C.inArray=function(e,t,i){return S.indexOf.call(t,e,i)},C.camelCase=T,C.trim=function(e){return e.trim()},C.uuid=0,C.support={},C.expr={},C.map=function(e,t){var i,n,r,a=[];if(o(e))for(n=0;e.length>n;n++)i=t(e[n],n),null!=i&&a.push(i);else for(r in e)i=t(e[r],r),null!=i&&a.push(i);return c(a)},C.each=function(e,t){var i,n;if(o(e)){for(i=0;e.length>i;i++)if(t.call(e[i],i,e[i])===!1)return e}else for(n in e)if(t.call(e[n],n,e[n])===!1)return e;return e},C.grep=function(e,t){return I.call(e,t)},window.JSON&&(C.parseJSON=JSON.parse),C.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Y["[object "+t+"]"]=t.toLowerCase()}),C.fn={forEach:S.forEach,reduce:S.reduce,push:S.push,sort:S.sort,indexOf:S.indexOf,concat:S.concat,map:function(e){return C(C.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return C(M.apply(this,arguments))},ready:function(e){return U.test(N.readyState)?e(C):N.addEventListener("DOMContentLoaded",function(){e(C)},!1),this},get:function(e){return e===x?M.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(e){return S.every.call(this,function(t,i){return e.call(t,i,t)!==!1}),this},filter:function(e){return t(e)?this.not(this.not(e)):C(I.call(this,function(t){return Z.matches(t,e)}))},add:function(e,t){return C($(this.concat(C(e,t))))},is:function(e){return this.length>0&&Z.matches(this[0],e)},not:function(e){var i=[];if(t(e)&&e.call!==x)this.each(function(t){e.call(this,t)||i.push(this)});else{var n="string"==typeof e?this.filter(e):o(e)&&t(e.item)?M.call(e):C(e);this.forEach(function(e){0>n.indexOf(e)&&i.push(e)})}return C(i)},has:function(e){return this.filter(function(){return r(e)?C.contains(this,e):C(this).find(e).size()})},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!r(e)?e:C(e)},last:function(){var e=this[this.length-1];return e&&!r(e)?e:C(e)},find:function(e){var t,i=this;return t="object"==typeof e?C(e).filter(function(){var e=this;return S.some.call(i,function(t){return C.contains(t,e)})}):1==this.length?C(Z.qsa(this[0],e)):this.map(function(){return Z.qsa(this,e)})},closest:function(e,t){var i=this[0],r=!1;for("object"==typeof e&&(r=C(e));i&&!(r?r.indexOf(i)>=0:Z.matches(i,e));)i=i!==t&&!n(i)&&i.parentNode;return C(i)},parents:function(e){for(var t=[],i=this;i.length>0;)i=C.map(i,function(e){return(e=e.parentNode)&&!n(e)&&0>t.indexOf(e)?(t.push(e),e):x});return g(t,e)},parent:function(e){return g($(this.pluck("parentNode")),e)},children:function(e){return g(this.map(function(){return f(this)}),e)},contents:function(){return this.map(function(){return M.call(this.childNodes)})},siblings:function(e){return g(this.map(function(e,t){return I.call(f(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return C.map(this,function(t){return t[e]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=null),"none"==D(this,"").getPropertyValue("display")&&(this.style.display=p(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var i=t(e);if(this[0]&&!i)var n=C(e).get(0),r=n.parentNode||this.length>1;return this.each(function(t){C(this).wrapAll(i?e.call(this,t):r?n.cloneNode(!0):n)})},wrapAll:function(e){if(this[0]){C(this[0]).before(e=C(e));for(var t;(t=e.children()).length;)e=t.first();C(e).append(this)}return this},wrapInner:function(e){var i=t(e);return this.each(function(t){var n=C(this),r=n.contents(),a=i?e.call(this,t):e;r.length?r.wrapAll(a):n.append(a)})},unwrap:function(){return this.parent().each(function(){C(this).replaceWith(C(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var t=C(this);(e===x?"none"==t.css("display"):e)?t.show():t.hide()})},prev:function(e){return C(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return C(this.pluck("nextElementSibling")).filter(e||"*")},html:function(e){return e===x?this.length>0?this[0].innerHTML:null:this.each(function(t){var i=this.innerHTML;C(this).empty().append(v(this,e,t,i))})},text:function(e){return e===x?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=e})},attr:function(e,t){var i;return"string"==typeof e&&t===x?0==this.length||1!==this[0].nodeType?x:"value"==e&&"INPUT"==this[0].nodeName?this.val():!(i=this[0].getAttribute(e))&&e in this[0]?this[0][e]:i:this.each(function(i){if(1===this.nodeType)if(r(e))for(k in e)y(this,k,e[k]);else y(this,e,v(this,t,i,this.getAttribute(e)))})},removeAttr:function(e){return this.each(function(){1===this.nodeType&&y(this,e)})},prop:function(e,t){return t===x?this[0]&&this[0][e]:this.each(function(i){this[e]=v(this,t,i,this[e])})},data:function(e,t){var i=this.attr("data-"+u(e),t);return null!==i?b(i):x},val:function(e){return e===x?this[0]&&(this[0].multiple?C(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(t){this.value=v(this,e,t,this.value)})},offset:function(e){if(e)return this.each(function(t){var i=C(this),n=v(this,e,t,i.offset()),r=i.offsetParent().offset(),a={top:n.top-r.top,left:n.left-r.left};"static"==i.css("position")&&(a.position="relative"),i.css(a)});if(0==this.length)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(t,i){if(2>arguments.length&&"string"==typeof t)return this[0]&&(this[0].style[T(t)]||D(this[0],"").getPropertyValue(t));var n="";if("string"==e(t))i||0===i?n=u(t)+":"+h(t,i):this.each(function(){this.style.removeProperty(u(t))});else for(k in t)t[k]||0===t[k]?n+=u(k)+":"+h(k,t[k])+";":this.each(function(){this.style.removeProperty(u(k))});return this.each(function(){this.style.cssText+=";"+n})},index:function(e){return e?this.indexOf(C(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return S.some.call(this,function(e){return this.test(_(e))},d(e))},addClass:function(e){return this.each(function(t){E=[];var i=_(this),n=v(this,e,t,i);n.split(/\s+/g).forEach(function(e){C(this).hasClass(e)||E.push(e)},this),E.length&&_(this,i+(i?" ":"")+E.join(" "))})},removeClass:function(e){return this.each(function(t){return e===x?_(this,""):(E=_(this),v(this,e,t,E).split(/\s+/g).forEach(function(e){E=E.replace(d(e)," ")}),_(this,E.trim()),x)})},toggleClass:function(e,t){return this.each(function(i){var n=C(this),r=v(this,e,i,_(this));r.split(/\s+/g).forEach(function(e){(t===x?!n.hasClass(e):t)?n.addClass(e):n.removeClass(e)})})},scrollTop:function(){return this.length?"scrollTop"in this[0]?this[0].scrollTop:this[0].scrollY:x},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),i=this.offset(),n=z.test(t[0].nodeName)?{top:0,left:0}:t.offset();return i.top-=parseFloat(C(e).css("margin-top"))||0,i.left-=parseFloat(C(e).css("margin-left"))||0,n.top+=parseFloat(C(t[0]).css("border-top-width"))||0,n.left+=parseFloat(C(t[0]).css("border-left-width"))||0,{top:i.top-n.top,left:i.left-n.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||N.body;e&&!z.test(e.nodeName)&&"static"==C(e).css("position");)e=e.offsetParent;return e})}},C.fn.detach=C.fn.remove,["width","height"].forEach(function(e){C.fn[e]=function(t){var r,a=this[0],s=e.replace(/./,function(e){return e[0].toUpperCase()});return t===x?i(a)?a["inner"+s]:n(a)?a.documentElement["offset"+s]:(r=this.offset())&&r[e]:this.each(function(i){a=C(this),a.css(e,v(this,t,i,a[e]()))})}}),j.forEach(function(t,i){var n=i%2;C.fn[t]=function(){var t,r,a=C.map(arguments,function(i){return t=e(i),"object"==t||"array"==t||null==i?i:Z.fragment(i)}),s=this.length>1;return 1>a.length?this:this.each(function(e,t){r=n?t:t.parentNode,t=0==i?t.nextSibling:1==i?t.firstChild:2==i?t:null,a.forEach(function(e){if(s)e=e.cloneNode(!0);else if(!r)return C(e).remove();w(r.insertBefore(e,t),function(e){null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||window.eval.call(window,e.innerHTML)})})})},C.fn[n?t+"To":"insert"+(i?"Before":"After")]=function(e){return C(e)[t](this),this}}),Z.Z.prototype=C.fn,Z.uniq=$,Z.deserializeValue=b,C.zepto=Z,C}();window.Zepto=Zepto,"$"in window||(window.$=Zepto),function(e){String.prototype.trim===e&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.reduce===e&&(Array.prototype.reduce=function(t){if(void 0===this||null===this)throw new TypeError;var i,n=Object(this),r=n.length>>>0,a=0;if("function"!=typeof t)throw new TypeError;if(0==r&&1==arguments.length)throw new TypeError;if(arguments.length>=2)i=arguments[1];else for(;;){if(a in n){i=n[a++];break}if(++a>=r)throw new TypeError}for(;r>a;)a in n&&(i=t.call(e,i,n[a],a,n)),a++;return i})}(),function(e){function t(e){return e._zid||(e._zid=p++)}function i(e,i,a,s){if(i=n(i),i.ns)var o=r(i.ns);return(h[t(e)]||[]).filter(function(e){return!(!e||i.e&&e.e!=i.e||i.ns&&!o.test(e.ns)||a&&t(e.fn)!==t(a)||s&&e.sel!=s)})}function n(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function r(e){return RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function a(t,i,n){"string"!=e.type(t)?e.each(t,n):t.split(/\s/).forEach(function(e){n(e,i)})}function s(e,t){return e.del&&("focus"==e.e||"blur"==e.e)||!!t}function o(e){return m[e]||e}function l(i,r,l,c,u,d){var p=t(i),f=h[p]||(h[p]=[]);a(r,l,function(t,r){var a=n(t);a.fn=r,a.sel=c,a.e in m&&(r=function(t){var i=t.relatedTarget;return!i||i!==this&&!e.contains(this,i)?a.fn.apply(this,arguments):void 0}),a.del=u&&u(r,t);var l=a.del||r;a.proxy=function(e){var t=l.apply(i,[e].concat(e.data));return t===!1&&(e.preventDefault(),e.stopPropagation()),t},a.i=f.length,f.push(a),i.addEventListener(o(a.e),a.proxy,s(a,d))})}function c(e,n,r,l,c){var u=t(e);a(n||"",r,function(t,n){i(e,t,n,l).forEach(function(t){delete h[u][t.i],e.removeEventListener(o(t.e),t.proxy,s(t,c))})})}function u(t){var i,n={originalEvent:t};for(i in t)y.test(i)||void 0===t[i]||(n[i]=t[i]);return e.each(_,function(e,i){n[e]=function(){return this[i]=g,t[e].apply(t,arguments)},n[i]=v}),n}function d(e){if(!("defaultPrevented"in e)){e.defaultPrevented=!1;var t=e.preventDefault;e.preventDefault=function(){this.defaultPrevented=!0,t.call(this)}}}var h=(e.zepto.qsa,{}),p=1,f={},m={mouseenter:"mouseover",mouseleave:"mouseout"};f.click=f.mousedown=f.mouseup=f.mousemove="MouseEvents",e.event={add:l,remove:c},e.proxy=function(i,n){if(e.isFunction(i)){var r=function(){return i.apply(n,arguments)};return r._zid=t(i),r}if("string"==typeof n)return e.proxy(i[n],i);throw new TypeError("expected function")},e.fn.bind=function(e,t){return this.each(function(){l(this,e,t)})},e.fn.unbind=function(e,t){return this.each(function(){c(this,e,t)})},e.fn.one=function(e,t){return this.each(function(i,n){l(this,e,t,null,function(e,t){return function(){var i=e.apply(n,arguments);return c(n,t,e),i}})})};var g=function(){return!0},v=function(){return!1},y=/^([A-Z]|layer[XY]$)/,_={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(t,i,n){return this.each(function(r,a){l(a,i,n,t,function(i){return function(n){var r,s=e(n.target).closest(t,a).get(0);return s?(r=e.extend(u(n),{currentTarget:s,liveFired:a}),i.apply(s,[r].concat([].slice.call(arguments,1)))):void 0}})})},e.fn.undelegate=function(e,t,i){return this.each(function(){c(this,t,i,e)})},e.fn.live=function(t,i){return e(document.body).delegate(this.selector,t,i),this},e.fn.die=function(t,i){return e(document.body).undelegate(this.selector,t,i),this},e.fn.on=function(t,i,n){return!i||e.isFunction(i)?this.bind(t,i||n):this.delegate(i,t,n)},e.fn.off=function(t,i,n){return!i||e.isFunction(i)?this.unbind(t,i||n):this.undelegate(i,t,n)},e.fn.trigger=function(t,i){return("string"==typeof t||e.isPlainObject(t))&&(t=e.Event(t)),d(t),t.data=i,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(t)})},e.fn.triggerHandler=function(t,n){var r,a;return this.each(function(s,o){r=u("string"==typeof t?e.Event(t):t),r.data=n,r.target=o,e.each(i(o,t.type||t),function(e,t){return a=t.proxy(r),r.isImmediatePropagationStopped()?!1:void 0})}),a},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){e.fn[t]=function(e){return e?this.bind(t,e):this.trigger(t)}}),["focus","blur"].forEach(function(t){e.fn[t]=function(e){return e?this.bind(t,e):this.each(function(){try{this[t]()}catch(e){}}),this}}),e.Event=function(e,t){"string"!=typeof e&&(t=e,e=t.type);var i=document.createEvent(f[e]||"Events"),n=!0;if(t)for(var r in t)"bubbles"==r?n=!!t[r]:i[r]=t[r];return i.initEvent(e,n,!0,null,null,null,null,null,null,null,null,null,null,null,null),i.isDefaultPrevented=function(){return this.defaultPrevented},i}}(Zepto),function(e){function t(t,i,n){var r=e.Event(i);return e(t).trigger(r,n),!r.defaultPrevented}function i(e,i,n,r){return e.global?t(i||y,n,r):void 0}function n(t){t.global&&0===e.active++&&i(t,null,"ajaxStart")}function r(t){t.global&&!--e.active&&i(t,null,"ajaxStop")}function a(e,t){var n=t.context;return t.beforeSend.call(n,e,t)===!1||i(t,n,"ajaxBeforeSend",[e,t])===!1?!1:(i(t,n,"ajaxSend",[e,t]),void 0)}function s(e,t,n){var r=n.context,a="success";n.success.call(r,e,a,t),i(n,r,"ajaxSuccess",[t,n,e]),l(a,t,n)}function o(e,t,n,r){var a=r.context;r.error.call(a,n,t,e),i(r,a,"ajaxError",[n,r,e]),l(t,n,r)}function l(e,t,n){var a=n.context;n.complete.call(a,t,e),i(n,a,"ajaxComplete",[t,n]),r(n)}function c(){}function u(e){return e&&(e=e.split(";",2)[0]),e&&(e==k?"html":e==x?"json":b.test(e)?"script":w.test(e)&&"xml")||"text"}function d(e,t){return(e+"&"+t).replace(/[&?]{1,2}/,"?")}function h(t){t.processData&&t.data&&"string"!=e.type(t.data)&&(t.data=e.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=d(t.url,t.data))}function p(t,i,n,r){var a=!e.isFunction(i);return{url:t,data:a?i:void 0,success:a?e.isFunction(n)?n:void 0:i,dataType:a?r||n:n}}function f(t,i,n,r){var a,s=e.isArray(i);e.each(i,function(i,o){a=e.type(o),r&&(i=n?r:r+"["+(s?"":i)+"]"),!r&&s?t.add(o.name,o.value):"array"==a||!n&&"object"==a?f(t,o,n,i):t.add(i,o)})}var m,g,v=0,y=window.document,_=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,b=/^(?:text|application)\/javascript/i,w=/^(?:text|application)\/xml/i,x="application/json",k="text/html",C=/^\s*$/;e.active=0,e.ajaxJSONP=function(t){if(!("type"in t))return e.ajax(t);var i,n="jsonp"+ ++v,r=y.createElement("script"),l=function(){clearTimeout(i),e(r).remove(),delete window[n]},u=function(e){l(),e&&"timeout"!=e||(window[n]=c),o(null,e||"abort",d,t)},d={abort:u};return a(d,t)===!1?(u("abort"),!1):(window[n]=function(e){l(),s(e,d,t)},r.onerror=function(){u("error")},r.src=t.url.replace(/=\?/,"="+n),e("head").append(r),t.timeout>0&&(i=setTimeout(function(){u("timeout")},t.timeout)),d)},e.ajaxSettings={type:"GET",beforeSend:c,success:c,error:c,complete:c,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:x,xml:"application/xml, text/xml",html:k,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},e.ajax=function(t){var i=e.extend({},t||{});for(m in e.ajaxSettings)void 0===i[m]&&(i[m]=e.ajaxSettings[m]);n(i),i.crossDomain||(i.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(i.url)&&RegExp.$2!=window.location.host),i.url||(i.url=""+window.location),h(i),i.cache===!1&&(i.url=d(i.url,"_="+Date.now()));var r=i.dataType,l=/=\?/.test(i.url);if("jsonp"==r||l)return l||(i.url=d(i.url,"callback=?")),e.ajaxJSONP(i);var p,f=i.accepts[r],v={},y=/^([\w-]+:)\/\//.test(i.url)?RegExp.$1:window.location.protocol,_=i.xhr();i.crossDomain||(v["X-Requested-With"]="XMLHttpRequest"),f&&(v.Accept=f,f.indexOf(",")>-1&&(f=f.split(",",2)[0]),_.overrideMimeType&&_.overrideMimeType(f)),(i.contentType||i.contentType!==!1&&i.data&&"GET"!=i.type.toUpperCase())&&(v["Content-Type"]=i.contentType||"application/x-www-form-urlencoded"),i.headers=e.extend(v,i.headers||{}),_.onreadystatechange=function(){if(4==_.readyState){_.onreadystatechange=c,clearTimeout(p);var t,n=!1;if(_.status>=200&&300>_.status||304==_.status||0==_.status&&"file:"==y){r=r||u(_.getResponseHeader("content-type")),t=_.responseText;try{"script"==r?(1,eval)(t):"xml"==r?t=_.responseXML:"json"==r&&(t=C.test(t)?null:e.parseJSON(t))}catch(a){n=a}n?o(n,"parsererror",_,i):s(t,_,i)}else o(null,_.status?"error":"abort",_,i)}};var b="async"in i?i.async:!0;_.open(i.type,i.url,b);for(g in i.headers)_.setRequestHeader(g,i.headers[g]);return a(_,i)===!1?(_.abort(),!1):(i.timeout>0&&(p=setTimeout(function(){_.onreadystatechange=c,_.abort(),o(null,"timeout",_,i)},i.timeout)),_.send(i.data?i.data:null),_)},e.get=function(){return e.ajax(p.apply(null,arguments))},e.post=function(){var t=p.apply(null,arguments);return t.type="POST",e.ajax(t)},e.getJSON=function(){var t=p.apply(null,arguments);return t.dataType="json",e.ajax(t)},e.fn.load=function(t,i,n){if(!this.length)return this;var r,a=this,s=t.split(/\s/),o=p(t,i,n),l=o.success;return s.length>1&&(o.url=s[0],r=s[1]),o.success=function(t){a.html(r?e("<div>").html(t.replace(_,"")).find(r):t),l&&l.apply(a,arguments)},e.ajax(o),this};var E=encodeURIComponent;e.param=function(e,t){var i=[];return i.add=function(e,t){this.push(E(e)+"="+E(t))},f(i,e,t),i.join("&").replace(/%20/g,"+")}}(Zepto),function(e){e.fn.serializeArray=function(){var t,i=[];return e(Array.prototype.slice.call(this.get(0).elements)).each(function(){t=e(this);var n=t.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=n&&"reset"!=n&&"button"!=n&&("radio"!=n&&"checkbox"!=n||this.checked)&&i.push({name:t.attr("name"),value:t.val()})}),i},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},e.fn.submit=function(t){if(t)this.bind("submit",t);else if(this.length){var i=e.Event("submit");this.eq(0).trigger(i),i.defaultPrevented||this.get(0).submit()}return this}}(Zepto),function(e){function t(t,n){var l=t[o],c=l&&r[l];if(void 0===n)return c||i(t);if(c){if(n in c)return c[n];var u=s(n);if(u in c)return c[u]}return a.call(e(t),n)}function i(t,i,a){var l=t[o]||(t[o]=++e.uuid),c=r[l]||(r[l]=n(t));return void 0!==i&&(c[s(i)]=a),c}function n(t){var i={};return e.each(t.attributes,function(t,n){0==n.name.indexOf("data-")&&(i[s(n.name.replace("data-",""))]=e.zepto.deserializeValue(n.value))}),i}var r={},a=e.fn.data,s=e.camelCase,o=e.expando="Zepto"+ +new Date;e.fn.data=function(n,r){return void 0===r?e.isPlainObject(n)?this.each(function(t,r){e.each(n,function(e,t){i(r,e,t)})}):0==this.length?void 0:t(this[0],n):this.each(function(){i(this,n,r)})},e.fn.removeData=function(t){return"string"==typeof t&&(t=t.split(/\s+/)),this.each(function(){var i=this[o],n=i&&r[i];n&&e.each(t,function(){delete n[s(this)]})})}}(Zepto),function(e){function t(e){return"tagName"in e?e:e.parentNode}function i(e,t,i,n){var r=Math.abs(e-t),a=Math.abs(i-n);return r>=a?e-t>0?"Left":"Right":i-n>0?"Up":"Down"}function n(){c=null,u.last&&(u.el.trigger("longTap"),u={})}function r(){c&&clearTimeout(c),c=null}function a(){s&&clearTimeout(s),o&&clearTimeout(o),l&&clearTimeout(l),c&&clearTimeout(c),s=o=l=c=null,u={}}var s,o,l,c,u={},d=750;e(document).ready(function(){var h,p;e(document.body).bind("touchstart",function(i){h=Date.now(),p=h-(u.last||h),u.el=e(t(i.touches[0].target)),s&&clearTimeout(s),u.x1=i.touches[0].pageX,u.y1=i.touches[0].pageY,p>0&&250>=p&&(u.isDoubleTap=!0),u.last=h,c=setTimeout(n,d)}).bind("touchmove",function(e){r(),u.x2=e.touches[0].pageX,u.y2=e.touches[0].pageY,Math.abs(u.x1-u.x2)>10&&e.preventDefault()}).bind("touchend",function(){r(),u.x2&&Math.abs(u.x1-u.x2)>30||u.y2&&Math.abs(u.y1-u.y2)>30?l=setTimeout(function(){u.el.trigger("swipe"),u.el.trigger("swipe"+i(u.x1,u.x2,u.y1,u.y2)),u={}},0):"last"in u&&(o=setTimeout(function(){var t=e.Event("tap");t.cancelTouch=a,u.el.trigger(t),u.isDoubleTap?(u.el.trigger("doubleTap"),u={}):s=setTimeout(function(){s=null,u.el.trigger("singleTap"),u={}},250)},0))}).bind("touchcancel",a),e(window).bind("scroll",a)}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(t){e.fn[t]=function(e){return this.bind(t,e)}})}(Zepto),"function"==typeof define&&define("zepto",function(){return Zepto}),define("handlebars",function(e,t,i){this.Handlebars={},function(e){e.VERSION="1.0.rc.1",e.helpers={},e.partials={},e.registerHelper=function(e,t,i){i&&(t.not=i),this.helpers[e]=t},e.registerPartial=function(e,t){this.partials[e]=t},e.registerHelper("helperMissing",function(e){if(2===arguments.length)return void 0;throw Error("Could not find property '"+e+"'")});var t=Object.prototype.toString,i="[object Function]";e.registerHelper("blockHelperMissing",function(n,r){var a=r.inverse||function(){},s=r.fn,o=t.call(n);return o===i&&(n=n.call(this)),n===!0?s(this):n===!1||null==n?a(this):"[object Array]"===o?n.length>0?e.helpers.each(n,r):a(this):s(n)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var i=new e.K;return e.K.prototype=null,i},e.registerHelper("each",function(t,i){var n,r=i.fn,a=i.inverse,s="";if(i.data&&(n=e.createFrame(i.data)),t&&t.length>0)for(var o=0,l=t.length;l>o;o++)n&&(n.index=o),s+=r(t[o],{data:n});else s=a(this);return s}),e.registerHelper("if",function(n,r){var a=t.call(n);return a===i&&(n=n.call(this)),!n||e.Utils.isEmpty(n)?r.inverse(this):r.fn(this)}),e.registerHelper("unless",function(t,i){var n=i.fn,r=i.inverse;return i.fn=r,i.inverse=n,e.helpers["if"].call(this,t,i)}),e.registerHelper("with",function(e,t){return t.fn(e)}),e.registerHelper("log",function(t){e.log(t)})}(this.Handlebars);var n=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,statements:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,OPEN_PARTIAL:24,params:25,hash:26,DATA:27,param:28,STRING:29,INTEGER:30,BOOLEAN:31,hashSegments:32,hashSegment:33,ID:34,EQUALS:35,pathSegments:36,SEP:37,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"OPEN_PARTIAL",27:"DATA",29:"STRING",30:"INTEGER",31:"BOOLEAN",34:"ID",35:"EQUALS",37:"SEP"},productions_:[0,[3,2],[4,3],[4,1],[4,0],[6,1],[6,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[7,2],[17,3],[17,2],[17,2],[17,1],[17,1],[25,2],[25,1],[28,1],[28,1],[28,1],[28,1],[28,1],[26,1],[32,2],[32,1],[33,3],[33,3],[33,3],[33,3],[33,3],[21,1],[36,3],[36,1]],performAction:function(e,t,i,n,r,a){var s=a.length-1;switch(r){case 1:return a[s-1];case 2:this.$=new n.ProgramNode(a[s-2],a[s]);break;case 3:this.$=new n.ProgramNode(a[s]);break;case 4:this.$=new n.ProgramNode([]);break;case 5:this.$=[a[s]];break;case 6:a[s-1].push(a[s]),this.$=a[s-1];break;case 7:this.$=new n.BlockNode(a[s-2],a[s-1].inverse,a[s-1],a[s]);break;case 8:this.$=new n.BlockNode(a[s-2],a[s-1],a[s-1].inverse,a[s]);break;case 9:this.$=a[s];break;case 10:this.$=a[s];break;case 11:this.$=new n.ContentNode(a[s]);break;case 12:this.$=new n.CommentNode(a[s]);break;case 13:this.$=new n.MustacheNode(a[s-1][0],a[s-1][1]);break;case 14:this.$=new n.MustacheNode(a[s-1][0],a[s-1][1]);break;case 15:this.$=a[s-1];break;case 16:this.$=new n.MustacheNode(a[s-1][0],a[s-1][1]);
break;case 17:this.$=new n.MustacheNode(a[s-1][0],a[s-1][1],!0);break;case 18:this.$=new n.PartialNode(a[s-1]);break;case 19:this.$=new n.PartialNode(a[s-2],a[s-1]);break;case 20:break;case 21:this.$=[[a[s-2]].concat(a[s-1]),a[s]];break;case 22:this.$=[[a[s-1]].concat(a[s]),null];break;case 23:this.$=[[a[s-1]],a[s]];break;case 24:this.$=[[a[s]],null];break;case 25:this.$=[[new n.DataNode(a[s])],null];break;case 26:a[s-1].push(a[s]),this.$=a[s-1];break;case 27:this.$=[a[s]];break;case 28:this.$=a[s];break;case 29:this.$=new n.StringNode(a[s]);break;case 30:this.$=new n.IntegerNode(a[s]);break;case 31:this.$=new n.BooleanNode(a[s]);break;case 32:this.$=new n.DataNode(a[s]);break;case 33:this.$=new n.HashNode(a[s]);break;case 34:a[s-1].push(a[s]),this.$=a[s-1];break;case 35:this.$=[a[s]];break;case 36:this.$=[a[s-2],a[s]];break;case 37:this.$=[a[s-2],new n.StringNode(a[s])];break;case 38:this.$=[a[s-2],new n.IntegerNode(a[s])];break;case 39:this.$=[a[s-2],new n.BooleanNode(a[s])];break;case 40:this.$=[a[s-2],new n.DataNode(a[s])];break;case 41:this.$=new n.IdNode(a[s]);break;case 42:a[s-2].push(a[s]),this.$=a[s-2];break;case 43:this.$=[a[s]]}},table:[{3:1,4:2,5:[2,4],6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{1:[3]},{5:[1,16]},{5:[2,3],7:17,8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,19],20:[2,3],22:[1,13],23:[1,14],24:[1,15]},{5:[2,5],14:[2,5],15:[2,5],16:[2,5],19:[2,5],20:[2,5],22:[2,5],23:[2,5],24:[2,5]},{4:20,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{4:21,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],24:[2,9]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],24:[2,10]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],24:[2,11]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],24:[2,12]},{17:22,21:23,27:[1,24],34:[1,26],36:25},{17:27,21:23,27:[1,24],34:[1,26],36:25},{17:28,21:23,27:[1,24],34:[1,26],36:25},{17:29,21:23,27:[1,24],34:[1,26],36:25},{21:30,34:[1,26],36:25},{1:[2,1]},{6:31,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{5:[2,6],14:[2,6],15:[2,6],16:[2,6],19:[2,6],20:[2,6],22:[2,6],23:[2,6],24:[2,6]},{17:22,18:[1,32],21:23,27:[1,24],34:[1,26],36:25},{10:33,20:[1,34]},{10:35,20:[1,34]},{18:[1,36]},{18:[2,24],21:41,25:37,26:38,27:[1,45],28:39,29:[1,42],30:[1,43],31:[1,44],32:40,33:46,34:[1,47],36:25},{18:[2,25]},{18:[2,41],27:[2,41],29:[2,41],30:[2,41],31:[2,41],34:[2,41],37:[1,48]},{18:[2,43],27:[2,43],29:[2,43],30:[2,43],31:[2,43],34:[2,43],37:[2,43]},{18:[1,49]},{18:[1,50]},{18:[1,51]},{18:[1,52],21:53,34:[1,26],36:25},{5:[2,2],8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,2],22:[1,13],23:[1,14],24:[1,15]},{14:[2,20],15:[2,20],16:[2,20],19:[2,20],22:[2,20],23:[2,20],24:[2,20]},{5:[2,7],14:[2,7],15:[2,7],16:[2,7],19:[2,7],20:[2,7],22:[2,7],23:[2,7],24:[2,7]},{21:54,34:[1,26],36:25},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],24:[2,8]},{14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],24:[2,14]},{18:[2,22],21:41,26:55,27:[1,45],28:56,29:[1,42],30:[1,43],31:[1,44],32:40,33:46,34:[1,47],36:25},{18:[2,23]},{18:[2,27],27:[2,27],29:[2,27],30:[2,27],31:[2,27],34:[2,27]},{18:[2,33],33:57,34:[1,58]},{18:[2,28],27:[2,28],29:[2,28],30:[2,28],31:[2,28],34:[2,28]},{18:[2,29],27:[2,29],29:[2,29],30:[2,29],31:[2,29],34:[2,29]},{18:[2,30],27:[2,30],29:[2,30],30:[2,30],31:[2,30],34:[2,30]},{18:[2,31],27:[2,31],29:[2,31],30:[2,31],31:[2,31],34:[2,31]},{18:[2,32],27:[2,32],29:[2,32],30:[2,32],31:[2,32],34:[2,32]},{18:[2,35],34:[2,35]},{18:[2,43],27:[2,43],29:[2,43],30:[2,43],31:[2,43],34:[2,43],35:[1,59],37:[2,43]},{34:[1,60]},{14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],24:[2,13]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],24:[2,16]},{5:[2,17],14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],24:[2,17]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],24:[2,18]},{18:[1,61]},{18:[1,62]},{18:[2,21]},{18:[2,26],27:[2,26],29:[2,26],30:[2,26],31:[2,26],34:[2,26]},{18:[2,34],34:[2,34]},{35:[1,59]},{21:63,27:[1,67],29:[1,64],30:[1,65],31:[1,66],34:[1,26],36:25},{18:[2,42],27:[2,42],29:[2,42],30:[2,42],31:[2,42],34:[2,42],37:[2,42]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],24:[2,19]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],24:[2,15]},{18:[2,36],34:[2,36]},{18:[2,37],34:[2,37]},{18:[2,38],34:[2,38]},{18:[2,39],34:[2,39]},{18:[2,40],34:[2,40]}],defaultActions:{16:[2,1],24:[2,25],38:[2,23],55:[2,21]},parseError:function(e){throw Error(e)},parse:function(e){function t(){var e;return e=i.lexer.lex()||1,"number"!=typeof e&&(e=i.symbols_[e]||e),e}var i=this,n=[0],r=[null],a=[],s=this.table,o="",l=0,c=0,u=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var d=this.lexer.yylloc;a.push(d);var h=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,m,g,v,y,_,b,w,x={};;){if(m=n[n.length-1],this.defaultActions[m]?g=this.defaultActions[m]:((null===p||void 0===p)&&(p=t()),g=s[m]&&s[m][p]),void 0===g||!g.length||!g[0]){var k="";if(!u){w=[];for(y in s[m])this.terminals_[y]&&y>2&&w.push("'"+this.terminals_[y]+"'");k=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(k,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:d,expected:w})}}if(g[0]instanceof Array&&g.length>1)throw Error("Parse Error: multiple actions possible at state: "+m+", token: "+p);switch(g[0]){case 1:n.push(p),r.push(this.lexer.yytext),a.push(this.lexer.yylloc),n.push(g[1]),p=null,f?(p=f,f=null):(c=this.lexer.yyleng,o=this.lexer.yytext,l=this.lexer.yylineno,d=this.lexer.yylloc,u>0&&u--);break;case 2:if(_=this.productions_[g[1]][1],x.$=r[r.length-_],x._$={first_line:a[a.length-(_||1)].first_line,last_line:a[a.length-1].last_line,first_column:a[a.length-(_||1)].first_column,last_column:a[a.length-1].last_column},h&&(x._$.range=[a[a.length-(_||1)].range[0],a[a.length-1].range[1]]),v=this.performAction.call(x,o,c,l,this.yy,g[1],r,a),void 0!==v)return v;_&&(n=n.slice(0,-2*_),r=r.slice(0,-1*_),a=a.slice(0,-1*_)),n.push(this.productions_[g[1]][0]),r.push(x.$),a.push(x._$),b=s[n[n.length-2]][n[n.length-1]],n.push(b);break;case 3:return!0}}return!0}},i=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,i=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return 20>e.length&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,i,n,r;this._more||(this.yytext="",this.match="");for(var a=this._currentRules(),s=0;a.length>s&&(i=this._input.match(this.rules[a[s]]),!i||t&&!(i[0].length>t[0].length)||(t=i,n=s,this.options.flex));s++);return t?(r=t[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,a[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e?e:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return void 0!==e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)}};return e.options={},e.performAction=function(e,t,i){switch(i){case 0:if("\\"!==t.yytext.slice(-1)&&this.begin("mu"),"\\"===t.yytext.slice(-1)&&(t.yytext=t.yytext.substr(0,t.yyleng-1),this.begin("emu")),t.yytext)return 14;break;case 1:return 14;case 2:return"\\"!==t.yytext.slice(-1)&&this.popState(),"\\"===t.yytext.slice(-1)&&(t.yytext=t.yytext.substr(0,t.yyleng-1)),14;case 3:return 24;case 4:return 16;case 5:return 20;case 6:return 19;case 7:return 19;case 8:return 23;case 9:return 23;case 10:return t.yytext=t.yytext.substr(3,t.yyleng-5),this.popState(),15;case 11:return 22;case 12:return 35;case 13:return 34;case 14:return 34;case 15:return 37;case 16:break;case 17:return this.popState(),18;case 18:return this.popState(),18;case 19:return t.yytext=t.yytext.substr(1,t.yyleng-2).replace(/\\"/g,'"'),29;case 20:return t.yytext=t.yytext.substr(1,t.yyleng-2).replace(/\\"/g,'"'),29;case 21:return t.yytext=t.yytext.substr(1),27;case 22:return 31;case 23:return 31;case 24:return 30;case 25:return 34;case 26:return t.yytext=t.yytext.substr(1,t.yyleng-2),34;case 27:return"INVALID";case 28:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:\{\{>)/,/^(?:\{\{#)/,/^(?:\{\{\/)/,/^(?:\{\{\^)/,/^(?:\{\{\s*else\b)/,/^(?:\{\{\{)/,/^(?:\{\{&)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{)/,/^(?:=)/,/^(?:\.(?=[} ]))/,/^(?:\.\.)/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}\}\})/,/^(?:\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@[a-zA-Z]+)/,/^(?:true(?=[}\s]))/,/^(?:false(?=[}\s]))/,/^(?:[0-9]+(?=[}\s]))/,/^(?:[a-zA-Z0-9_$-]+(?=[=}\s\/.]))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],inclusive:!1},emu:{rules:[2],inclusive:!1},INITIAL:{rules:[0,1,28],inclusive:!0}},e}();return t.lexer=i,e.prototype=t,t.Parser=e,new e}();return void 0!==e&&void 0!==t&&(t.parser=n,t.Parser=n.Parser,t.parse=function(){return n.parse.apply(n,arguments)},t.main=function(i){if(!i[1])throw Error("Usage: "+i[0]+" FILE");var n;return n="undefined"!=typeof process?e("fs").readFileSync(e("path").resolve(i[1]),"utf8"):e("file").path(e("file").cwd()).join(i[1]).read({charset:"utf-8"}),t.parser.parse(n)},void 0!==i&&e.main===i&&t.main("undefined"!=typeof process?process.argv.slice(1):e("system").args)),Handlebars.Parser=n,Handlebars.parse=function(e){return Handlebars.Parser.yy=Handlebars.AST,Handlebars.Parser.parse(e)},Handlebars.print=function(e){return(new Handlebars.PrintVisitor).accept(e)},Handlebars.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(){}},Handlebars.log=function(e,t){Handlebars.logger.log(e,t)},function(){Handlebars.AST={},Handlebars.AST.ProgramNode=function(e,t){this.type="program",this.statements=e,t&&(this.inverse=new Handlebars.AST.ProgramNode(t))},Handlebars.AST.MustacheNode=function(e,t,i){this.type="mustache",this.escaped=!i,this.hash=t;var n=this.id=e[0],r=this.params=e.slice(1),a=this.eligibleHelper=n.isSimple;this.isHelper=a&&(r.length||t)},Handlebars.AST.PartialNode=function(e,t){this.type="partial",this.id=e,this.context=t};var e=function(e,t){if(e.original!==t.original)throw new Handlebars.Exception(e.original+" doesn't match "+t.original)};Handlebars.AST.BlockNode=function(t,i,n,r){e(t.id,r),this.type="block",this.mustache=t,this.program=i,this.inverse=n,this.inverse&&!this.program&&(this.isInverse=!0)},Handlebars.AST.ContentNode=function(e){this.type="content",this.string=e},Handlebars.AST.HashNode=function(e){this.type="hash",this.pairs=e},Handlebars.AST.IdNode=function(e){this.type="ID",this.original=e.join(".");for(var t=[],i=0,n=0,r=e.length;r>n;n++){var a=e[n];".."===a?i++:"."===a||"this"===a?this.isScoped=!0:t.push(a)}this.parts=t,this.string=t.join("."),this.depth=i,this.isSimple=1===e.length&&!this.isScoped&&0===i},Handlebars.AST.DataNode=function(e){this.type="DATA",this.id=e},Handlebars.AST.StringNode=function(e){this.type="STRING",this.string=e},Handlebars.AST.IntegerNode=function(e){this.type="INTEGER",this.integer=e},Handlebars.AST.BooleanNode=function(e){this.type="BOOLEAN",this.bool=e},Handlebars.AST.CommentNode=function(e){this.type="comment",this.comment=e}}(),Handlebars.Exception=function(){var e=Error.prototype.constructor.apply(this,arguments);for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);this.message=e.message},Handlebars.Exception.prototype=Error(),Handlebars.SafeString=function(e){this.string=e},Handlebars.SafeString.prototype.toString=function(){return""+this.string},function(){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},t=/[&<>"'`]/g,i=/[&<>"'`]/,n=function(t){return e[t]||"&amp;"};Handlebars.Utils={escapeExpression:function(e){return e instanceof Handlebars.SafeString?""+e:null==e||e===!1?"":i.test(e)?e.replace(t,n):e},isEmpty:function(e){return void 0===e?!0:null===e?!0:e===!1?!0:"[object Array]"===Object.prototype.toString.call(e)&&0===e.length?!0:!1}}}(),Handlebars.Compiler=function(){},Handlebars.JavaScriptCompiler=function(){},function(e,t){e.prototype={compiler:e,disassemble:function(){for(var e,t,i,n=this.opcodes,r=[],a=0,s=n.length;s>a;a++)if(e=n[a],"DECLARE"===e.opcode)r.push("DECLARE "+e.name+"="+e.value);else{t=[];for(var o=0;e.args.length>o;o++)i=e.args[o],"string"==typeof i&&(i='"'+i.replace("\n","\\n")+'"'),t.push(i);r.push(e.opcode+" "+t.join(" "))}return r.join("\n")},guid:0,compile:function(e,t){this.children=[],this.depths={list:[]},this.options=t;var i=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},i)for(var n in i)this.options.knownHelpers[n]=i[n];return this.program(e)},accept:function(e){return this[e.type](e)},program:function(e){var t,i=e.statements;this.opcodes=[];for(var n=0,r=i.length;r>n;n++)t=i[n],this[t.type](t);return this.isSimple=1===r,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t,i=(new this.compiler).compile(e,this.options),n=this.guid++;this.usePartial=this.usePartial||i.usePartial,this.children[n]=i;for(var r=0,a=i.depths.list.length;a>r;r++)t=i.depths.list[r],2>t||this.addDepth(t-1);return n},block:function(e){var t=e.mustache,i=e.program,n=e.inverse;i&&(i=this.compileProgram(i)),n&&(n=this.compileProgram(n));var r=this.classifyMustache(t);"helper"===r?this.helperMustache(t,i,n):"simple"===r?(this.simpleMustache(t),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("pushLiteral","{}"),this.opcode("blockValue")):(this.ambiguousMustache(t,i,n),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("pushLiteral","{}"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(e){var t,i,n=e.pairs;this.opcode("push","{}");for(var r=0,a=n.length;a>r;r++)t=n[r],i=t[1],this.accept(i),this.opcode("assignToHash",t[0])},partial:function(e){var t=e.id;this.usePartial=!0,e.context?this.ID(e.context):this.opcode("push","depth0"),this.opcode("invokePartial",t.original),this.opcode("append")},content:function(e){this.opcode("appendContent",e.string)},mustache:function(e){var t=this.options,i=this.classifyMustache(e);"simple"===i?this.simpleMustache(e):"helper"===i?this.helperMustache(e):this.ambiguousMustache(e),e.escaped&&!t.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousMustache:function(e,t,i){var n=e.id,r=n.parts[0];this.opcode("getContext",n.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",i),this.opcode("invokeAmbiguous",r)},simpleMustache:function(e){var t=e.id;"DATA"===t.type?this.DATA(t):t.parts.length?this.ID(t):(this.addDepth(t.depth),this.opcode("getContext",t.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(e,t,i){var n=this.setupFullMustacheParams(e,t,i),r=e.id.parts[0];if(this.options.knownHelpers[r])this.opcode("invokeKnownHelper",n.length,r);else{if(this.knownHelpersOnly)throw Error("You specified knownHelpersOnly, but used the unknown helper "+r);this.opcode("invokeHelper",n.length,r)}},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0];t?this.opcode("lookupOnContext",e.parts[0]):this.opcode("pushContext");for(var i=1,n=e.parts.length;n>i;i++)this.opcode("lookup",e.parts[i])},DATA:function(e){this.options.data=!0,this.opcode("lookupData",e.id)},STRING:function(e){this.opcode("pushString",e.string)},INTEGER:function(e){this.opcode("pushLiteral",e.integer)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:[].slice.call(arguments,1)})},declare:function(e,t){this.opcodes.push({opcode:"DECLARE",name:e,value:t})},addDepth:function(e){if(isNaN(e))throw Error("EWOT");0!==e&&(this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e)))},classifyMustache:function(e){var t=e.isHelper,i=e.eligibleHelper,n=this.options;if(i&&!t){var r=e.id.parts[0];n.knownHelpers[r]?t=!0:n.knownHelpersOnly&&(i=!1)}return t?"helper":i?"ambiguous":"simple"},pushParams:function(e){for(var t,i=e.length;i--;)t=e[i],this.options.stringParams?(t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",t.string)):this[t.type](t)},setupMustacheParams:function(e){var t=e.params;return this.pushParams(t),e.hash?this.hash(e.hash):this.opcode("pushLiteral","{}"),t},setupFullMustacheParams:function(e,t,i){var n=e.params;return this.pushParams(n),this.opcode("pushProgram",t),this.opcode("pushProgram",i),e.hash?this.hash(e.hash):this.opcode("pushLiteral","{}"),n}};var i=function(e){this.value=e};t.prototype={nameLookup:function(e,i){return/^[0-9]+$/.test(i)?e+"["+i+"]":t.isValidJavaScriptVariableName(i)?e+"."+i:e+"['"+i+"']"},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":"buffer += "+e+";"},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(e,t,i,n){this.environment=e,this.options=t||{},Handlebars.log(Handlebars.logger.DEBUG,this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!i,this.context=i||{programs:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.compileChildren(e,t);var r,a=e.opcodes;for(this.i=0,s=a.length;s>this.i;this.i++)r=a[this.i],"DECLARE"===r.opcode?this[r.name]=r.value:this[r.opcode].apply(this,r.args);return this.createFunctionContext(n)},nextOpcode:function(){var e=this.environment.opcodes;return e[this.i+1],e[this.i+1]},eat:function(){this.i=this.i+1},preamble:function(){var e=[];if(this.isChild)e.push("");else{var t=this.namespace,i="helpers = helpers || "+t+".helpers;";this.environment.usePartial&&(i=i+" partials = partials || "+t+".partials;"),this.options.data&&(i+=" data = data || {};"),e.push(i)}this.environment.isSimple?e.push(""):e.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=e},createFunctionContext:function(e){var t=this.stackVars.concat(this.registers.list);if(t.length>0&&(this.source[1]=this.source[1]+", "+t.join(", ")),!this.isChild)for(var i in this.context.aliases)this.source[1]=this.source[1]+", "+i+"="+this.context.aliases[i];this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.source.push("return buffer;");for(var n=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],r=0,a=this.environment.depths.list.length;a>r;r++)n.push("depth"+this.environment.depths.list[r]);if(e)return n.push(this.source.join("\n  ")),Function.apply(this,n);var s="function "+(this.name||"")+"("+n.join(",")+") {\n  "+this.source.join("\n  ")+"}";return Handlebars.log(Handlebars.logger.DEBUG,s+"\n\n"),s},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e),this.replaceStack(function(t){return e.splice(1,0,t),t+" = blockHelperMissing.call("+e.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e);var t=this.topStack();e.splice(1,0,t),this.source.push("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.source.push(this.appendToBuffer(this.quotedString(e)))},append:function(){var e=this.popStack();this.source.push("if("+e+" || "+e+" === 0) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){var e=this.nextOpcode(),t="";this.context.aliases.escapeExpression="this.escapeExpression",e&&"appendContent"===e.opcode&&(t=" + "+this.quotedString(e.args[0]),this.eat(e)),this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"+t))},getContext:function(e){this.lastContext!==e&&(this.lastContext=e)},lookupOnContext:function(e){this.pushStack(this.nameLookup("depth"+this.lastContext,e,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(e){return"typeof "+e+" === functionType ? "+e+"() : "+e})},lookup:function(e){this.replaceStack(function(t){return t+" == null || "+t+" === false ? "+t+" : "+this.nameLookup(t,e,"context")})},lookupData:function(e){this.pushStack(this.nameLookup("data",e,"data"))},pushStringParam:function(e){this.pushStackLiteral("depth"+this.lastContext),this.pushString(e)},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){this.pushStack(e)},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){null!=e?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},invokeHelper:function(e,t){this.context.aliases.helperMissing="helpers.helperMissing";var i=this.lastHelper=this.setupHelper(e,t);this.register("foundHelper",i.name),this.pushStack("foundHelper ? foundHelper.call("+i.callParams+") "+": helperMissing.call("+i.helperMissingParams+")")},invokeKnownHelper:function(e,t){var i=this.setupHelper(e,t);this.pushStack(i.name+".call("+i.callParams+")")},invokeAmbiguous:function(e){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");var t=this.setupHelper(0,e),i=this.lastHelper=this.nameLookup("helpers",e,"helper");this.register("foundHelper",i);var n=this.nameLookup("depth"+this.lastContext,e,"context"),r=this.nextStack();this.source.push("if (foundHelper) { "+r+" = foundHelper.call("+t.callParams+"); }"),this.source.push("else { "+r+" = "+n+"; "+r+" = typeof "+r+" === functionType ? "+r+"() : "+r+"; }")},invokePartial:function(e){var t=[this.nameLookup("partials",e,"partial"),"'"+e+"'",this.popStack(),"helpers","partials"];this.options.data&&t.push("data"),this.context.aliases.self="this",this.pushStack("self.invokePartial("+t.join(", ")+");")},assignToHash:function(e){var t=this.popStack(),i=this.topStack();this.source.push(i+"['"+e+"'] = "+t+";")},compiler:t,compileChildren:function(e,t){for(var i,n,r=e.children,a=0,s=r.length;s>a;a++){i=r[a],n=new this.compiler,this.context.programs.push("");var o=this.context.programs.length;i.index=o,i.name="program"+o,this.context.programs[o]=n.compile(i,t,this.context)}},programExpression:function(e){if(this.context.aliases.self="this",null==e)return"self.noop";for(var t,i=this.environment.children[e],n=i.depths.list,r=[i.index,i.name,"data"],a=0,s=n.length;s>a;a++)t=n[a],1===t?r.push("depth0"):r.push("depth"+(t-1));return 0===n.length?"self.program("+r.join(", ")+")":(r.shift(),"self.programWithDepth("+r.join(", ")+")")},register:function(e,t){this.useRegister(e),this.source.push(e+" = "+t+";")},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.compileStack.push(new i(e)),e},pushStack:function(e){return this.source.push(this.incrStack()+" = "+e+";"),this.compileStack.push("stack"+this.stackSlot),"stack"+this.stackSlot},replaceStack:function(e){var t=e.call(this,this.topStack());return this.source.push(this.topStack()+" = "+t+";"),"stack"+this.stackSlot},nextStack:function(){var e=this.incrStack();return this.compileStack.push("stack"+this.stackSlot),e},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),"stack"+this.stackSlot},popStack:function(){var e=this.compileStack.pop();return e instanceof i?e.value:(this.stackSlot--,e)},topStack:function(){var e=this.compileStack[this.compileStack.length-1];return e instanceof i?e.value:e},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'},setupHelper:function(e,t){var i=[];this.setupParams(e,i);var n=this.nameLookup("helpers",t,"helper");return{params:i,name:n,callParams:["depth0"].concat(i).join(", "),helperMissingParams:["depth0",this.quotedString(t)].concat(i).join(", ")}},setupParams:function(e,t){var i,n,r,a=[],s=[];a.push("hash:"+this.popStack()),n=this.popStack(),r=this.popStack(),(r||n)&&(r||(this.context.aliases.self="this",r="self.noop"),n||(this.context.aliases.self="this",n="self.noop"),a.push("inverse:"+n),a.push("fn:"+r));for(var o=0;e>o;o++)i=this.popStack(),t.push(i),this.options.stringParams&&s.push(this.popStack());return this.options.stringParams&&a.push("contexts:["+s.join(",")+"]"),this.options.data&&a.push("data:data"),t.push("{"+a.join(",")+"}"),t.join(", ")}};for(var n="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),r=t.RESERVED_WORDS={},a=0,s=n.length;s>a;a++)r[n[a]]=!0;t.isValidJavaScriptVariableName=function(e){return!t.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(e)?!0:!1}}(Handlebars.Compiler,Handlebars.JavaScriptCompiler),Handlebars.precompile=function(e,t){t=t||{};var i=Handlebars.parse(e),n=(new Handlebars.Compiler).compile(i,t);return(new Handlebars.JavaScriptCompiler).compile(n,t)},Handlebars.compile=function(e,t){function i(){var i=Handlebars.parse(e),n=(new Handlebars.Compiler).compile(i,t),r=(new Handlebars.JavaScriptCompiler).compile(n,t,void 0,!0);return Handlebars.template(r)}t=t||{};var n;return function(e,t){return n||(n=i()),n.call(this,e,t)}},Handlebars.VM={template:function(e){var t={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(e,t,i){var n=this.programs[e];return i?Handlebars.VM.program(t,i):n?n:n=this.programs[e]=Handlebars.VM.program(t)},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop};return function(i,n){return n=n||{},e.call(t,Handlebars,i,n.helpers,n.partials,n.data)}},programWithDepth:function(e,t){var i=Array.prototype.slice.call(arguments,2);return function(n,r){return r=r||{},e.apply(this,[n,r.data||t].concat(i))}},program:function(e,t){return function(i,n){return n=n||{},e(i,n.data||t)}},noop:function(){return""},invokePartial:function(e,t,i,n,r,a){var s={helpers:n,partials:r,data:a};if(void 0===e)throw new Handlebars.Exception("The partial "+t+" could not be found");if(e instanceof Function)return e(i,s);if(Handlebars.compile)return r[t]=Handlebars.compile(e,{data:void 0!==a}),r[t](i,s);throw new Handlebars.Exception("The partial "+t+" could not be compiled when running in runtime-only mode")}},Handlebars.template=Handlebars.VM.template,Handlebars}),define("store",function(e,t,i){(function(){function e(){try{return c in o&&o[c]}catch(e){return!1}}function t(){try{return u in o&&o[u]&&o[u][o.location.hostname]}catch(e){return!1}}function n(e){return function(){var t=Array.prototype.slice.call(arguments,0);t.unshift(a),h.appendChild(a),a.addBehavior("#default#userData"),a.load(c);var i=e.apply(s,t);return h.removeChild(a),i}}function r(e){return e.replace(m,"___")}var a,s={},o=window,l=o.document,c="localStorage",u="globalStorage",d="__storejs__";if(s.disabled=!1,s.set=function(){},s.get=function(){},s.remove=function(){},s.clear=function(){},s.transact=function(e,t,i){var n=s.get(e);null==i&&(i=t,t=null),void 0===n&&(n=t||{}),i(n),s.set(e,n)},s.getAll=function(){},s.serialize=function(e){return JSON.stringify(e)},s.deserialize=function(e){if("string"!=typeof e)return void 0;try{return JSON.parse(e)}catch(t){return e||void 0}},e())a=o[c],s.set=function(e,t){return void 0===t?s.remove(e):(a.setItem(e,s.serialize(t)),t)},s.get=function(e){return s.deserialize(a.getItem(e))},s.remove=function(e){a.removeItem(e)},s.clear=function(){a.clear()},s.getAll=function(){for(var e={},t=0;a.length>t;++t){var i=a.key(t);e[i]=s.get(i)}return e};else if(t())a=o[u][o.location.hostname],s.set=function(e,t){return void 0===t?s.remove(e):(a[e]=s.serialize(t),t)},s.get=function(e){return s.deserialize(a[e]&&a[e].value)},s.remove=function(e){delete a[e]},s.clear=function(){for(var e in a)delete a[e]},s.getAll=function(){for(var e={},t=0;a.length>t;++t){var i=a.key(t);e[i]=s.get(i)}return e};else if(l.documentElement.addBehavior){var h,p;try{p=new ActiveXObject("htmlfile"),p.open(),p.write('<script>document.w=window</script><iframe src="/favicon.ico"></frame>'),p.close(),h=p.w.frames[0].document,a=h.createElement("div")
}catch(f){a=l.createElement("div"),h=l.body}var m=RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");s.set=n(function(e,t,i){return t=r(t),void 0===i?s.remove(t):(e.setAttribute(t,s.serialize(i)),e.save(c),i)}),s.get=n(function(e,t){return t=r(t),s.deserialize(e.getAttribute(t))}),s.remove=n(function(e,t){t=r(t),e.removeAttribute(t),e.save(c)}),s.clear=n(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(c);for(var i,n=0;i=t[n];n++)e.removeAttribute(i.name);e.save(c)}),s.getAll=n(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(c);for(var i,n={},r=0;i=t[r];++r)n[i]=s.get(i);return n})}try{s.set(d,d),s.get(d)!=d&&(s.disabled=!0),s.remove(d)}catch(f){s.disabled=!0}s.enabled=!s.disabled,void 0!==i&&"function"!=typeof i?i.exports=s:"function"==typeof define&&define.amd?define(s):this.store=s})()});var TWEEN=TWEEN||function(){var e=[];return{REVISION:"10",getAll:function(){return e},removeAll:function(){e=[]},add:function(t){e.push(t)},remove:function(t){var i=e.indexOf(t);-1!==i&&e.splice(i,1)},update:function(t){var i=e.length;if(0===i)return!1;var n,r=0;for(t=void 0!==t?t:void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();i>r;)n=e[r],n&&n.update(t)?r++:(e.splice(r,1),i--);return!0}}}();TWEEN.Tween=function(e){var t=e,i={},n={},r={},a=1e3,s=0,o=0,l=null,c=TWEEN.Easing.Linear.None,u=TWEEN.Interpolation.Linear,d=[],h=null,p=!1,f=null,m=null;for(var g in e)i[g]=parseFloat(e[g],10);this.to=function(e,t){return void 0!==t&&(a=t),n=e,this},this.start=function(e){TWEEN.add(this),p=!1,l=void 0!==e?e:void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),l+=o;for(var a in n){if(n[a]instanceof Array){if(0===n[a].length)continue;n[a]=[t[a]].concat(n[a])}i[a]=t[a],i[a]instanceof Array==!1&&(i[a]*=1),r[a]=i[a]||0}return this},this.stop=function(){return TWEEN.remove(this),this},this.delay=function(e){return o=e,this},this.repeat=function(e){return s=e,this},this.easing=function(e){return c=e,this},this.interpolation=function(e){return u=e,this},this.chain=function(){return d=arguments,this},this.onStart=function(e){return h=e,this},this.onUpdate=function(e){return f=e,this},this.onComplete=function(e){return m=e,this},this.update=function(e){if(l>e)return!0;p===!1&&(null!==h&&h.call(t),p=!0);var g=(e-l)/a;g=g>1?1:g;var v=c(g);for(var y in n){var _=i[y]||0,b=n[y];b instanceof Array?t[y]=u(b,v):("string"==typeof b&&(b=_+parseFloat(b,10)),t[y]=_+(b-_)*v)}if(null!==f&&f.call(t,v),1==g){if(s>0){isFinite(s)&&s--;for(var y in r)"string"==typeof n[y]&&(r[y]=r[y]+parseFloat(n[y],10)),i[y]=r[y];return l=e+o,!0}null!==m&&m.call(t);for(var w=0,x=d.length;x>w;w++)d[w].start(e);return!1}return!0}},TWEEN.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return 1>(e*=2)?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return 1>(e*=2)?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return 1>(e*=2)?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return 1>(e*=2)?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:1>(e*=2)?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return 1>(e*=2)?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,i=.1,n=.4;return 0===e?0:1===e?1:(!i||1>i?(i=1,t=n/4):t=n*Math.asin(1/i)/(2*Math.PI),-(i*Math.pow(2,10*(e-=1))*Math.sin(2*(e-t)*Math.PI/n)))},Out:function(e){var t,i=.1,n=.4;return 0===e?0:1===e?1:(!i||1>i?(i=1,t=n/4):t=n*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*e)*Math.sin(2*(e-t)*Math.PI/n)+1)},InOut:function(e){var t,i=.1,n=.4;return 0===e?0:1===e?1:(!i||1>i?(i=1,t=n/4):t=n*Math.asin(1/i)/(2*Math.PI),1>(e*=2)?-.5*i*Math.pow(2,10*(e-=1))*Math.sin(2*(e-t)*Math.PI/n):.5*i*Math.pow(2,-10*(e-=1))*Math.sin(2*(e-t)*Math.PI/n)+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return 1>(e*=2)?.5*e*e*((t+1)*e-t):.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-TWEEN.Easing.Bounce.Out(1-e)},Out:function(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return.5>e?.5*TWEEN.Easing.Bounce.In(2*e):.5*TWEEN.Easing.Bounce.Out(2*e-1)+.5}}},TWEEN.Interpolation={Linear:function(e,t){var i=e.length-1,n=i*t,r=Math.floor(n),a=TWEEN.Interpolation.Utils.Linear;return 0>t?a(e[0],e[1],n):t>1?a(e[i],e[i-1],i-n):a(e[r],e[r+1>i?i:r+1],n-r)},Bezier:function(e,t){var i,n=0,r=e.length-1,a=Math.pow,s=TWEEN.Interpolation.Utils.Bernstein;for(i=0;r>=i;i++)n+=a(1-t,r-i)*a(t,i)*e[i]*s(r,i);return n},CatmullRom:function(e,t){var i=e.length-1,n=i*t,r=Math.floor(n),a=TWEEN.Interpolation.Utils.CatmullRom;return e[0]===e[i]?(0>t&&(r=Math.floor(n=i*(1+t))),a(e[(r-1+i)%i],e[r],e[(r+1)%i],e[(r+2)%i],n-r)):0>t?e[0]-(a(e[0],e[0],e[1],e[1],-n)-e[0]):t>1?e[i]-(a(e[i],e[i],e[i-1],e[i-1],n-i)-e[i]):a(e[r?r-1:0],e[r],e[r+1>i?i:r+1],e[r+2>i?i:r+2],n-r)},Utils:{Linear:function(e,t,i){return(t-e)*i+e},Bernstein:function(e,t){var i=TWEEN.Interpolation.Utils.Factorial;return i(e)/i(t)/i(e-t)},Factorial:function(){var e=[1];return function(t){var i,n=1;if(e[t])return e[t];for(i=t;i>1;i--)n*=i;return e[t]=n}}(),CatmullRom:function(e,t,i,n,r){var a=.5*(i-e),s=.5*(n-t),o=r*r,l=r*o;return(2*t-2*i+a+s)*l+(-3*t+3*i-2*a-s)*o+a*r+t}}},"function"==typeof define&&define("tween",function(){return TWEEN}),define("af",function(){"use strict";var e=window.performance&&window.performance.now,t=e?function(){return window.performance.now()}:Date.now||function(){return(new Date).getTime()},i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,n=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame;if(!i){var r=0;i=function(e){var i=t(),n=Math.max(0,16-(i-r)),a=setTimeout(function(){e(i+n)},n);return r=i+n,a}}return n||(n=function(e){clearTimeout(e)}),{request:i,cancel:n}}),define("util",function(){"use strict";var e=/^\s+/,t=/\s+$/,i=/[^0-9a-zA-Z_\u4e00-\u9fa5\ \'\.]+/g,n=String.prototype.trim,r={zh_CN:i,cut30length:function(e,t){if(!e)return"";for(e=e.replace(i," "),t||(t=30);r.utf8length(e)>t;)e=e.substring(0,e.length-1);return e},utf8length:function(e){for(var t,i=e.length,n=0,r=0;i>r;r++)if(t=e.charCodeAt(r),127>t)n++;else if(2047>=t)n+=2;else if(55295>=t||t>=57344)n+=3;else{if(!(56319>=t))throw"Error: Invalid UTF-16 sequence. Missing high-surrogate code.";if(t=e.charCodeAt(++r),56320>t||t>57343)throw"Error: Invalid UTF-16 sequence. Missing low-surrogate code.";n+=4}return n},trim:n?function(e){return null==e?"":n.call(e)}:function(i){return null==i?"":(""+i).replace(e,"").replace(t,"")},parseId:function(){var e=/^([a-z0-9_\.]{1,})@facebook$/i,t=/^@([a-z0-9_]{1,15})$|^@?([a-z0-9_]{1,15})@twitter$/i,i=/^([a-z0-9_\.]{1,})@instagram$/i,n=/^(.*)@dropbox$/i,a=/^(.*)@flickr$/i,s=/^[a-z0-9!#$%&\'*+\\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+\\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,o=/^[^@]*<[a-z0-9!#$%&\'*+\\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+\\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?>$/i,l=/^(\+)?((?:(86)?(1(?:3\d|4[57]|5\d|8\d)\d{8}))|(?:(1)?(\d{5,15})))$/;return function(c){var u,d={};if(c=r.trim(c),(u=c.match(n))&&s.test(u[1]))d.name=u[1],d.external_username=u[1],d.provider="dropbox";else if(u=c.match(a))d.name=u[1],d.external_username=u[1],d.provider="flickr";else if(u=c.match(i))d.name=u[1],d.external_username=u[1],d.provider="instagram";else if(u=c.match(e))d.name=u[1],d.external_username=u[1],d.provider="facebook";else if(u=c.match(t))d.name=u[1]||u[2],d.external_username=d.name,d.provider="twitter";else if(s.test(c))d.name=r.cut30length(c.split("@")[0]),d.external_username=c,d.provider="email";else if(o.test(c)){var h=c.indexOf("<");d.name=r.cut30length(c.substring(0,h).replace(/^"|^'|"$|'$/g,"")),d.external_username=d.name,d.provider="email"}else if(u=c.replace(/[\s\-\(\)\_]/g,"").match(l)){var p,f,m=u[1];d.provider="phone",m?u[3]&&u[4]?(p=u[3],f=u[4],d.name=d.external_username=m+p+f):u[5]&&u[6]?(p=u[5],f=u[6],d.name=d.external_username=m+p+f):(d.name=c,d.provider=null):(m="+",u[4]?(p="86",f=u[4]):(p="1",f=u[2]),d.name=d.external_username=m+p+f)}else d.name=c,d.provider=null;return d}}(),tokenRegExp:/token=([a-zA-Z0-9]{32})/,printExtUserName:function(e,t){var i=e.external_username,n=e.provider;switch(n){case"twitter":i="@"+i+"@"+n;break;case"facebook":case"instagram":case"flickr":case"dropbox":i+="@"+n;break;case"phone":t&&(/^\+1\d{10}$/.test(i)?i=i.replace(/^(\+1)(\d{3})(\d{3})(\d{4})$/,"$1 ($2) $3-$4"):/^\+86\d{11}$/.test(i)&&(i=i.replace(/^(\+86)(\d{3})(\d{4})(\d{4})$/,"$1 $2 $3 $4")))}return i}};return r}),function(){"use strict";var e=/(?:\{\{|%\{)(\w*?)(?:\}\}?)/gm,t=/^\d{4}-\d{2}-\d{2}$/,i=/^\d{2}:\d{2}:\d{2}$/,n=.2,r=6e4,a=864e5,s={monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),months:"January February March April May June July August September October November December".split(" "),weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),"-1":function(){return"Today"},0:function(e){var t="",i=e.years,n=e.months;return i&&(t="{{years}} year"+(1===i?"":"s")),n&&(t+=(t?" ":"")+"{{months}} month"+(1===n?"":"s")),t+" ago"},1:function(e){var t="",i=e.days;return t=1===i?"Yesterday":2===i?"Two days ago":"{{days}} days ago"},2:function(e){var t="",i=e.isToday,n=e.hours;return t=!i&&n>=12?"Yesterday":"{{hours}} hours ago"},3:function(){return"1.5 hours ago"},4:function(){return"An hour ago"},5:function(e,t){return"X"===t?"Just now":"{{minutes}} minutes ago"},6:function(e,t){return"X"===t?"Now":"{{minutes}} minutes ago"},7:function(e,t){return"X"===t?"Now":"Seconds ago"},8:function(){return"In {{minutes}} minutes"},9:function(){return"In one hour"},10:function(){return"In 1.5 hours"},11:function(e){var t="",i=e.isToday,n=e.hours;return t=!i&&n>=12?"Tomorrow":"In {{hours}} hours"},12:function(e){var t="",i=e.days,n=e.day;return t=1===i?"Tomorrow":2===i?"In two days":s.weekdaysShort[n]+". in {{days}} days"},13:function(e){var t="",i=e.years,n=e.months;return i&&(t="{{years}} year"+(1===i?"":"s")),n&&(t+=(t?" ":"")+"{{months}} month"+(1===n?"":"s")),"In "+t}},o=function(e,t,i,n){var r,a=o.locales[o.locale],s=o.distanceOfTime(e,t),l=o.diff(s);return l.type=i,r=o.inWords(l,a),"function"==typeof n&&(r=n(r.data)),r},l=o.parseISO=function(e){return new Date(Date.parse(e))},c=o.toISO=function(e){return e.replace(/\s/,"T").replace(/\s/,"").replace(/([+\-]\d\d)(?::?)(\d\d)/,"$1:$2")};o.locale="en",o.locales={en:s},o.inWords=function(e,t){var i,n=t[e.token],r=e.type,a=e.date;return i="function"==typeof n?n(a,r):n,g(i,a)},o.diff=function(e){var t,i,a,s,o,l,c=e.target,u=e.distance,d=v(u/r),h={date:{}},p=h.date,f=e.days;return p.isToday=e.isToday,c._isToday?h.token=-1:-43199>d?(h.token=0,a=v(-d/525949),i=v(-d%525949/43829+n)):-1439>d?(h.token=1,t=3>-f?-f:v((-d+1439)/1440)):-107>d?(h.token=2,s=v(-d/60+n)):-81>d?h.token=3:-59>d?h.token=4:-29>d?(h.token=5,o=-d):0>d?(h.token=6,o=-d):0===d?h.token=7:60>d?(h.token=8,o=d):82>d?h.token=9:108>d?h.token=10:1440>d?(h.token=11,s=v(d/60+n)):43200>d?(h.token=12,t=3>f?f:v((d+1439)/1440),l=c.getDay()):(h.token=13,a=v(d/525949),i=v(d%525949/43829+n),12===i&&(i=0,a++)),a&&(p.years=a),i&&(p.months=i),t&&(p.days=t),s&&(p.hours=s),o&&(p.minutes=o),void 0!==l&&(p.day=l),h},o.distanceOfTime=function(e,t){e?"number"==typeof e?e=new Date(e):"string"==typeof e&&(e=l(c(e))):e=new Date,t?"number"==typeof t?t=new Date(t):"string"==typeof t&&(t=l(c(t))):t=new Date,e._reTime&&(t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0));var i=e.getFullYear(),n=e.getMonth(),r=e.getDate(),s=t.getFullYear(),o=t.getMonth(),u=t.getDate();return{target:e,source:t,distance:+e-+t,days:(+new Date(i,n,r)-+new Date(s,o,u))/a,isToday:i===s&&n===o&&r===u}},o.toLocaleDate=function(e){var t,i,n,r=e.outputformat,a=new Date,s=a.getFullYear()+"-"+p(a.getMonth()+1)+"-"+p(a.getDate()),o=!1,c=!1;if(r)t=a,n=s,o=!0;else{var u=e.begin_at,d=u.date,h=u.time,g=u.timezone,v="";d?(v=f(d),h?v+="T"+m(h):(c=!0,o=v===s)):(v=s,h&&(v+="T"+m(h))),d&&h&&g&&(v+="Z"),t=l(v),c&&(t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0)),i=n=t.getFullYear()+"-"+p(t.getMonth()+1)+"-"+p(t.getDate()),n+=h?" "+p(t.getHours())+":"+p(t.getMinutes())+":"+p(t.getSeconds()):""}return t._isToday=o,t._reTime=c,{date:t,text:n}};var u={date:function(e,t,i,n){var r=o.locales[o.locale];return r.weekdaysShort[n]+", "+r.monthsShort[t]+" "+i},time:function(e,t){var i=e>12?e-12:e,n=i+":"+p(t);return n+=e>=12?"PM":"AM"}};o.printEFTime=function(e,t,i){var n,r,a,s,l,c=e.outputformat,p=e.begin_at,f="X"===t,m={title:"",content:""},g=new Date;if(c)n=e.origin.replace(/^['"‘’“”“”‚„]+/,"").replace(/['"‘’“”“”‚„]+$/,""),m.title=n,f||(m.content=n,p.date&&(e.outputformat=0,r=o.toLocaleDate(e),m.content=o(r.date,g),e.outputformat=1));else if(i||(i=u),p&&(p.date||p.time?(r=o.toLocaleDate(e),a=r.date,p.date?(m.title=o(r.date,g,"X"),m.content=p.time_word+(p.time_word&&p.time?" ":"")+(p.time?i.time(a.getHours(),a.getMinutes()):"")+(p.time||p.time_word?p.time?" ":", ":"")+i.date(a.getFullYear(),a.getMonth(),a.getDate(),a.getDay())+(p.date_word?" ":"")+p.date_word):p.time&&(m.content=m.title=p.time_word+(p.time_word?" ":"")+i.time(a.getHours(),a.getMinutes())+(p.date_word?", ":"")+p.date_word),a.getFullYear()!==g.getFullYear()&&(m.content+=" "+a.getFullYear())):(p.date_word||p.time_word)&&(m.content=m.title=p.time_word+(p.time_word?", ":"")+p.date_word),p.timezone&&(s=p.timezone.replace(/^([+\-]\d\d:\d\d)[\w\W]*$/,"$1"),l=d(g),s!==l))){var v=h(g);m.content+=" ("+l+(v&&" "+v)+")"}return m},o.printTime=function(e,t){e||(e=new Date),t||(t=u);var i=new Date,n="";return n+=t.date(e.getFullYear(),e.getMonth(),e.getDate(),e.getDay())+" "+t.time(e.getHours(),e.getMinutes()),e.getFullYear()!==i.getFullYear()&&(n+=" "+e.getFullYear()),n};var d=o.getTimezone=function(e){var t,i,n,r;return e||(e=new Date),t=e.getTimezoneOffset(),r=0>=t?"+":"-",t=Math.abs(t),i=v(t/60),n=t-60*i,r+p(i)+":"+p(n)},h=function(e){var t;return e||(e=new Date),t=(""+e).replace(/^.*:\d\d( GMT[+-]\d+)? \(?([A-Za-z ]+)\)?\d*$/,"$2").replace(/[a-z ]/g,""),3===t.length?t:""};o.createEFTime=function(){return{begin_at:{date_word:"",date:"",time_word:"",time:"",timezone:"",id:0,type:"EFTime"},origin:"",outputformat:1,id:0,type:"CrossTime"}};var p=o.lead0=function(e,t){for(e=""+e,t||(t=2);t>e.length;)e="0"+e;return e},f=o.formatDate=function(e){var i;return t.test(e)?i=e:(i=e.split("-"),i[1]=p(i[1]),i[2]=p(i[2]),i=i.join("-")),i},m=o.formatTime=function(e){var t;return i.test(e)?t=e:(t=e.split(":"),t[0]=p(t[0]),t[1]=p(t[1]),t[2]=p(t[2]),t=t.join(":")),t},g=function(t,i){var n,r,a,s,o=t.match(e),l=0;if(o)for(;s=o[l];++l)r=s.replace(e,"$1"),a=i[r],n=RegExp(s.replace(/\{/gm,"\\{").replace(/\}/gm,"\\}")),t=t.replace(n,a);return t},v=function(e){return e-e%1};"function"==typeof define&&define("humantime",function(){return o})}(),define("lightsaber",function(e,t,i){"use strict";function n(){var e=new r;return g(e,_.prototype),e.request=new a,e.response=new s,e.init(),e}function r(){}function a(e){this.enableFullUrlPath=!!e,this.session={},this.path="/",this.method="GET",this.updateUrl()}function s(e,t){this.path=e,this.title=document.title,this.state=t||{}}function o(e){e=e||{};var t=this;this.map=[],this.params={},this._params=[],this.caseSensitive=e.caseSensitive,this.strict=e.strict,this.middleware=function(e,i,n){t._dispatch(e,i,n)}}function l(e,t,i){i=i||{},this.path=e,this.callbacks=t,this.regexp=v(e,this.keys=[],i.sensitive,i.strict)}function c(e,t,i){t=t||{},this.name=e,this.root=t.root,this.engine=t.engine,this.ext=f(e),this.timestamp=i||"",this.path=this.lookup(e)}function u(e){return function(t,i,n){t.app=i.app=e,t.next=n,i.locals=i.locals||m(i),n()}}function d(){return++d.id}function h(e,t,i){var n=e.length;if(!n)return-1;if(i||(i=0),i>n)return-1;for(0>i&&(i=Math.max(0,n+i));n>i;++i)if(i in e&&e[i]===t)return i;return-1}function p(e,t,i,n,r){return b.get(t,function(t){var a,s=t;"html"!==r&&(a=e.compile(t),s=a(i)),n(s)})}function f(e){return e.split(".")[1]||"html"}function m(e){function t(e){for(var i in e)t[i]=e[i];return e}return e.viewCallbacks=e.viewCallbacks||[],t}function g(e,t){var i;if(e&&t)for(i in t)e[i]=t[i];return e}function v(e,t,i,n){return e instanceof RegExp?e:($(e)&&(e="("+e.join("|")+")"),e=e.concat(n?"":"/?").replace(/\/\(/g,"(?:/").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?(\*)?/g,function(e,i,n,r,a,s,o){return t.push({name:r,optional:!!s}),i=i||"",""+(s?"":i)+"(?:"+(s?i:"")+(n||"")+(a||n&&"([^/.]+?)"||"([^/]+?)")+")"+(s||"")+(o?"(/*)?":"")}).replace(/([\/.])/g,"\\$1").replace(/\*/g,"(.*)"),RegExp("^"+e+"$",i?"":"i"))}var y,_=e("emitter"),b=e("jquery")||e("zepto"),w=b.proxy,x=window.location,k=window.history,C="/",E=!1;b(window).on("load",function(){E=!0,setTimeout(function(){E=!1},0)}),t=i.exports=n;var T;t.version="0.0.5",T=r.prototype,T.historySupport=y=null!==(null!==k?k.pushState:void 0),b.browser&&b.browser.opera&&(T.historySupport=y=!1),T.init=function(){this.route=C,this.stack=[],this.cache={},this.settings={},this.engines={},this.viewCallbacks=[],this.defaultConfiguration()},T.defaultConfiguration=function(){this.set("env","production"),this.enable("dispatch"),this.use(u(this)),this._usedRouter=!1,this._router=new o(this),this.routes=this._router.map,this._router.caseSensitive=this.enabled("case sensitive routing"),this._router.strict=this.enabled("strict routing"),this.locals=m(this),this.locals.settings=this.settings,this.configure("development",function(){this.set("env","development")}),this.configure("production",function(){this.enable("view cache")})},T.use=function(e,t){return"string"!=typeof e&&(t=e,e=C),C!==e&&C===e[e.length-1]&&(e=e.slice(0,-1)),this.stack.push({route:e,handle:t}),this},T.engine=function(e,t){if("function"!=typeof t)throw Error("callback function required");return"."!==e[0]&&(e="."+e),this.engines[e]=t,this},T.set=function(e,t){return 1!==arguments.length?(this.settings[e]=t,this):this.settings.hasOwnProperty(e)?this.settings[e]:void 0},T.enabled=function(e){return!!this.set(e)},T.disabled=function(e){return!this.set(e)},T.enable=function(e){return this.set(e,!0)},T.disable=function(e){return this.set(e,!1)},T.configure=function(e,t){var i="all",n=[].slice.call(arguments);return t=n.pop(),n.length&&(i=n),("all"===i||~h(i,this.settings.env))&&t.call(this),this},T.render=function(e,t,i){var n,r={},a=this.cache;if(this.engine,"function"==typeof t&&(i=t,t={}),g(r,this.locals),t.locals&&g(r,t.locals),g(r,t),r.cache=null===r.cache?this.enabled("view cache"):r.cache,r.cache&&(n=a[e]),!n){if(n=new c(e,{engine:this.set("view engine"),root:this.set("views")},this.set("timestamp")),!n.path){var s=Error('Failed to lookup view "'+e+'"');return s.view=n,i(s)}r.cache&&(a[e]=n)}try{n.render(r,i)}catch(s){i(s)}},T.path=function(){return this.route},T.param=function(e,t){var i,n=[].slice.call(arguments,1),r=0;if($(e))for(i=e.length;i>r;++r)for(var a=0,s=n.length;s>a;++a)this.param(e[r],n[a]);else if("function"==typeof e)this._router.param(e);else for(":"===e[0]&&(e=e.substr(1)),i=n.length;i>r;++r)this._router.param(e,t);return this},T.initRouter=function(){this._usedRouter===!1&&(this._usedRouter=!0,this.use(this._router.middleware))},T.get=function(){var e=[].slice.call(arguments);return this.initRouter(),this._router.route.apply(this._router,e)},T.handle=function(e,t){function i(o){var l,c=n[s++];if(a&&(e.url=e.url.substr(1),a=!1),e.url=r+e.url,c)try{if(l=e.url,0!==l.indexOf(c.route))return i(o);var u=c.handle.length;r=c.route,e.url=e.url.substr(r.length),"/"!==e.url[0]&&(e.url="/"+e.url,a=!0),o?4===u?c.handle(o,e,t,i):i(o):4>u?c.handle(e,t,i):i()}catch(d){i(d)}}var n=this.stack,r="",a=!1,s=0;i()},T.run=function(e){this.emit("launch"),e=e||{};var t=this.request,i=this.response;this.running||(this.running=!0,!1===e.dispatch&&this.disable("dispatch"),!1!==e.popstate&&(this.historySupport?b(window).on("popstate",w(this.change,this)):b(window).on("hashchange",w(this.change,this))),this.disabled("dispatch")||(this.handle(t,i),this.emit("launched")))},T.change=function(e){if(E)return E=!1;var t=this,i=t.request,n=t.response,r=i.url;return i.updateUrl(),"/"===r||r!==i.url?(t.handle(i,n),e.stopPropagation(),e.preventDefault(),!1):void 0},T.error=function(e,t){var i=Error(t);return i.status=e,i},T=a.prototype,T.updateUrl=function(){this.host=x.hostname,this.port=x.port||80,this.fullpath=x.pathname,this.enableFullUrlPath&&(this.path=this.fullpath),this.hash=decodeURIComponent(x.hash),this.querystring=decodeURIComponent(x.search),this.url=this.path+this.querystring+this.hash},T.param=function(e,t){var i=this.params||{},n=this.query||{};return null!=i[e]&&i.hasOwnProperty(e)?i[e]:null!=n[e]?n[e]:t},T.getPath=function(){return this.path},T.getHost=function(){return this.host},T=s.prototype,T.location=function(e){window.setTimeout(function(){x.href=e},16)},T.redirect=function(e){var t,i;return arguments.length,e=arguments[0],"back"===e||"forward"===e?(k[e](),void 0):y?(t=arguments[1],i=arguments[2]||{},this.path=e,this.title=t||"EXFE.COM",document.title=this.title,this.state=i,this.state.id=d(),this.pushState(),b(window).triggerHandler("popstate"),void 0):(this.location(e),void 0)},T.save=function(){k.replaceState(this.state,this.title,this.path)},T.pushState=function(){k.pushState(this.state,this.title,this.path)},T.render=function(e,t,i){var n=this,t=t||{},r=this.app;"function"==typeof t&&(i=t,t={}),t.locals=n.locals,r.render(e,t,i)},T=o.prototype,T.param=function(e,t){if("function"==typeof e)return this._params.push(e),void 0;var i,n,r=this._params,a=r.length;for(n=0;a>n;++n)(i=r[n](e,t))&&(t=i);if("function"!=typeof t)throw Error("invalid param() call for "+e+", got "+t);return(this.params[e]=this.params[e]||[]).push(t),this},T._dispatch=function(e,t,i){var n=this.params,r=this;(function a(s,o){function l(t){a(e._route_index+1,t)}function c(t){v=0,g=m[s++],p=g&&e.params[g.name],h=g&&n[g.name];try{"route"===t?l():t?(s=0,d(t)):h&&void 0!==p?u():g?c():(s=0,d())}catch(t){c(t)}}function u(i){var n=h[v++];return i||!n?c(i):(n(e,t,u,p,g.name),void 0)}function d(i){var n=f.callbacks[s++];try{if("route"===i)l();else if(i&&n){if(4>n.length)return d(i);n(i,e,t,d)}else n?n(e,t,d):l(i)}catch(i){d(i)}}var h,p,f,m,g,v=0;return e.route=f=r.matchRequest(e,s),f?(e.params=f.params,m=f.keys,s=0,c(o),void 0):i(o)})(0)},T.matchRequest=function(e,t){var i,n=e.url,r=this.map,a=r.length;for(t=t||0;a>t;++t)if(i=r[t],i.match(n))return e._route_index=t,i},T.route=function(e){e||Error("Router#get() requires a path");var t=[].slice.call(arguments,1),i=new l(e,t,{sensitive:this.caseSensitive,strict:this.strict});return(this.map=this.map||[]).push(i),this},T=l.prototype,T.match=function(e){this.regexp.lastIndex=0;var t,i,n,r,a=this.keys,s=this.params=[],o=this.regexp.exec(e);if(!o)return!1;for(t=1,i=o.length;i>t;++t)n=a[t-1],r="string"==typeof o[t]?decodeURIComponent(o[t]):o[t],n?s[n.name]=r:s.push(r);return!0},T=c.prototype,T.lookup=function(e){return this.root+"/"+e+"?t="+this.timestamp},T.render=function(e,t){return p(this.engine,this.path,e,t,this.ext)},d.id=0;var $=Array.isArray;$||($=function(e){return e instanceof Array})}),define("live",function(e){"use strict";function t(){navigator.geolocation.clearWatch(M)}function i(){M=navigator.geolocation.watchPosition(function(e){e&&e.coords&&e.coords.latitude&&e.coords.longitude&&e.coords.accuracy&&(h.latitude=""+e.coords.latitude,h.longitude=""+e.coords.longitude,h.accuracy=""+e.coords.accuracy,l=o-5,v("Location update: lat = "+h.latitude+", "+"lng = "+h.longitude+", "+"acu = "+h.accuracy))})}var n=window._ENV_,r=n.streaming_api_url,a=n.api_url;e("store");var s="",o=30,l=o,c=!1,u=null,d="",h={card:{id:"",name:"",avatar:"",bio:"",identities:[],timestamp:0},latitude:"",longitude:"",accuracy:"",traits:[]},p=Date.now||function(){return(new Date).getTime()},r=r,f=null,m=null,g=null,v=function(e,t){if(c){var i=Object.prototype.toString.call(e),n=""+new Date;"[object String]"!==i&&"[object Number]"!==i&&(e=JSON.stringify(e)),console.log(n.replace(/^.*(\d{2}:\d{2}:\d{2}).*$/,"$1")+" - "+e),t&&console.table&&console.table(t)}},y=function(){l=0,v("Breathe with"+(s?" token: "+s:"out token")),f&&f.abort(),f=$.ajax({type:"post",url:r+"/v3/live/cards"+(s?"?token="+s:""),data:JSON.stringify(h),success:function(e){var t=e;t&&t.length&&(l=0,s!==t[0]&&(v("Got new token: "+t[0]+", id: "+t[1]),x.live&&(x.kill(),v("Close current stream")),l=o),s=t[0],h.card.id=t[1])},error:function(e){e.status&&e.status>=400&&499>=e.status?(s&&v("Repeal token: "+s),s="",l=o):(l=o-5,v("Network error"))}}),!x.live&&s&&(x.init(r+"/v3/live/streaming?token="+s,_,b),v("Streaming with token: "+s))},_=function(e){if(e&&e.length){var t=JSON.parse(e[e.length-1]);if(t&&t.length){var i={};for(var n in t)t[n].id&&(t[n].id===h.card.id?(h.card.name=t[n].name,h.card.avatar=t[n].avatar,h.card.bio=t[n].bio,h.card.identities=t[n].identities,h.card.timestamp=t[n].timestamp):(t[n].avatar||(t[n].avatar=encodeURI(a+"/avatar/default?name="+t[n].name)),i[t[n].id]=t[n]));var r={me:T(h.card),others:i},s=JSON.stringify(r);v("Streaming pops: "+s,i),u&&d!==s&&(v("Callback"),u(r),d=s)}else v("Data error")}},b=function(){v("Streaming is dead")},w=function(){E(h.card)&&++l>=o&&y()},x={prvLen:null,nxtIdx:null,timer:null,http:null,pop:null,dead:null,live:!1,init:function(e,t,i){this.prvLen=0,this.nxtIdx=0,this.live=!0,this.pop=t,this.dead=i,this.http=new XMLHttpRequest,this.http.open("post",e),this.http.onreadystatechange=this.listen,this.http.send(),this.timer=setInterval(this.listen,1e3)},listen:function(){if(!(4!==x.http.readyState&&3!==x.http.readyState||3===x.http.readyState&&200!==x.http.status||null===x.http.responseText)){for(4===x.http.readyState&&200!==x.http.status&&x.kill();x.prvLen!==x.http.responseText.length&&(4!==x.http.readyState||x.prvLen!==x.http.responseText.length);){x.prvLen=x.http.responseText.length;var e=x.http.responseText.substring(x.nxtIdx),t=e.split("\n");x.nxtIdx+=e.lastIndexOf("\n")+1,"\n"===e[e.length-1]&&t[t.length]||t.pop(),x.pop&&x.pop(t)}4===x.http.readyState&&x.prvLen===x.http.responseText.length&&x.kill()}},kill:function(){clearInterval(this.timer),this.http&&this.http.abort(),this.dead&&this.dead(),this.live=!1}},k=function(){if(void 0===window.DeviceMotionEvent)return null;var e=50,t=0,i=0,n=0,r=0,a=0,s=0;window.addEventListener("devicemotion",function(e){t=e.accelerationIncludingGravity.x,i=e.accelerationIncludingGravity.y,n=e.accelerationIncludingGravity.z},!1),setInterval(function(){var o=Math.abs(t-r+i-a+n-s);o>e&&(m&&m(),g&&setTimeout(g,1e3)),r=t,a=i,s=n},100)},C=function(e){return e&&e.external_username&&e.provider?!0:!1},E=function(e){if(e&&e.name&&e.identities&&e.identities.length){for(var t in e.identities)if(C(e.identities[t])===!1)return!1;return!0}},T=function(e){switch(Object.prototype.toString.call(e)){case"[object Object]":var t={};for(var i in e)t[i]=T(e[i]);break;case"[object Array]":t=[];for(i in e)t.push(T(e[i]));break;default:t=e}return t},S={init:function(e,t){E(e)?(x.kill(),h.card.name=e.name,h.card.avatar=e.avatar,h.card.bio=e.bio,h.card.identities=T(e.identities),h.card.timestamp=p(),v("Set my card: "+JSON.stringify(h.card))):v("Card error"),t&&(u=t,v("Set callback function")),l=o},shake:function(e,t){m=e,g=t},startGeo:i,stopGeo:t};setInterval(w,1e3),k(m,g);var M;return window.addEventListener("load",function(){setTimeout(function(){window.scrollTo(0,0)},0)}),S}),define("mobilemiddleware",function(e,t,i){"use strict";var n=function(){var e=document.getElementsByTagName("head")[0],t=document.getElementsByName("sms-token")[0],i=null;return t&&(i=JSON.parse(t.content),e.removeChild(t)),i},r=navigator.userAgent.match(/iPhone/);i.exports={setHtmlHeight:function(e,t,i){setTimeout(function(){window.scrollTo(0,0)},0),r||$("#app-main").addClass("app-box");var n=document.documentElement,a=window.innerHeight,s=e.app;a>=444?a=508:356>=a&&(a=420),s.screen={width:320,height:a,ios:420>=a?"iphone4":""},n.style.minHeight=a+"px",i()},checkStorageSupported:function(e,t,i){try{var n=window.localStorage;n&&(n.setItem("storage",0),n.removeItem("storage"))}catch(r){alert("EXFE cannot be used in private browsing mode.")}i()},checkSMSToken:function(e,t,i){var r=n();if(r){var a=r.action;return e.resolveToken=r,"VERIFIED"===a?t.redirect("/#verify"):"INPUT_NEW_PASSWORD"===a&&t.redirect("/#set_password"),void 0}i()},cleanup:function(e,t,i){delete e.smsToken,$("#app-body").css("height","auto"),$("#app-header").addClass("hide"),$("#app-footer").removeClass("ft-bg");var n=e.switchPageCallback;n?n():$("#app-body .page").addClass("hide"),delete e.switchPageCallback,i()},errorHandler:function(e,t){e.error={code:404},t.redirect("/")}}}),define("mobilecontroller",function(e,t,i){"use strict";var n=e("base"),r=e("store"),a=e("tween"),s=window._ENV_.api_url,o=e("handlebars"),l=e("util"),c=l.trim,u=l.parseId,d=navigator.userAgent.match(/iPad/),h=e("live"),p=function(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},f=Date.now||function(){return(new Date).getTime()},m=function(){window.location="itms://itunes.apple.com/us/app/exfe/id514026604"},g=function(e){App.set("tryRedirectAt",f()),window.location="exfe://crosses/"+(e||"")},v="webkitTransform"in document.body.style,y=function(e,t){var i=6===t.length?"":"3d";e.style[v?"webkitTransform":"transform"]="matrix"+i+"("+t.join(",")+")"},_=function(){var e=r.get("livecard");if(!e){var t={id:"",name:"",avatar:"",bio:"",identities:[]};e={card:t,latitude:"",longitude:"",accuracy:"",traits:[]};var i=r.get("user");i&&(t.name=i.name,t.avatar=i.avatar_filename,t.bio=i.bio,t.identities=i.identities),r.set("livecard",e)}return e.card.id="",e},b=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],w=[1,0,0,0,0,1,0,0,0,0,1,0,128,28,0,1],x=[1,0,0,0,0,1,0,0,0,0,1,0,128,0,0,1],k=0,C=function(){return"Controller-"+k++};t=i.exports={};var E=n.extend({initialize:function(e){this.cid=C(),this.initOptions(e),this.parseElement(),this.init(),E.caches[this.cid]=this},parseElement:function(){var e=this.element,t=this.options.template;if(e?this.element=e instanceof $?e:$(e):t&&(this.element=$(t)),!this.element)throw"element is invalid";this.element.attr("data-page-id",this.cid)},initOptions:function(e){this.setOptions(e);for(var t in e)"options"!==t&&(this[t]=e[t])},init:function(){},destory:function(){this.element.off(),this._destory()},_destory:function(){delete E.caches[this.cid],E.superclass.destory.call(this)},$:function(e){return this.element.find(e)}});E.caches=[],t.FooterController=E.extend({countDown:5,element:$("#app-footer"),init:function(){this.listen()},enableTimer:!0,listen:function(){var e=this,t=e.element;t.on("click.footer",".redirecting, .web-version",function(){window.location.href="/?ipad"+location.hash}).on("click.footer",".get-button button",function(){m()}).on("keydown.footer","#email",function(t){if(13===t.keyCode){var i=e.$("#email").val();e.addNotificationIdentity(i)
}}).on("click.footer",".subscribe .btn_mail",function(){var t=c(e.$("#email").val());e.addNotificationIdentity(t)}),this.on("show",function(e,t,i,n){var r=e.height-96-(t?60:0);this.element.removeClass("hide"),this.element.css({position:"relative",top:r+"px"}),this.enableTimer&&this.emit("start-redirect"),d&&this.$(".web-version").removeClass("hide"),this.$(".error-info").toggleClass("hide",!n)}),this.on("reset-position",function(){var e=App.screen.height-96;this.element.removeClass("hide"),this.element.css({position:"absolute",top:e+"px"}),d&&this.$(".web-version").removeClass("hide")}),this.on("show-from-cross",function(e,t,i,n){this.element.css({position:"relative",top:0}),this.emit("stop-redirect"),this.element.addClass("ft-bg"),this.cross={exfee_id:e,token:t},this.$(".actions").addClass("action-cross"),this.$(".action").addClass("hide"),i&&this.$(".subscribe").removeClass("hide"),this.element.removeClass("hide"),$("#app-footer").addClass("ft-bg"),n&&this.enableTimer?this.emit("start-redirect",n):(this.$(".get-button").removeClass("hide"),$(".redirect").addClass("hide")),d&&this.$(".web-version").removeClass("hide")}),this.on("show-from-resolve-token",function(){this.emit("stop-redirect"),1>this.countDown?($(".redirecting").removeClass("hide"),g()):this.emit("start-redirect")}),this.on("start-redirect",function(t){this.$(".get-button").addClass("hide");var i,n=$(".redirecting").removeClass("hide"),r=n.find(".sec"),a=e.countDown;r.text(i=a),this.App.set("redirectTimer",setInterval(function(){e.countDown=i-=1,i>=1?r.text(i):(n.addClass("hide"),e.emit("stop-redirect"),g(t))},1e3))}),this.on("stop-redirect",function(){this.enableTimer=!1,this.$(".get-button").removeClass("hide"),$(".redirecting").addClass("hide"),this.App.set("redirectTimer",clearInterval(this.App.set("redirectTimer")))})},addNotificationIdentity:function(e,t,i){t=this.cross.exfee_id,i=this.cross.token;var n=u(e);return n&&"email"!==n.provider?($("#email.email").attr("placeholder","Bad email Address."),void 0):($.ajax({type:"POST",url:s+"/Exfee/"+t+"/AddNotificationIdentity"+"?token="+i,data:{provider:n.provider,external_username:n.external_username},success:function(e){e&&e.meta&&200===e.meta.code&&$(".subscribe").hide()},error:function(){alert("Failed, please retry later.")}}),void 0)}}),t.VerifyController=E.extend({init:function(){this.render(),this.listen()},render:function(){$("#app-verify").length||this.element.appendTo($("#app-body"))},listen:function(){var e=this,t=this.resolveToken;this.on("show",function(i,n){setTimeout(function(){window.scrollTo(0,0)},14);var r=function(){i.error=!0,n.redirect("/")};this.element.removeClass("hide"),$("#app-body").css("height","100%"),App.controllers.footer.emit("reset-position"),$.ajax({type:"POST",url:s+"/Users/"+t.user_id+"?token="+t.token,data:{token:t.token},success:function(i){var n=i.meta;if(n&&200===n.code)for(var a=i.response.user,s=a.identities,o=0,l=s.length;l>o;++o){var c=s[o];if(c.id===t.identity_id){e.showIdentity(c),e.$(".done-info").removeClass("hide"),App.controllers.footer.emit("show-from-resolve-token");break}}else r()},error:function(){r()}})})},showIdentity:function(e){var t=this.$(".identity");t.find(".name").text(e.name),t.find(".avatar").attr("src",e.avatar_filename)}}),t.SetPasswordController=E.extend({init:function(){this.render(),this.listen()},render:function(){$("#app-setpassword").length||this.element.appendTo($("#app-body"))},submitPassword:function(){var e=this,t=this.token,i=this.$(".set-button button"),n=this.$(".error-info"),r=this.$("#name"),a=this.$("#password"),o=a.val();o.length>=4?(i.addClass("disabled").prop("disabled",!0),$.ajax({type:"POST",url:s+"/Users/ResetPassword",data:{token:t,name:name,password:o},success:function(t){var s=t.meta;s&&200===s.code?(r.blur(),a.blur(),e.$(".done-info").removeClass("hide"),n.html("").addClass("hide"),i.parent().addClass("hide"),App.controllers.footer.emit("show-from-resolve-token")):i.removeClass("disabled").prop("disabled",!0),i.removeClass("disabled").prop("disabled",!0)},error:function(){n.html("Failed to set password. Please try later.").removeClass("hide"),i.removeClass("disabled").prop("disabled",!1)}})):n.html("Password must be longer than four!").removeClass("hide")},listen:function(){var e,t,i=this,n=this.element,r=this.resolveToken;n.on("touchstart.setpassword",".pass",function(){t&&(clearTimeout(t),t=void 0),e=f();var i=$(this).prev();i.prop("type","password")}).on("touchend.setpassword",".pass",function(i){if(f()-e>300){var n=$(this).prev();n.prop("type","text"),t=setTimeout(function(){n.prop("type","password")},500)}return i.preventDefault(),i.stopPropagation(),!1}).on("keydown.setpassword","#password",function(e){13===e.keyCode?i.submitPassword():i.$(".error-info").html("")}).on("touchstart.setpassword",".set-button button",function(){i.submitPassword()}),this.on("show",function(e,t){setTimeout(function(){window.scrollTo(0,0)},0);var i=function(){e.error=!0,t.redirect("/")};n.removeClass("hide"),$("#app-body").css("height","100%"),$.ajax({type:"POST",url:s+"/Users/"+r.user_id+"?token="+r.token,data:{token:r.token},success:function(e){var t=e.response.user;return e&&e.meta&&200===e.meta.code?($(".identity .avatar").attr("src",t.avatar_filename),$(".identity .name").html(t.name),void 0):(i(),void 0)},error:function(){i()}}),App.controllers.footer.emit("reset-position")})}}),t.HomeController=E.extend({init:function(){this.render(),this.listen()},render:function(){$("#app-home").length||this.element.appendTo($("#app-body"))},listen:function(){var e=this,t=this.element;t.on("touchstart.home","#home-card",function(){clearInterval(App.set("tryTimer")),App.set("tryTimer",void 0),e.stopAnimate(),e.emit("goto-live")}),this.on("goto-live",function(){App.controllers.footer.emit("stop-redirect"),App.request.switchPageCallback=function(){t.addClass("hide")},App.response.redirect("/#live")}),this.on("show",function(e,i){var n=e.height;this.$(".logo-box .inner").css("top",(n-300)/2+"px"),t.removeClass("hide"),x[13]=(n-64)/2,this.setHomeCard(x),i=!(!i||404!==i.code);var r=this.$(".title");r.find(".normal").removeClass("hide"),i&&setTimeout(function(){alert("Sorry. Your link is invalid or expired. Requested page was not found.")},14),this.$("#home-card").css("display","none")})},setHomeCard:function(e){var t=_(),i=t.card,n=i.name,r=i.avatar,a=this.$("#home-card");y(a[0],e),i&&(n||r)?(r||(r=n?s+"/avatar/default?name="+n:"/static/img/portrait_default.png"),r="url("+r+")"):r="",a.find(".avatar").css("background-image",r)},aopts:{o:1},createAnimate:function(){var e=this.aopts,t=document.getElementById("big-logo"),i=document.getElementById("home-card"),n=function(){t.style.opacity=e.o,i.style.opacity=1-e.o};this._a=new a.Tween(e).delay(1377).to({o:0},1377).easing(a.Easing.Cubic.InOut).onUpdate(n),this._b=new a.Tween(e).delay(1377).to({o:1},1377).easing(a.Easing.Cubic.InOut).onUpdate(n)},startAnimate:function(){this._a||this._b||this.createAnimate(),this._a.chain(this._b),this._b.chain(this._a),this._a.start()},stopAnimate:function(){var e=this.aopts,t=document.getElementById("big-logo"),i=document.getElementById("home-card");this._a.chain(),this._b.chain(),this._b.stop(),this._a.stop(),e.o=t.style.opacity=1,i.style.opacity=0}}),t.CrossController=E.extend({init:function(){this.render(),this.listen()},render:function(){$("#app-cross").length||this.element.appendTo($("#app-body")),$("#app-cross").removeClass("hide")},listen:function(){var e=this,t=this.element,i=this.token,n=this.cross,r=e.$(".rsvp_toolbar");t.on("touchstart.cross",".portrait.me",function(){r.toggleClass("rsvp_toolbar_off",!r.hasClass("rsvp_toolbar_off"))}).on("touchstart.cross",".changename",function(){var t=prompt("Change my display name:");t?$.ajax({type:"POST",url:s+"/Identities/"+n.identity.id+"/Update"+"?token="+i,data:{name:t},success:function(t){t&&t.meta&&200===t.meta.code&&e.$(".name_me").html(p(t.response.identity.name))},error:function(){alert("Failed, please retry later.")}}):alert("Display name cannot be empty.")}).on("touchstart.cross",".rsvp.accepted, .rsvp.unavailable",function(){var t=$(this).hasClass("accepted")?"ACCEPTED":"DECLINED";e.rsvp(t)}).on("touchstart.cross",".inf_area .description",function(){var e=$(this),t=e.hasClass("clickable");if(t){var i=e.hasClass("limit");e.toggleClass("limit",!i),e.find(".xbtn-more .rb").toggleClass("hidden",i),e.find(".xbtn-more .lt").toggleClass("hidden",!i)}}),this.on("show",function(){t.removeClass("hide");var e=this.$(".inf_area .description");e.height()>130&&(e.addClass("limit clickable"),e.find(".xbtn-more").removeClass("hide"),e.find(".xbtn-more .rb").removeClass("hidden"))})},rsvp:function(e){var t=this.cross.identity.id,i=this.exfee_id,n=this.token,r=[{rsvp_status:e,identity_id:t,by_identity_id:t}];this.$(".rsvp_toolbar").addClass("rsvp_toolbar_off");var a=this.$(".portrait_rsvp_me").removeClass("accepted declined pending");switch(e){case"ACCEPTED":a.addClass("accepted");break;case"DECLINED":a.addClass("declined");break;default:a.addClass("pending")}$.ajax({type:"post",url:s+"/Exfee/"+i+"/Rsvp?token="+n,data:{rsvp:JSON.stringify(r)},success:function(){},error:function(){alert("RSVP failed!")}})}}),t.LiveController=E.extend({init:function(){this.render(),this.listen()},render:function(){$("#app-live").length?this.element=$("#app-live"):this.element.appendTo($("#app-body"))},listen:function(){var e,t,i=this,n=this.element;n.on("touchstart.live","#card-name",function(e){e.stopPropagation(),setTimeout(function(){window.scrollTo(0,0)},0),this.focus()}).on("touchend.live",".live-form",function(e){e.stopPropagation(),$(e.target).hasClass("live-form")&&(n.find(".input-item").blur(),App.response.redirect("/"))}).on("keydown.live","#card-name",function(e){var t=e.keyCode,n=c(this.value);n&&13===t&&i.addEmailOrPhone(this,n)}).on("blur.live","#card-name",function(){var e=c(this.value);e?i.addEmailOrPhone(this,e):i.setCardName(this)}).on("keydown.live blur.live","#add-identity",function(e){var t=e.keyCode,n=c(this.value);(n&&13===t||"blur"===e.type)&&(i.addEmailOrPhone(this,n,!0),this.value="")}).on("keydown.live blur.live","#facebook-identity",function(e){var t=e.keyCode,n=c(this.value);(n&&13===t||"blur"===e.type)&&(n+="@facebook",i.addFacebook(this,n)&&$("#add-identity-facebook").addClass("hide"),this.value="")}).on("touchstart.live",".list .input-item",function(){$(this).next().removeClass("hidden")}).on("blur.live",".list .input-item",function(){$(this).next().addClass("hidden"),i.updateIdentityLi(this)}).on("touchstart.live",".list .delete",function(){var e,t=$(this).prev()[0],n=c(t.value),r=t.getAttribute("data-provider"),a="facebook"===r;a&&(n+="@facebook"),e=u(n),$(this).parent().remove(),e&&e.provider&&i.removeIdentity(e),a&&i.emit("show-add-facebook")}).on("touchstart.live",".btn-start",function(){var e=$(".list .input-item");e.each(function(){i.updateIdentityLi(this)});var t=document.getElementById("card-name");t.blur();var n=c(t.value);n?i.liveCard.card.name=n:i.setCardName(t),setTimeout(function(){i.inspectFields()&&(i.emit("post-card"),i.emit("live-gather"))},23)}).on("hold:live",".live-gather .card .avatar",function(){var e=this,t=e.parentNode,i=$(t).data("card"),n=t.style.transform||t.style.webkitTransform,r=n.match(/([\-\d\.]+)/g).slice(1),a=document.getElementById("card-tip"),s="";if(i&&i.identities){for(var o=0,l=i.identities.length;l>o;++o){var c=i.identities[o],u=c.provider,d=c.external_username,h="";"email"!==u&&"phone"!==u&&(u=u.substr(0,1).toUpperCase()+u.substr(1),h='<span class="provider">'+u+"</span>"),s+='<li><span class="external-username'+(h?"":" normal")+'">'+d+"</span>"+h+"</li>"}a.querySelector("ul").innerHTML=s;var p=a.clientHeight,f=~~r[12]-68,m=~~r[13]-(6+p),g=93;0>f?f=10:f+200>=320&&(f=110),(10===f||110===f)&&(g=~~r[12]+32-7-f),r[12]=f,r[13]=m-5,r[14]=7,y(a,r),a.querySelector(".ang").style.left=g+"px",a.querySelector(".bio").innerText=i.bio,a.className="card-tip"}}).on("touchstart.live",".live-gather .card .avatar",function(i){var n=$(this),r=250,a=i.touches.length;t=f(),e&&(clearTimeout(e),e=void 0),1===a&&a>=1&&(e=setTimeout(function(){n.trigger("hold:live")},r))}).on("touchend.live",".live-gather .card .avatar",function(){if(e&&(clearTimeout(e),e=void 0),250>f()-t){var i=$(this).parent();i.hasClass("card-me")||i.toggleClass("selected")}document.getElementById("card-tip").className="card-tip hidden"}).on("touchstart.live",".back",function(){i.$(".live-gather").addClass("hide"),App.response.redirect("/")}).on("touchstart.live",".live-gather",function(e){var t=e.target,i=$(".live-title h2"),n=i[0],r=i.hasClass("clicked");r&&($(".wave").css("opacity",1),i.data("clicked",t===n||$.contains(n,t)).removeClass("clicked"),$(".live-tip").addClass("live-tip-close"))}).on("touchstart.live",".live-title h2",function(){var e=$(this),t=e.hasClass("clicked"),i=e.data("clicked");t||i||($(this).addClass("clicked"),$(".wave").css("opacity",0),$(".live-tip").removeClass("live-tip-close")),e.data("clicked",!1)}).on("touchstart.live",".btn-confirm",function(){i.postContacts()}),this.on("show-add-email",function(){this.$("#add-identity").removeClass("hide")}),this.on("show-add-facebook",function(){this.$('.list input[data-provider="facebook"]').length||this.$("#add-identity-facebook").removeClass("hide")}),this.on("show",function(e){h.startGeo(),this.screen=e,$("#app-footer").addClass("hide"),this.element.removeClass("hide");var t=e.height;x[13]=(t-64)/2,y(this.$("#icard")[0],x),this.$(".live-form, .live-gahter").css("min-height",t),this.$(".live-form").removeClass("hide"),this.$("#live-discover").css("opacity",0),this.$("#card-form").css({opacity:0,"min-height":100*((t-100)/t)+"%"}),this.measurePositions(e.width,e.height-10,32,32),this.MAPS=this._MAPS.slice(0),this.$(".identities .list").empty(),this.liveCard=_(),this.updateMyCardForm(),this.startAnimate()}),this.on("post-card",function(){this.postMyCard()}),this.on("disabled-live-btn",function(e){this.$(".btn-start").toggleClass("disabled",e)}),this.on("live-gather",function(){this.$(".live-form").addClass("hide"),this.$(".live-gather").removeClass("hide"),this.$(".wave").addClass("start"),this.$(".live-gather").find(".card").remove();var e=this.liveCard.card,t=this.genCard(e,this.coords[0][0],0,0,!0,this.screen.ios).appendTo(this.$(".live-gather"));this.updateCard(t[0],e),this._others&&this.updateOthers()})},updateIdentityLi:function(e){var t,i=e.getAttribute("data-external-username"),n=e.getAttribute("data-provider"),r=e.getAttribute("data-name"),a="",s=c(e.value),o=!1,l=!1,d=!1;if(s)if("facebook"===n&&(s+="@facebook"),t=u(s),t&&t.provider){var h=this.findIdentity(t),p=t.provider===n&&t.external_username===i;h&&!p&&(e.value=a),h||p||(d=!0,o=!0)}else l=!0,o=!0;else l=!0,o=!0;l&&(e.setAttribute("data-name",a),e.setAttribute("data-external-username",a),e.setAttribute("data-provider",a),setTimeout(function(){alert("Invalid contact.")},14)),d&&(e.setAttribute("data-name",t.name),e.setAttribute("data-external-username",t.external_username),e.setAttribute("data-provider",t.provider),e.value=t.external_username,$(e).prev().text(this.aliasProvider(t.provider)),this.updateLiveCard(t,"+")),o&&this.updateLiveCard({name:r,external_username:i,provider:n},"-",!0),(o||d)&&this.emit("post-card")},postContacts:function(){},inspectFields:function(){var e=this.liveCard.card;return e.name&&e.identities.length},updateCardName:function(e){e.name&&(this.liveCard.card.name=document.getElementById("card-name").value=e.name,r.set("livecard",this.liveCard))},updateMe:function(e){var t,i=document.getElementById("icard"),n=i.getAttribute("data-url");n!==e.avatar&&(t=e.avatar,t||(t=e.name?s+"/avatar/default?name="+e.name:"/static/img/portrait_default.png"),n!==t&&(i.querySelector(".avatar").style.backgroundImage="url("+t+")",i.setAttribute("data-url",t)));var r=document.getElementById("card-bio");e.bio&&(r.innerText=e.bio),r.className=e.bio?"":"hide"},postMyCard:function(){r.set("livecard",this.liveCard);var e=this.liveCard.card;e.name&&e.identities.length&&h.init(e,$.proxy(this.liveCallback,this))},state:1,liveCallback:function(e){var t=this.liveCard,i=e.me;1===this.state&&i&&i.name&&i.identities.length&&(f()-i.timestamp>6e4&&this.updateCardName(i),this.updateMe(t.card=i),r.set("livecard",t)),this._others=e.others,this.updateOthers()},updateMyCardForm:function(){var e,t=this.liveCard,i=t.card,n=i.identities;if(n&&(e=n.length)){this.updateCardName(i),this.updateMe(i),this.postMyCard(),n=n.slice(0);for(var r,a;r=n.shift();)a=r.provider,("email"===a||"phone"===a||"facebook"===a)&&this.addIdentity(r,!0);this.emit("show-add-email"),this.emit("show-add-facebook")}else this.emit("disabled-live-btn",!0)},resetLiveCard:function(){this.emit("disabled-live-btn",!0),r.clear("livecard"),this.liveCard=_()},findIdentity:function(e){var t=this.liveCard.card,i=t.identities,n=i.length;if(n)for(var r=0;n>r;++r){var a=i[r];if(a.provider===e.provider&&a.external_username===e.external_username)return!0}return!1},updateLiveCard:function(e,t,i){var n=this.liveCard.card,a=n.identities;if("+"===t)a.push(e);else{for(var s=0,o=a.length;o>s;++s){var l=a[s];if(l.provider===e.provider&&l.external_username===e.external_username){a.splice(s,1);break}}i||0!==a.length||this.resetLiveCard()}r.set("livecard",this.liveCard)},setCardName:function(e){var t=this.packedIdentities();if(t.length){var i=t[0],n="",r=i.external_username,a=i.provider;n="phone"===a?"Anonym_"+r.slice(r.length-4):r.split("@")[0],this.liveCard.card.name=e.value=n,e.setAttribute("placeholder","Name"),$(e).addClass("normal")}},addFacebook:function(e,t){var i=u(t),n=i.provider;return n&&"facebook"===n&&!this.existsByIdentity(i)?(this.addIdentity(i),!0):!1},addEmailOrPhone:function(e,t,i){i=!i;var n=u(t),r=n.provider;!r||"email"!==r&&"phone"!==r||this.existsByIdentity(n)||(this.addIdentity(n),i&&this.setCardName(e)),i&&(this.emit("show-add-email"),this.emit("show-add-facebook")),this.emit("post-card")},aliasProvider:function(e){return"email"===e?e="Email":"phone"===e?e="Mobile":"facebook"===e&&(e="Facebook"),e},genIdentity:function(e){var t=o.compile($("#live-li-identity-tmpl").html()),i=e.provider;i=this.aliasProvider(i);var n=$(t({provider_alias:i,identity:e}));return n},resetCard:function(){this.state=0,this.$("#icard").removeAttr("data-url").find(".avatar").css("background",""),this.$("#card-name").attr("placeholder","Your email or mobile no.").removeClass("normal").val(""),this.$("#add-identity").addClass("hide"),this.$("#add-identity-facebook").addClass("hide")},removeIdentity:function(e){var t=this.$(".identities .list li");0===t.length?(this.resetCard(),this.emit("disabled-live-btn",!0)):"facebook"===e.provider&&this.emit("show-add-facebook"),this.updateLiveCard(e,"-"),this.emit("post-card")},addIdentity:function(e,t){t=!t,this.state=1;var i=this.$(".identities .list"),n=this.genIdentity(e);i.append(n),this.emit("disabled-live-btn",!1),t&&(this.updateLiveCard(e,"+"),this.emit("post-card"))},packedIdentities:function(){for(var e,t,i,n,r,a=this.$(".identities .list").find("input"),s=0,o=a.length,l=[];o>s;++s)e=a.eq(s),t=e.attr("data-provider"),i=c(a.eq(s).val()),i&&("facebook"===t&&(i+="@facebook"),n=u(i),r=n.provider,!r||"email"!==r&&"phone"!==r&&"facebook"!==r||l.push(n));return l},existsByIdentity:function(e){var t,i=this.packedIdentities(),n=e.external_username,r=e.provider;if(0===i.length)return!1;for(;t=i.shift();)if(t.external_username===n&&t.provider===r)return!0;return!1},coords:"".split(),_MAPS:[[1,0],[1,1],[1,2],[2,0],[2,1],[2,2],[2,3],[3,0],[3,1],[3,2],[3,3]],MAPS:"".split(),measurePositions:function(e,t,i,n){var r=this.coords;r[0]=[[.5*e-i,.88*t-n]],r[1]=Array(3),r[1][0]=[.25*e-5-i,.66*t+30-n],r[1][1]=[.5*e-i,.66*t-n],r[1][2]=[.75*e+5-i,.66*t+30-n],r[2]=Array(4),r[2][0]=[.125*e+5-i,.44*t+40-n],r[2][1]=[.375*e-i,.44*t-n],r[2][2]=[.625*e-i,.44*t-n],r[2][3]=[.875*e-5-i,.44*t+40-n],r[3]=Array(4),r[3][0]=[.125*e-i,.22*t+40-n],r[3][1]=[.375*e-i,.22*t-n],r[3][2]=[.625*e-i,.22*t-n],r[3][3]=[.875*e-i,.22*t+40-n]},genCard:function(e,t,i,n,r,a){var s=o.compile($("#live-card-tmpl").html()),l=b.slice(0);l[12]=t[0],l[13]=t[1];var c=$(s({g:i,i:n,matrix:l.join(","),"class":(r?"card-me":"card-other hide")+("iphone4"===a?" card-iphone4":""),card:e}));return c.data("card",e),c},addCard:function(e){var t=this.MAPS;if(!t||0===t.length)return!1;var i=t.shift(),n=i[0],r=i[1],s=this.coords[n][r],o=this.genCard(e,s,n,r,!1,this.screen.ios),l=o[0],c=l.style,u=b.slice(0);u[0]=u[5]=0,u[12]=s[0],u[13]=s[1],o.data("card",e),this.$(".live-gather").append(o),new a.Tween({o:0}).to({o:1},250).easing(a.Easing.Bounce.In).onStart(function(){y(l,u),o.removeClass("hide")}).onUpdate(function(){c.opacity=this.o,u[0]=u[5]=this.o,y(l,u)}).onComplete(function(){a.remove(this)}).start()},delCard:function(e){var t=this.MAPS,i=e.getAttribute("data-g"),n=e.getAttribute("data-i"),r=b.slice(0),s=this.coords[i][n],o=e.style;r[12]=s[0],r[13]=s[1],new a.Tween({o:1}).to({o:0},250).easing(a.Easing.Bounce.Out).onUpdate(function(){o.opacity=this.o,y(e,r)}).onComplete(function(){t.unshift([i,n]),e.parentNode.removeChild(e),a.remove(this)}).start()},updateCard:function(e,t){var i=e.getAttribute("data-url"),n="";i&&i===t.avatar||(n=t.avatar,n||(n=t.name?s+"/avatar/default?name="+t.name:"/static/img/portrait_default.png"),i!==n&&(e.querySelector(".avatar").style.backgroundImage="url("+n+")",e.setAttribute("data-url",n))),e.querySelector(".name").innerText=t.name,$(e).data("card",t)},updateOthers:function(){for(var e,t,i,n,r=this._others,a=document.querySelectorAll(".card-other"),s=a.length,o=0;s>o;++o)e=a[o],t=e.getAttribute("id"),t in r||this.delCard(e);for(i in r)n=r[i],e=document.getElementById(n.id),e?this.updateCard(e,n):this.addCard(n)},createAnimate:function(){var e=this.$("#icard")[0],t=this.$("#card-form")[0],i=this.$("#live-discover")[0],n=x[13],r=w[13],s=x.slice(0);this.a=new a.Tween({o:0}).to({o:1},500).easing(a.Easing.Cubic.In).onUpdate(function(){i.style.opacity=this.o,s[13]=(n-r)*(1-this.o)+r,y(e,s)}),this.b=new a.Tween({o:0}).delay(250).to({o:1},500).onUpdate(function(){t.style.opacity=this.o})},startAnimate:function(){this.a||this.b||this.createAnimate(),this.a.start(),this.b.start()},stopAnimate:function(){this.a.stop(),this.b.stop()}})}),define("mobileroutes",function(e,t,i){"use strict";var n=e("store"),r=e("handlebars"),a=e("humantime"),s=window._ENV_,o=function(e){var t=a.printEFTime(e,"X");return t},l=e("mobilecontroller"),c=l.HomeController,u=l.SetPasswordController,d=l.VerifyController,h=l.CrossController,p=l.LiveController,f=function(e,t,i,a,l,c){a||(a={}),$.ajax({type:"POST",url:s.api_url+"/Crosses/GetCrossByInvitationToken",data:i,success:function(i){var s=i.meta,u=s&&s.code;if(u&&200===u){var d=i.response,p=d.cross,f={id:p.id,title:p.title,description:p.description.replace(/\r\n|\r|\n/g,"<br />"),time:{title:"Sometime",content:"To be decided"},place:{title:"Somewhere",description:"To be decided"},background:"default.jpg",read_only:!!d.read_only},m=p.time;m&&m.begin_at&&m.begin_at.timezone?f.time=o(m):f.time.tobe="tobe";var g=p.place;g&&g.title&&(f.place={title:g.title,description:g.description.replace(/\r\n|\r|\n/g,"<br />")});var v=g.lat,y=g.lng;if(v&&y){var _=window.devicePixelRatio>=2?2:1;f.place.map="https://maps.googleapis.com/maps/api/staticmap?center="+v+","+y+"&markers=icon%3a"+encodeURIComponent("http://img.exfe.com/web/map_pin_blue.png")+"%7C"+v+","+y+"&zoom=13&size=290x100&maptype=road&sensor=false&scale="+_,f.place.href="http://maps.google.com/maps?daddr="+encodeURIComponent(f.place.title)+"@"+v+","+y}else f.place.tobe="tobe";var b,w=p.widget;if(w&&(b=w.length))for(var x=0;b>x;++x)if("Background"===w[x].type){f.background=w[x].image;break}var k=0,C=0,E=d.authorization;E?(k=E.user_id,d.browsing_identity&&(C=d.browsing_identity.id)):d.browsing_identity&&d.browsing_identity.connected_user_id&&(k=d.browsing_identity.connected_user_id,C=d.browsing_identity.id),d.cross_access_token&&(c=a[l]=d.cross_access_token,n.set("cats",a));for(var T=p.exfee.invitations,S=[],M={ACCEPTED:[],INTERESTED:[],NORESPONSE:[],IGNORED:[],DECLINED:[]},I=0,N=T.length;N>I;++I){var A=T[I],P="pending",D=A.rsvp_status;"ACCEPTED"===D?P="accepted":"DECLINED"===D&&(P="declined"),A.rsvp_style=P,k&&k===A.identity.connected_user_id||C===A.identity.id?(A.is_me=!0,C=A.identity.id,C!==A.invited_by.id&&(f.inviter=A.invited_by),A.identity.isphone="phone"===A.identity.provider,f.identity=A.identity,M.ACCEPTED.unshift(A)):A.rsvp_status in M&&M[A.rsvp_status].push(A)}S=[].concat(M.ACCEPTED,M.INTERESTED,M.NORESPONSE,M.IGNORED,M.DECLINED),f.invitations=[],N=S.length;for(var O=0;N>O;)f.invitations.push(S.splice(0,5)),O+=5;N=f.invitations.length;var H=f.invitations[N-1],L=H.length;if(L&&5>L)for(;5-L++;)H.push(void 0);var z="";k&&(E?(z=f.id+"?user_id="+k+"&token="+E.token+"&identity_id="+C,c=E.token,n.set("authorization",E)):(E=n.get("authorization"),E&&E.user_id===k&&(z=f.id+"?user_id="+k+"&token="+E.token+"&identity_id="+C,c=E.token)));var R=e.app,j=R.controllers,F=j.cross;F&&F.destory();var q=r.compile($("#cross-tmpl").html());F=R.controllers.cross=new h({options:{template:q(f)},cross:f,exfee_id:p.exfee.id,token:c}),F.emit("show"),R.controllers.footer.emit("show-from-cross",p.exfee.id,c,f.identity.isphone,z)}else e.error={code:404},t.redirect("/")},error:function(){e.error={code:404},t.redirect("/")}})};i.exports={index:function(e){var t=e.error,i=e.app,n=i.controllers,r=n.home,a=n.footer,s=i.screen;r||(r=i.controllers.home=new c({options:{template:$("#home-tmpl").html()}})),document.title="EXFE - The group utility for gathering.",r.emit("show",s,t),a.emit("show",s,!1,!1,t===!0),delete e.error,i.currPageName="HOME"},verify:function(e,t){var i=e.session,n=i.resolveToken,r=e.app;if(n){$("#app-header").removeClass("hide");var a=new d({options:{template:$("#verify-tmpl").html()},resolveToken:n});a.emit("show",e,t)}else e.error=!0,t.redirect("/");r.currPageName="VERIFY"},setPassword:function(e,t){var i=e.session,n=i.resolveToken,r=e.app;if(n){$("#app-header").removeClass("hide");var a=new u({options:{template:$("#setpassword-tmpl").html()},resolveToken:n,token:n.origin_token});a.emit("show",e,t)}else e.error=!0,t.redirect("/");r.currPageName="SET_PASSWORD"},resolveToken:function(e,t){var i=e.app,n=e.params[0],r=function(e,t){e.error={code:404},t.redirect("/")};n?$.ajax({type:"POST",url:s.api_url+"/Users/ResolveToken",data:{token:n},success:function(i){if(i&&i.meta&&200===i.meta.code){var a=e.session;a.resolveToken=i.response;var s=a.resolveToken.action;"VERIFIED"===s?t.redirect("/#verify"):"INPUT_NEW_PASSWORD"===s&&(a.resolveToken.origin_token=n,t.redirect("/#set_password"))}else r(e,t)},error:function(){r(e,t)}}):r(e,t),i.currPageName="RESOLVE_TOKEN"},crossPhoneToken:function(e,t){var i,r,a=e.app,s=e.params,o=s[0],l=s[1],c=n.get("cats");i={invitation_token:l,cross_id:o},c&&(r=c[l])&&(i.cross_access_token=r),f(e,t,i,c,l,r),a.currPageName="CROSS"},crossToken:function(e,t){var i,r=e.app,a=e.params[0],s=n.get("cats"),o={invitation_token:a};s&&(i=s[a])&&(o.cross_access_token=i),f(e,t,o,s,a,i),r.currPageName="CROSS"},live:function(e){var t=e.app,i=t.controllers,n=i.live;n&&n.destory(),n=t.controllers.live=new p({options:{template:$("#live-tmpl").html()}}),n.emit("show",t.screen,t.ios),t.currPageName="LIVE"}}}),define(function(e){"use strict";var t=e("zepto"),i=e("tween"),n=e("af"),r=n.request,a=e("mobilemiddleware"),s=e("mobilecontroller").FooterController,o=e("mobileroutes"),l=Date.now||function(){return(new Date).getTime()},c=l(),u=function(e){App.set("tryRedirectAt",l()),window.location="exfe://crosses/"+(e||"")},d=e("lightsaber"),h=window.App=d();h.use(a.setHtmlHeight),h.use(a.cleanup),h.initRouter(),h.use(a.errorHandler),h.controllers={},h.controllers.footer=new s({App:h}),h.get(/^\/+(?:\?)?#{0,}$/,o.index),h.get(/^\/+(?:\?)?#live\/?$/,o.live),h.get(/^\/+\?t=([a-zA-Z0-9]{3,})$/,function(e,t){var i=function(){var e,t=document.getElementsByTagName("head")[0],i=document.getElementsByName("sms-token")[0];return i&&(e=JSON.parse(i.content),t.removeChild(i)),e},n=i();if(n){var r=n.action;e.session.resolveToken=n,"VERIFIED"===r?t.redirect("/#verify"):"INPUT_NEW_PASSWORD"===r&&t.redirect("/#set_password")}else e.error={code:404},e.redirect("/")}),h.get(/^\/+(?:\?)?#verify\/?$/,o.verify),h.get(/^\/+(?:\?)?#set_password\/?$/,o.setPassword),h.get(/^\/+(?:\?)?#token=([a-zA-Z0-9]{64})\/?$/,o.resolveToken),h.get(/^\/+(?:\?)?#!([1-9][0-9]*)\/([a-zA-Z0-9]{4})\/?$/,o.crossPhoneToken),h.get(/^\/+(?:\?)?#!token=([a-zA-Z0-9]{32})\/?$/,o.crossToken),h.set("tryRedirectAt",0),h.on("launched",function(){function e(){r(e),i.update()}var n=this,a=setInterval(function(){var e=l(),i=n.set("tryRedirectAt");i&&(e-c>1500&&1500>Math.abs(i-c)?(clearInterval(a),t(".get-button button").html('Open <span class="exfe">EXFE</span> app').removeClass("hide"),t("#app-footer").off("click.footer",".get-button button").on("click.footer",".get-button button",function(){u()})):2e3>e-i&&(t(".get-button").removeClass("hide"),t(".redirecting").addClass("hide"))),c=e},500);h.set("tryTimer",a),e()}),h.run()});
>>>>>>> 6a96ad7... update files
