define("geomarker",function(){"use strict";function t(t){this.options=t||{},this.div_=null,this.setMap(this.map_=this.options.map),delete this.options.map;var e=this.options,n=document.createElement("div"),i=document.createElement("div");i.id="gpsarrow",n.id=e.id,n.appendChild(i),this.arrow_=i,this.div_=n,this.needleAngle=0,this.accuracy=0,this.currentHeading=0}var e=t.prototype=new google.maps.OverlayView;return e.onAdd=function(){this.getPanes().overlayLayer.appendChild(this.div_),this.listen()},e.onRemove=function(){this.div_.parentNode.removeChild(this.div_),this.div_=null},e.draw=function(){var t=this.getProjection();if(t){var e=t.fromLatLngToDivPixel(this.latlng),n=this.options,i=this.div_;i.style.top=e.y-n.height/2+"px",i.style.left=e.x-n.width/2+"px"}},e.setArrowRotate=function(t){var e=this.arrow_.style;e.webkitTransform=e.transform="rotate("+t+"deg)"},e.rotateNeedle=function(){var t=Math.floor(this.needleAngle/360),e=this.needleAngle-360*t,n=this.currentHeading-e;Math.abs(n)>180&&(0>n?n+=360:n-=360),n/=5,this.needleAngle=this.needleAngle+n,this.needleAngle-window.orientation,this.setArrowRotate(this.needleAngle)},e.orientationHandle=function(){var t=this;return function(e){void 0!=e.webkitCompassHeading?(t.currentHeading=360-e.webkitCompassHeading,t.accuracy=e.webkitCompassAccuracy):null!=e.alpha&&(t.currentHeading=-1*(270-e.alpha),t.accuracy=e.webkitCompassAccuracy),t.rotateNeedle()}},e.listen=function(){window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",this.orientationHandle(),!1)},e.setStatus=function(t){this.arrow_.className=t?"online":""},e.getPosition=function(){return this.latlng},e.setPosition=function(t){this.latlng=t,this.draw()},t});