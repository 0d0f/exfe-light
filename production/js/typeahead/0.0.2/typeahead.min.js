define("typeahead",function(e){"use strict";function t(e,t){return e?function(n){return e.call(t,n)}:void 0}var n=e("jquery"),r=e("widget"),i=n("#app-tmp"),s=r.extend({options:{source:[],template:'<div class="popmenu hide"></div>',target:null,parentNode:i,viewData:{menu:'<ul class="typeahead"></ul>',item:"<li></li>"}},isShown:!1,init:function(){this.parentNode=this.options.parentNode,this.source=this.options.source,this.element.appendTo(this.parentNode),this.listen()},listen:function(){this.target=this.target||this.options.target,this.target.on("blur.typeahead",t(this.blur,this)).on("keypress.typeahead",t(this.keypress,this)).on("keyup.typeahead",t(this.keyup,this)).on("focus.typeahead",t(this.focus,this)),n.browser.webkit|n.browser.msie|n.browser.mozilla&&this.target.on("keydown.typeahead",t(this.keypress,this)),this.element.on("click.typeahead",t(this.click,this)).on("mouseenter.typeahead","li",t(this.mouseenter,this))},select:function(){var e=this.$(".active"),t=e.data("value");return this.target.val(this.updater(t)).change(),this.emit("select",t),this.hide()},updater:function(e){return e},itemRender:function(e){return n(this.options.viewData.item).data("value",e).html(e)},render:function(e){var t=this;e=n(e).map(function(e,n){return t.itemRender(n,e)[0]});var r=n(this.options.viewData.menu).html(e);return this.element.html(r),this},show:function(){var e=n.extend({},this.target.offset(),{height:this.target.outerHeight()});return this.element.css({top:e.top+e.height,left:e.left}),this.element.removeClass("hide"),this.isShown=!0,this},hide:function(){return this.element.addClass("hide"),this.isShown=!1,this},lookup:function(){return this.query=n.trim(this.target.val()),this.query?(this.emit("search",this.query),void 0):(this.emit("nothing"),this.isShown?this.hide():this)},next:function(){var e=this.element.find(".active"),t=e.next();t.length||(t=this.element.find("li").first()),e.removeClass("active"),t.addClass("active")},prev:function(){var e=this.element.find(".active"),t=e.prev();t.length||(t=this.element.find("li").last()),e.removeClass("active"),t.addClass("active")},focus:function(){},keyup:function(e,t){switch(t=e.keyCode){case 40:case 38:break;case 9:case 13:if(!this.isShown)return;this.select();break;case 27:if(!this.isShown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},keypress:function(e,t){if(this.isShown){switch(t=e.keyCode){case 13:case 27:e.preventDefault();break;case 38:if("keydown"!==e.type)return;e.preventDefault(),this.prev();break;case 40:if("keydown"!==e.type)return;e.preventDefault(),this.next()}e.stopPropagation()}},blur:function(){var e=this;setTimeout(function(){e.hide()},150)},click:function(e){e.stopPropagation(),e.preventDefault(),this.select()},mouseenter:function(e){this.element.find(".active").removeClass("active"),n(e.currentTarget).addClass("active")}});return s});